<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Rebecca Barter – technicalvalidation_qualityflags</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Rebecca Barter</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
 <span class="menu-text">About Rebecca</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rlbarter"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/rlbarter"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">



<section id="qaqc-spatial-and-temporal-flags" class="level1">
<h1>QA/QC spatial and temporal flags</h1>
<p>Add to each data a spatial quality flag (SQF) to reflect the consistency of the spatial unit of ancillary data and CDP emission data, as well as a temporal quality flag (TQF) to reflect the consistency of temporal units with the year of reported emissions.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> collections</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_colwidth'</span>, <span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variables" class="level1">
<h1>variables</h1>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>var_city <span class="op">=</span> <span class="st">'city name'</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>area_cdp <span class="op">=</span> <span class="st">'Land area (in square km) (CDP)'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>area_pku <span class="op">=</span> <span class="st">'Built-up Area (km2) (PKU)'</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>area_others <span class="op">=</span> <span class="st">'area [km2] (others)'</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>area_others_source <span class="op">=</span><span class="st">'area [km2] (others) source'</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>refyr <span class="op">=</span> <span class="st">'Year of Emission'</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>dset <span class="op">=</span> <span class="st">'Scope 1 dataset'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="functions" class="level1">
<h1>functions</h1>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_computeSQF(df, refattr, attr, flag):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Add quality flag 0 to col 'flag' if ratio refattr/attr is not in [0.5, 2], and 1 otherwise"""</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    inconsistent <span class="op">=</span> (df[refattr]<span class="op">/</span>df[attr] <span class="op">&lt;=</span> <span class="fl">0.5</span>) <span class="op">|</span> (df[refattr]<span class="op">/</span>df[attr] <span class="op">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    consistent <span class="op">=</span> (df[refattr]<span class="op">/</span>df[attr] <span class="op">&gt;</span> <span class="fl">0.5</span>) <span class="op">&amp;</span> (df[refattr]<span class="op">/</span>df[attr] <span class="op">&lt;</span> <span class="dv">2</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    df[flag] <span class="op">=</span> np.nan</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    df.loc[inconsistent, flag] <span class="op">=</span> <span class="dv">0</span> <span class="co">#inconsistent</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    df.loc[consistent, flag] <span class="op">=</span> <span class="dv">1</span>   <span class="co">#consistent   </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> <span class="st">'Spatial Quality Flag = 0 count: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[inconsistent, var_city].count())</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> <span class="st">'Spatial Quality Flag = 1 count: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[consistent, var_city].count())</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-data" class="level1">
<h1>Read data</h1>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Merged emissions and ancillary datasets from Methods4_addAncillaryData.ipynb</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'DATA/INTERMEDIATE_FILES/merged_emissions_and_ancillary_datasets.tsv'</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(fname, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>df.drop(<span class="st">'Unnamed: 0'</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.shape</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 166)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>City Name (CDP)</th>
      <th>full city name (carbonn)</th>
      <th>full city name (PKU)</th>
      <th>full city name (GEA)</th>
      <th>full city name (UITP)</th>
      <th>full city name (WB)</th>
      <th>Boundary (CDP)</th>
      <th>city_type (carbonn)</th>
      <th>definition  (WB)</th>
      <th>...</th>
      <th>High BUA pop density - 2000 (UEX)</th>
      <th>Low BUA pop density – 2014 (UEX)</th>
      <th>High BUA pop density - 2014 (UEX)</th>
      <th>Exports (m3)</th>
      <th>Production (m3)</th>
      <th>Export/Production</th>
      <th>CH4_waste/person</th>
      <th>CH4_(waste+natgas)/person</th>
      <th>corrected CH4_(waste+natgas)/person</th>
      <th>data from CIA World Fact Book for 2014</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aarhus</td>
      <td>Aarhus Kommune</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative boundary of a local government</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>2660.083381</td>
      <td>244.122636</td>
      <td>2783.303589</td>
      <td>4.517000e+09</td>
      <td>6.412000e+09</td>
      <td>0.70</td>
      <td>0.010683</td>
      <td>0.017031</td>
      <td>0.012559</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Abington</td>
      <td>Abington Township</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Other: Municipal boundary</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.287000e+10</td>
      <td>7.662000e+11</td>
      <td>0.06</td>
      <td>0.017699</td>
      <td>0.036729</td>
      <td>0.035665</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 166 columns</p>
</div>
</div>
</div>
</section>
<section id="spatial-quality-flag" class="level1">
<h1>Spatial Quality Flag</h1>
<p>SQF = 1 if the spatial unit of this data is consistent with the one of emissions, and SQF = 0 if this is not the case. Spatial units are considered to be consistent if the ratio of the area of a given ancillary data coming from D<sup>CDP</sup>, D<sup>OTHERS</sup>, D<sup>GEA</sup> and D<sup>WB</sup> to the area of D<sup>CDP</sup> is less than two.</p>
<section id="area" class="level2">
<h2 class="anchored" data-anchor-id="area">Area</h2>
<p>‘Land area (in square km) (CDP)’<br>
‘area_size (GEA)’<br>
‘area_size (WB)’<br>
‘Built-up Area (km2) (PKU)’<br>
‘area [km2] (external)’</p>
<p>Note that carbonn cities do not report area.</p>
<p>Three data entry errors for CDP area: * the area for Faro = 202,570 km2 in DCDP vs.&nbsp;202.57 km2 in DOTHERS (https://en.wikipedia.org/wiki/Faro,_Portugal). * the area for Porto Alegre = 469,684 km2 in DCDP vs.&nbsp;496.827 km2 in DOTHERS (https://en.wikipedia.org/wiki/Porto_Alegre). * the area for Salvador = 692,819 km2 in DCDP vs.&nbsp;693 km2 in DOTHERS (http://www.c40.org/cities/salvador).</p>
<p>Can assume that the comma should be a decimal point.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df.loc[df[var_city]<span class="op">==</span><span class="st">'Faro'</span>, area_cdp] <span class="op">=</span> <span class="fl">202.57</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df.loc[df[var_city]<span class="op">==</span><span class="st">'Porto Alegre'</span>, area_cdp] <span class="op">=</span> <span class="fl">469.684</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df.loc[df[var_city]<span class="op">==</span><span class="st">'Salvador'</span>, area_cdp] <span class="op">=</span> <span class="fl">692.819</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#No overlap between CDP and PKU cities</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df.loc[(<span class="op">~</span>df[area_cdp].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df[area_pku].isnull()), var_city]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Series([], Name: city name, dtype: object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#There is overlap between PKU and GEA cities</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(<span class="op">~</span>df[area_cdp].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df[<span class="st">'area_size (GEA)'</span>].isnull()), var_city].count()  <span class="co">#30</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#There is overlap between PKU and WB cities</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(<span class="op">~</span>df[area_cdp].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df[<span class="st">'area_size (WB)'</span>].isnull()), var_city].count()  <span class="co">#15</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#There is overlap between PKU and external area values</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(<span class="op">~</span>df[area_cdp].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df[area_others].isnull()), var_city].count()  <span class="co">#184</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>30
15
184</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CDP area outlier?</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (df[area_cdp]<span class="op">/</span>df[area_others]).<span class="bu">max</span>() <span class="co">#outlier comes from Kadiovacik</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df.loc[(df[area_cdp]<span class="op">/</span>df[area_others])<span class="op">&gt;</span><span class="dv">2</span>, [var_city, area_cdp,area_others ] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>25856.521739130432</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Land area (in square km) (CDP)</th>
      <th>area [km2] (others)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>45</th>
      <td>Bournemouth</td>
      <td>108.0</td>
      <td>46.180000</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Canberra</td>
      <td>2358.0</td>
      <td>814.200000</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Genova</td>
      <td>1118.0</td>
      <td>240.290000</td>
    </tr>
    <tr>
      <th>150</th>
      <td>Kadiovacik</td>
      <td>5947.0</td>
      <td>0.230000</td>
    </tr>
    <tr>
      <th>158</th>
      <td>La Paz</td>
      <td>2010.0</td>
      <td>472.000000</td>
    </tr>
    <tr>
      <th>258</th>
      <td>Santiago</td>
      <td>15403.0</td>
      <td>641.000000</td>
    </tr>
    <tr>
      <th>260</th>
      <td>Santiago de Guayaquil</td>
      <td>5047.0</td>
      <td>344.500000</td>
    </tr>
    <tr>
      <th>264</th>
      <td>Seattle</td>
      <td>3692.0</td>
      <td>217.403761</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CDP area outlier?</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df.loc[(df[area_cdp]<span class="op">/</span>df[area_others])<span class="op">&lt;</span><span class="fl">0.5</span>, [var_city, area_cdp,area_others ] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Land area (in square km) (CDP)</th>
      <th>area [km2] (others)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>Amman</td>
      <td>800.0</td>
      <td>1680.000000</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Benicia</td>
      <td>13.0</td>
      <td>33.488571</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Brisbane, CA</td>
      <td>7.5</td>
      <td>52.000000</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Caracas</td>
      <td>776.0</td>
      <td>4715.100000</td>
    </tr>
    <tr>
      <th>123</th>
      <td>Hjørring</td>
      <td>7.5</td>
      <td>929.580000</td>
    </tr>
    <tr>
      <th>164</th>
      <td>Lancaster, PA</td>
      <td>7.3</td>
      <td>18.725628</td>
    </tr>
    <tr>
      <th>166</th>
      <td>Las Vegas</td>
      <td>136.0</td>
      <td>351.772442</td>
    </tr>
    <tr>
      <th>249</th>
      <td>San Antonio</td>
      <td>426.0</td>
      <td>1193.804091</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (df.loc[df[var_city]<span class="op">!=</span><span class="st">'Kadiovacik'</span>, area_cdp]<span class="op">/</span>df[area_others]).<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>24.029641185647424</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>f, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>edgeColour <span class="op">=</span> <span class="st">'#75766D'</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>barfill <span class="op">=</span> <span class="st">'#E2D5C1'</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#CDP</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>(df[area_cdp]<span class="op">/</span>df[<span class="st">'area_size (GEA)'</span>]).hist(color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'count'</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>, <span class="dv">20</span>))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>plt.yticks([<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>])</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'area ratio (CDP/GEA)'</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>(df[area_cdp]<span class="op">/</span>df[<span class="st">'area_size (WB)'</span>]).hist(bins<span class="op">=</span><span class="dv">15</span>,color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'area ratio (CDP/WB)'</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>, <span class="dv">20</span>))</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>plt.yticks([<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>])</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>(df.loc[df[var_city]<span class="op">!=</span><span class="st">'Kadiovacik'</span>, <span class="st">'Land area (in square km) (CDP)'</span>]<span class="op">/</span>df[area_others]).hist(bins<span class="op">=</span><span class="dv">15</span>,color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'area ratio (CDP/OTHERS)'</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="co">#PKU</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>(df[<span class="st">'Built-up Area (km2) (PKU)'</span>]<span class="op">/</span>df[<span class="st">'area_size (GEA)'</span>]).hist(bins<span class="op">=</span><span class="dv">3</span>,color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'count'</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'area ratio (PKU/GEA)'</span>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>(df[<span class="st">'Built-up Area (km2) (PKU)'</span>]<span class="op">/</span>df[<span class="st">'area_size (WB)'</span>]).hist(bins<span class="op">=</span><span class="dv">2</span>,color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'count'</span>)</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'area ratio (PKU/WB)'</span>)</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>plt.xlim((<span class="dv">0</span>, <span class="fl">3.2</span>))</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>)</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>(df[<span class="st">'Built-up Area (km2) (PKU)'</span>]<span class="op">/</span>df[area_others]).hist(bins<span class="op">=</span><span class="dv">15</span>,color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'count'</span>)</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'area ratio (PKU/OTHERS)'</span>)</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>f.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="TechnicalValidation_qualityFlags_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[<span class="op">~</span>df[<span class="st">'area_size (GEA)'</span>].isnull(), var_city].count()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(df[<span class="st">'Built-up Area (km2) (PKU)'</span>]<span class="op">/</span>df[<span class="st">'area_size (GEA)'</span>])<span class="op">&gt;</span><span class="dv">0</span>, var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>62
19</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SQF Area (CDP vs others)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>refattr <span class="op">=</span> <span class="st">'Land area (in square km) (CDP)'</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>fn_computeSQF(df, refattr, <span class="st">'area_size (GEA)'</span>, <span class="st">'AQF (CDP/GEA)'</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>fn_computeSQF(df, refattr, <span class="st">'area_size (WB)'</span>, <span class="st">'AQF (CDP/WB)'</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>fn_computeSQF(df, refattr, area_others, <span class="st">'AQF (CDP/OTHERS)'</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial Quality Flag = 0 count: 10
Spatial Quality Flag = 1 count: 20

Spatial Quality Flag = 0 count: 3
Spatial Quality Flag = 1 count: 12

Spatial Quality Flag = 0 count: 16
Spatial Quality Flag = 1 count: 168
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sqf <span class="op">=</span> <span class="st">'AQF (CDP/GEA)'</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), var_city].count()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), [var_city,<span class="st">'City Name (CDP)'</span>,area_cdp, <span class="st">'area_size (GEA)'</span>, sqf] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>City Name (CDP)</th>
      <th>Land area (in square km) (CDP)</th>
      <th>area_size (GEA)</th>
      <th>AQF (CDP/GEA)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Athens</td>
      <td>City of Athens</td>
      <td>39.0</td>
      <td>412.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Birmingham</td>
      <td>Birmingham City Council</td>
      <td>267.8</td>
      <td>1598.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Cardiff</td>
      <td>City of Cardiff</td>
      <td>140.0</td>
      <td>475.30</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>119</th>
      <td>Helsinki</td>
      <td>City of Helsinki</td>
      <td>214.0</td>
      <td>715.49</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>173</th>
      <td>Lisbon</td>
      <td>City of Lisbon</td>
      <td>85.0</td>
      <td>958.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>186</th>
      <td>Melbourne</td>
      <td>City of Melbourne</td>
      <td>38.0</td>
      <td>2640.35</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>216</th>
      <td>Paris</td>
      <td>City of Paris</td>
      <td>105.0</td>
      <td>17175.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>279</th>
      <td>Stockholm</td>
      <td>City of Stockholm</td>
      <td>216.0</td>
      <td>6488.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>283</th>
      <td>Sydney</td>
      <td>City of Sydney</td>
      <td>26.0</td>
      <td>12144.60</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>294</th>
      <td>Toronto</td>
      <td>City of Toronto</td>
      <td>634.0</td>
      <td>7125.00</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sqf <span class="op">=</span> <span class="st">'AQF (CDP/WB)'</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), var_city].count()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), [var_city,<span class="st">'City Name (CDP)'</span>,area_cdp, <span class="st">'area_size (WB)'</span>,<span class="st">'definition  (WB)'</span> ,area_others,area_others_source,sqf] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>City Name (CDP)</th>
      <th>Land area (in square km) (CDP)</th>
      <th>area_size (WB)</th>
      <th>definition  (WB)</th>
      <th>area [km2] (others)</th>
      <th>area [km2] (others) source</th>
      <th>AQF (CDP/WB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>178</th>
      <td>Los Angeles</td>
      <td>City of Los Angeles</td>
      <td>1215.0</td>
      <td>10517.6</td>
      <td>County</td>
      <td>1213.850613</td>
      <td>https://www.census.gov/quickfacts/fact/table/losangelescitycalifornia,US/PST045216</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>264</th>
      <td>Seattle</td>
      <td>City of Seattle</td>
      <td>3692.0</td>
      <td>369.2</td>
      <td>City</td>
      <td>217.403761</td>
      <td>https://www.census.gov/quickfacts/fact/table/seattlecitywashington/PST045216</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>294</th>
      <td>Toronto</td>
      <td>City of Toronto</td>
      <td>634.0</td>
      <td>7125.0</td>
      <td>Greater Toronto Area</td>
      <td>634.000000</td>
      <td>http://www.c40.org/cities/toronto</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sqf <span class="op">=</span> <span class="st">'AQF (CDP/OTHERS)'</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), var_city].count()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), [var_city,<span class="st">'City Name (CDP)'</span>,area_cdp, area_others,area_others_source, sqf] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>16</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>City Name (CDP)</th>
      <th>Land area (in square km) (CDP)</th>
      <th>area [km2] (others)</th>
      <th>area [km2] (others) source</th>
      <th>AQF (CDP/OTHERS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>Amman</td>
      <td>Greater Amman Municipality</td>
      <td>800.0</td>
      <td>1680.000000</td>
      <td>https://en.wikipedia.org/wiki/Amman</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Benicia</td>
      <td>City of Benicia</td>
      <td>13.0</td>
      <td>33.488571</td>
      <td>https://www.census.gov/quickfacts/fact/table/beniciacitycalifornia/PST045216</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Bournemouth</td>
      <td>City of Bournemouth</td>
      <td>108.0</td>
      <td>46.180000</td>
      <td>https://en.wikipedia.org/wiki/Bournemouth</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Brisbane, CA</td>
      <td>City of Brisbane, CA</td>
      <td>7.5</td>
      <td>52.000000</td>
      <td>https://en.wikipedia.org/wiki/Brisbane,_California#cite_note-CenPopGazetteer2016-3</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Canberra</td>
      <td>Canberra</td>
      <td>2358.0</td>
      <td>814.200000</td>
      <td>https://en.wikipedia.org/wiki/Canberra#cite_note-area-4</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Caracas</td>
      <td>Alcaldía Metropolitana de Caracas</td>
      <td>776.0</td>
      <td>4715.100000</td>
      <td>https://en.wikipedia.org/wiki/Metropolitan_Region_of_Caracas</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Genova</td>
      <td>Comune di Genova</td>
      <td>1118.0</td>
      <td>240.290000</td>
      <td>https://it.wikipedia.org/wiki/Genova</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>123</th>
      <td>Hjørring</td>
      <td>Municipality of Hjørring</td>
      <td>7.5</td>
      <td>929.580000</td>
      <td>https://en.wikipedia.org/wiki/Hjørring_Municipality</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>150</th>
      <td>Kadiovacik</td>
      <td>Village of Kadiovacik</td>
      <td>5947.0</td>
      <td>0.230000</td>
      <td>estimated manually by drawing a square around village centre using https://www.daftlogic.com/projects-google-maps-area-calculator-tool.htm</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>158</th>
      <td>La Paz</td>
      <td>Municipalidad de La Paz</td>
      <td>2010.0</td>
      <td>472.000000</td>
      <td>https://en.wikipedia.org/wiki/La_Paz</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>164</th>
      <td>Lancaster, PA</td>
      <td>City of Lancaster, PA</td>
      <td>7.3</td>
      <td>18.725628</td>
      <td>https://www.census.gov/quickfacts/fact/table/lancastercitypennsylvania/PST045216</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>166</th>
      <td>Las Vegas</td>
      <td>City of Las Vegas</td>
      <td>136.0</td>
      <td>351.772442</td>
      <td>https://www.census.gov/quickfacts/fact/table/lasvegascitynevada/PST045216</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>249</th>
      <td>San Antonio</td>
      <td>City of San Antonio</td>
      <td>426.0</td>
      <td>1193.804091</td>
      <td>https://www.census.gov/quickfacts/fact/table/sanantoniocitytexas/PST045216</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>258</th>
      <td>Santiago</td>
      <td>Región Metropolitana de Santiago</td>
      <td>15403.0</td>
      <td>641.000000</td>
      <td>http://www.c40.org/cities/santiago</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>260</th>
      <td>Santiago de Guayaquil</td>
      <td>Santiago de Guayaquil</td>
      <td>5047.0</td>
      <td>344.500000</td>
      <td>https://en.wikipedia.org/wiki/Guayaquil</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>264</th>
      <td>Seattle</td>
      <td>City of Seattle</td>
      <td>3692.0</td>
      <td>217.403761</td>
      <td>https://www.census.gov/quickfacts/fact/table/seattlecitywashington/PST045216</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PKU Area (PKU vs others)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>refattr <span class="op">=</span> <span class="st">'Built-up Area (km2) (PKU)'</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>fn_computeSQF(df, refattr, <span class="st">'area_size (GEA)'</span>, <span class="st">'AQF (PKU/GEA)'</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>fn_computeSQF(df, refattr, <span class="st">'area_size (WB)'</span>, <span class="st">'AQF (PKU/WB)'</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>fn_computeSQF(df, refattr, area_others, <span class="st">'AQF (PKU/OTHERS)'</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatial Quality Flag = 0 count: 19
Spatial Quality Flag = 1 count: 0

Spatial Quality Flag = 0 count: 3
Spatial Quality Flag = 1 count: 0

Spatial Quality Flag = 0 count: 73
Spatial Quality Flag = 1 count: 4
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (df[<span class="st">'area_size (GEA)'</span>]<span class="op">/</span>df[<span class="st">'Built-up Area (km2) (PKU)'</span>]).mean()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (df[<span class="st">'area_size (GEA)'</span>]<span class="op">/</span>df[<span class="st">'Built-up Area (km2) (PKU)'</span>]).std()</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (df[<span class="st">'area_size (GEA)'</span>]<span class="op">/</span>df[<span class="st">'Built-up Area (km2) (PKU)'</span>]).median()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (df[<span class="st">'area_size (GEA)'</span>]).mean()</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (df[<span class="st">'Built-up Area (km2) (PKU)'</span>]).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>37.2417978785
34.2302929619
24.4998338318

5230.83009677
341.202409639</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Is PKU Built-up Area always smaller than the other areas?</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>dset <span class="op">=</span> <span class="st">'Scope-1 source dataset'</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (df[<span class="st">'Built-up Area (km2) (PKU)'</span>]<span class="op">/</span>df[<span class="st">'area_size (GEA)'</span>]).mean()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (df[<span class="st">'Built-up Area (km2) (PKU)'</span>]<span class="op">/</span>df[<span class="st">'area_size (GEA)'</span>]).std()</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> (df[<span class="st">'Built-up Area (km2) (PKU)'</span>]<span class="op">/</span>df[<span class="st">'area_size (GEA)'</span>]).median()</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>df.loc[(df[dset]<span class="op">==</span><span class="st">'PKU'</span>) <span class="op">&amp;</span> (<span class="op">~</span>df[<span class="st">'area_size (GEA)'</span>].isnull()), [<span class="st">'Built-up Area (km2) (PKU)'</span>,<span class="st">'area_size (GEA)'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0519530749549
0.0510052691265
0.0408166033641</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="23">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Built-up Area (km2) (PKU)</th>
      <th>area_size (GEA)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>59</th>
      <td>461.1</td>
      <td>20532.00</td>
    </tr>
    <tr>
      <th>60</th>
      <td>433.3</td>
      <td>11819.00</td>
    </tr>
    <tr>
      <th>71</th>
      <td>513.5</td>
      <td>13237.00</td>
    </tr>
    <tr>
      <th>95</th>
      <td>518.1</td>
      <td>12177.00</td>
    </tr>
    <tr>
      <th>104</th>
      <td>202.8</td>
      <td>8034.00</td>
    </tr>
    <tr>
      <th>107</th>
      <td>349.6</td>
      <td>53000.00</td>
    </tr>
    <tr>
      <th>108</th>
      <td>139.9</td>
      <td>2237.00</td>
    </tr>
    <tr>
      <th>115</th>
      <td>393.7</td>
      <td>7029.48</td>
    </tr>
    <tr>
      <th>125</th>
      <td>244.9</td>
      <td>17224.00</td>
    </tr>
    <tr>
      <th>145</th>
      <td>626.6</td>
      <td>8177.00</td>
    </tr>
    <tr>
      <th>165</th>
      <td>183.3</td>
      <td>13300.00</td>
    </tr>
    <tr>
      <th>197</th>
      <td>300.9</td>
      <td>7372.00</td>
    </tr>
    <tr>
      <th>199</th>
      <td>736.6</td>
      <td>6598.00</td>
    </tr>
    <tr>
      <th>208</th>
      <td>422.8</td>
      <td>9816.00</td>
    </tr>
    <tr>
      <th>233</th>
      <td>919.6</td>
      <td>11026.00</td>
    </tr>
    <tr>
      <th>271</th>
      <td>591.0</td>
      <td>12942.00</td>
    </tr>
    <tr>
      <th>273</th>
      <td>297.3</td>
      <td>15722.00</td>
    </tr>
    <tr>
      <th>290</th>
      <td>1294.1</td>
      <td>5606.90</td>
    </tr>
    <tr>
      <th>323</th>
      <td>127.7</td>
      <td>7372.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Is PKU Built-up Area always smaller than the other areas?</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>dset <span class="op">=</span> <span class="st">'Scope-1 source dataset'</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>df.loc[(df[dset]<span class="op">==</span><span class="st">'PKU'</span>) <span class="op">&amp;</span> (<span class="op">~</span>df[<span class="st">'area_size (WB)'</span>].isnull()), [<span class="st">'Built-up Area (km2) (PKU)'</span>,<span class="st">'area_size (WB)'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Built-up Area (km2) (PKU)</th>
      <th>area_size (WB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>1733.8</td>
      <td>16801.25</td>
    </tr>
    <tr>
      <th>269</th>
      <td>1921.1</td>
      <td>6340.50</td>
    </tr>
    <tr>
      <th>290</th>
      <td>1294.1</td>
      <td>11760.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sqf <span class="op">=</span> <span class="st">'AQF (PKU/GEA)'</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), var_city].count()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), [var_city,<span class="st">'full city name (PKU)'</span>,<span class="st">'Built-up Area (km2) (PKU)'</span>, <span class="st">'area_size (GEA)'</span>, sqf] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>19</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>full city name (PKU)</th>
      <th>Built-up Area (km2) (PKU)</th>
      <th>area_size (GEA)</th>
      <th>AQF (PKU/GEA)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>59</th>
      <td>Changchun</td>
      <td>Changchun</td>
      <td>461.1</td>
      <td>20532.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Changsha, Hunan</td>
      <td>Changsha</td>
      <td>433.3</td>
      <td>11819.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Dalian</td>
      <td>Dalian</td>
      <td>513.5</td>
      <td>13237.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Fuzhou</td>
      <td>Fuzhou</td>
      <td>518.1</td>
      <td>12177.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>104</th>
      <td>Guiyang</td>
      <td>Guiyang</td>
      <td>202.8</td>
      <td>8034.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>107</th>
      <td>Haerbin</td>
      <td>Haerbin</td>
      <td>349.6</td>
      <td>53000.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>108</th>
      <td>Haikou</td>
      <td>Haikou</td>
      <td>139.9</td>
      <td>2237.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>115</th>
      <td>Hefei</td>
      <td>Hefei</td>
      <td>393.7</td>
      <td>7029.48</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>125</th>
      <td>Hohhot</td>
      <td>Huhehaote</td>
      <td>244.9</td>
      <td>17224.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>145</th>
      <td>Jinan, Shandong</td>
      <td>Jinan</td>
      <td>626.6</td>
      <td>8177.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>165</th>
      <td>Lanzhou</td>
      <td>Lanzhou</td>
      <td>183.3</td>
      <td>13300.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>197</th>
      <td>Nanchang</td>
      <td>Nanchang</td>
      <td>300.9</td>
      <td>7372.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>199</th>
      <td>Nanjing, Jiangsu</td>
      <td>Nanjing</td>
      <td>736.6</td>
      <td>6598.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>208</th>
      <td>Ningbo</td>
      <td>Ningbo</td>
      <td>422.8</td>
      <td>9816.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>233</th>
      <td>Qingdao</td>
      <td>Qingdao</td>
      <td>919.6</td>
      <td>11026.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>271</th>
      <td>Shenyang</td>
      <td>Shenyang</td>
      <td>591.0</td>
      <td>12942.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>273</th>
      <td>Shijiazhuang</td>
      <td>Shijiazhuang</td>
      <td>297.3</td>
      <td>15722.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>290</th>
      <td>Tianjin</td>
      <td>Tianjin</td>
      <td>1294.1</td>
      <td>5606.90</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>323</th>
      <td>Xining</td>
      <td>Xining</td>
      <td>127.7</td>
      <td>7372.00</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sqf <span class="op">=</span> <span class="st">'AQF (PKU/WB)'</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), var_city].count()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), [var_city,<span class="st">'full city name (PKU)'</span>,<span class="st">'Built-up Area (km2) (PKU)'</span>, <span class="st">'area_size (WB)'</span>,<span class="st">'definition  (WB)'</span>, sqf] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="26">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>full city name (PKU)</th>
      <th>Built-up Area (km2) (PKU)</th>
      <th>area_size (WB)</th>
      <th>definition  (WB)</th>
      <th>AQF (PKU/WB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>Beijing</td>
      <td>Bejing</td>
      <td>1733.8</td>
      <td>16801.25</td>
      <td>Beijing Government Administered Area (Province)</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>269</th>
      <td>Shanghai</td>
      <td>Shanghai</td>
      <td>1921.1</td>
      <td>6340.50</td>
      <td>Shanghai Government Administered Area (Province)</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>290</th>
      <td>Tianjin</td>
      <td>Tianjin</td>
      <td>1294.1</td>
      <td>11760.00</td>
      <td>Tianjin Government Administered Area (Province)</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sqf <span class="op">=</span> <span class="st">'AQF (PKU/OTHERS)'</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), var_city].count()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>df.loc[(df[sqf]<span class="op">==</span><span class="dv">0</span>), [var_city,<span class="st">'full city name (PKU)'</span>,<span class="st">'Built-up Area (km2) (PKU)'</span>, area_others,<span class="st">'area [km2] (external) source'</span>, sqf] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>73</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/homel/cnangini/anaconda2/lib/python2.7/site-packages/ipykernel_launcher.py:3: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  This is separate from the ipykernel package so we can avoid doing imports until
/homel/cnangini/anaconda2/lib/python2.7/site-packages/pandas/core/indexing.py:1367: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  return self._getitem_tuple(key)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>full city name (PKU)</th>
      <th>Built-up Area (km2) (PKU)</th>
      <th>area [km2] (others)</th>
      <th>area [km2] (external) source</th>
      <th>AQF (PKU/OTHERS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Anshan</td>
      <td>Anshan</td>
      <td>200.8</td>
      <td>624.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Anyang</td>
      <td>Anyang</td>
      <td>161.1</td>
      <td>543.50</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Baoding</td>
      <td>Baoding</td>
      <td>133.1</td>
      <td>326.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Baotou</td>
      <td>Baotou</td>
      <td>349.5</td>
      <td>2662.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Benxi</td>
      <td>Benxi</td>
      <td>64.6</td>
      <td>907.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Changchun</td>
      <td>Changchun</td>
      <td>461.1</td>
      <td>4738.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Changsha, Hunan</td>
      <td>Changsha</td>
      <td>433.3</td>
      <td>1917.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Changzhou</td>
      <td>Changzhou</td>
      <td>329.5</td>
      <td>1872.10</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Chengdou</td>
      <td>Chengdou</td>
      <td>783.0</td>
      <td>3679.90</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Dalian</td>
      <td>Dalian</td>
      <td>513.5</td>
      <td>13237.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Dandong</td>
      <td>Dandong</td>
      <td>95.2</td>
      <td>830.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Daqing</td>
      <td>Daqing</td>
      <td>207.5</td>
      <td>5107.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Datong</td>
      <td>Datong</td>
      <td>185.4</td>
      <td>2080.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Fushun</td>
      <td>Fushun</td>
      <td>142.3</td>
      <td>1416.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Fuxin</td>
      <td>Fuxin</td>
      <td>79.1</td>
      <td>459.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>102</th>
      <td>Guangzhou</td>
      <td>Guangzhou</td>
      <td>918.7</td>
      <td>3843.43</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>104</th>
      <td>Guiyang</td>
      <td>Guiyang</td>
      <td>202.8</td>
      <td>2403.40</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>107</th>
      <td>Haerbin</td>
      <td>Haerbin</td>
      <td>349.6</td>
      <td>4640.40</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>108</th>
      <td>Haikou</td>
      <td>Haikou</td>
      <td>139.9</td>
      <td>2237.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>112</th>
      <td>Hangzhou</td>
      <td>Hangzhou</td>
      <td>672.4</td>
      <td>8000.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>115</th>
      <td>Hefei</td>
      <td>Hefei</td>
      <td>393.7</td>
      <td>838.50</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>116</th>
      <td>Hegang</td>
      <td>Hegang</td>
      <td>64.7</td>
      <td>11849.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>118</th>
      <td>Heilongjiang</td>
      <td>Yichun</td>
      <td>61.8</td>
      <td>39017.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>120</th>
      <td>Hengyang</td>
      <td>Hengyang</td>
      <td>94.4</td>
      <td>722.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>125</th>
      <td>Hohhot</td>
      <td>Huhehaote</td>
      <td>244.9</td>
      <td>2065.10</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>128</th>
      <td>Huaibei</td>
      <td>Huaibei</td>
      <td>99.9</td>
      <td>748.40</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>129</th>
      <td>Huainan</td>
      <td>Huainan</td>
      <td>165.7</td>
      <td>1492.30</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>142</th>
      <td>Jiamusi</td>
      <td>Jiamusi</td>
      <td>57.1</td>
      <td>882.50</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>143</th>
      <td>Jiaozhuo</td>
      <td>Jiaozhuo</td>
      <td>121.7</td>
      <td>413.80</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>144</th>
      <td>Jilin</td>
      <td>Jilin</td>
      <td>180.3</td>
      <td>3663.90</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>208</th>
      <td>Ningbo</td>
      <td>Ningbo</td>
      <td>422.8</td>
      <td>2461.80</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>224</th>
      <td>Pingdingshan</td>
      <td>Pingdingshan</td>
      <td>163.4</td>
      <td>384.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>233</th>
      <td>Qingdao</td>
      <td>Qingdao</td>
      <td>919.6</td>
      <td>3239.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>234</th>
      <td>Qiqihaer</td>
      <td>Qiqihaer</td>
      <td>154.1</td>
      <td>4039.30</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>269</th>
      <td>Shanghai</td>
      <td>Shanghai</td>
      <td>1921.1</td>
      <td>6341.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>270</th>
      <td>Shantou</td>
      <td>Shantou</td>
      <td>230.9</td>
      <td>2248.39</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>271</th>
      <td>Shenyang</td>
      <td>Shenyang</td>
      <td>591.0</td>
      <td>3464.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>272</th>
      <td>Shenzhen</td>
      <td>Shenzhen</td>
      <td>932.6</td>
      <td>2050.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>273</th>
      <td>Shijiazhuang</td>
      <td>Shijiazhuang</td>
      <td>297.3</td>
      <td>15848.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>282</th>
      <td>Suzhou</td>
      <td>Suzhou</td>
      <td>832.1</td>
      <td>8488.42</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>284</th>
      <td>Taian</td>
      <td>Taian</td>
      <td>154.3</td>
      <td>2086.80</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>286</th>
      <td>Taiyuan, Shanxi</td>
      <td>Taiyuan</td>
      <td>246.0</td>
      <td>1460.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>287</th>
      <td>Tangshan</td>
      <td>Tangshan</td>
      <td>417.8</td>
      <td>3874.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>290</th>
      <td>Tianjin</td>
      <td>Tianjin</td>
      <td>1294.1</td>
      <td>174.90</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>310</th>
      <td>Weifang</td>
      <td>Weifang</td>
      <td>191.9</td>
      <td>2646.10</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>317</th>
      <td>Wuhan</td>
      <td>Wuhan</td>
      <td>822.2</td>
      <td>8494.41</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>319</th>
      <td>Xi'an, Shaanxi</td>
      <td>Xi'an</td>
      <td>509.9</td>
      <td>9983.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>320</th>
      <td>Xiamen</td>
      <td>Xiamen</td>
      <td>341.8</td>
      <td>1699.39</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>321</th>
      <td>Xiangtan</td>
      <td>Xiangtan</td>
      <td>112.3</td>
      <td>280.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>322</th>
      <td>Xiangyang</td>
      <td>Xiangyang</td>
      <td>131.2</td>
      <td>3672.90</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>323</th>
      <td>Xining</td>
      <td>Xining</td>
      <td>127.7</td>
      <td>343.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>324</th>
      <td>Xinxiang</td>
      <td>Xinxiang</td>
      <td>118.9</td>
      <td>346.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>325</th>
      <td>Xuzhou</td>
      <td>Xuzhou</td>
      <td>285.8</td>
      <td>3037.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>328</th>
      <td>Yinchuan</td>
      <td>Yinchuan</td>
      <td>187.8</td>
      <td>2045.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>332</th>
      <td>Zhangjiakou</td>
      <td>Zhangjiakou</td>
      <td>145.1</td>
      <td>36861.56</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>333</th>
      <td>Zhanjiang</td>
      <td>Zhanjiang</td>
      <td>95.1</td>
      <td>1360.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>334</th>
      <td>Zhaozhuang</td>
      <td>Zhaozhuang</td>
      <td>119.8</td>
      <td>3069.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>335</th>
      <td>Zhengzhou</td>
      <td>Zhengzhou</td>
      <td>495.6</td>
      <td>1024.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>337</th>
      <td>Zibo</td>
      <td>Zibo</td>
      <td>384.7</td>
      <td>2972.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Ürümqi (Wulumqi)</td>
      <td>Wulumuqi</td>
      <td>285.4</td>
      <td>14577.00</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>73 rows × 6 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="temporal-unit-consistency" class="level1">
<h1>Temporal unit consistency</h1>
<p>Ideally, all attributes should align with the year of the CDP2016 emissions (reference year). A temporal quality flag TQF = 1 was added if the year of an ancillary data differs by less than 5 years from the reference year for population, less than 15 years for household size, given the slow changes in this variable.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>popyr_others <span class="op">=</span> <span class="st">'population (others) source year'</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>pop_others <span class="op">=</span> <span class="st">'population (others)'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tqf-population" class="level2">
<h2 class="anchored" data-anchor-id="tqf-population">TQF population</h2>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_computeTQF_pop(df,refyr, attr, qflag):</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Add quality flag 0 or 1 to col 'qflag' if abs(refyr - attr) is &gt;= c or &lt; c, respectively, where</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">        cutoff 'c' = 5 years for population and 15 years for household size given the slow changes of this variable.</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="dv">5</span> <span class="co">#cutoff year for population</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    df[qflag] <span class="op">=</span> np.nan</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> attr <span class="op">==</span> <span class="st">'pop_2010 (WB)'</span>:</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        df.loc[(df[refyr] <span class="op">-</span> <span class="dv">2010</span>).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, qflag] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>        df.loc[(df[refyr] <span class="op">-</span> <span class="dv">2010</span>).<span class="bu">abs</span>() <span class="op">&lt;</span> c, qflag] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> <span class="st">'Temporal Quality Flag = 0 count: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[(df[refyr] <span class="op">-</span> <span class="dv">2010</span>).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, var_city].count())</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> <span class="st">'Temporal Quality Flag = 1 count: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[(df[refyr] <span class="op">-</span> <span class="dv">2010</span>).<span class="bu">abs</span>() <span class="op">&lt;</span> c, var_city].count())</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>        df.loc[(df[refyr] <span class="op">-</span> df[attr]).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, qflag] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>        df.loc[(df[refyr] <span class="op">-</span> df[attr]).<span class="bu">abs</span>() <span class="op">&lt;</span> c, qflag] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> <span class="st">'Temporal Quality Flag = 0 count: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[(df[refyr] <span class="op">-</span> df[attr]).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, var_city].count())</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> <span class="st">'Temporal Quality Flag = 1 count: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[(df[refyr] <span class="op">-</span> df[attr]).<span class="bu">abs</span>() <span class="op">&lt;</span> c, var_city].count())</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'dummy'</span>]<span class="op">=</span>np.nan</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df.loc[<span class="op">~</span>df[<span class="st">'pop_2010 (WB)'</span>].isnull(), <span class="st">'dummy'</span>] <span class="op">=</span> <span class="dv">2010</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[<span class="op">~</span>df[<span class="st">'dummy'</span>].isnull(), var_city].count()  <span class="co">#20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>20</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>f, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">14</span>,<span class="dv">6</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>edgeColour <span class="op">=</span> <span class="st">'#75766D'</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>barfill <span class="op">=</span> <span class="st">'#E2D5C1'</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>(df[refyr]<span class="op">-</span>df[<span class="st">'Current Population Year (CDP)'</span>]).hist(color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'count'</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'pop year diff (CDP)'</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=-</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">2</span>)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>(df[refyr]<span class="op">-</span>df[<span class="st">'pop_yr (carbonn)'</span>]).hist(color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'pop year diff (carbonn)'</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=-</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>(df[refyr]<span class="op">-</span>df[<span class="st">'population_year (WB)'</span>]).hist(color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'pop year diff (WB)'</span>)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=-</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">4</span>)</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>(df[refyr]<span class="op">-</span>df[<span class="st">'dummy'</span>]).hist(color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'pop year diff (WB2010)'</span>)</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=-</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>(df[refyr]<span class="op">-</span>df[popyr_others]).hist(color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'pop year diff (others)'</span>)</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=-</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>f.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="TechnicalValidation_qualityFlags_files/figure-html/cell-36-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fn_computeTQF_pop(df,refyr, <span class="st">'Current Population Year (CDP)'</span>, <span class="st">'PQF (CDP)'</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>fn_computeTQF_pop(df,refyr, <span class="st">'pop_yr (carbonn)'</span>, <span class="st">'PQF (carbonn)'</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>fn_computeTQF_pop(df,refyr, <span class="st">'population_year (WB)'</span>, <span class="st">'PQF (WB)'</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>fn_computeTQF_pop(df,refyr, <span class="st">'dummy'</span>, <span class="st">'PQF (WB2010)'</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>fn_computeTQF_pop(df,refyr, popyr_others, <span class="st">'PQF (OTHERS)'</span>)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Temporal Quality Flag = 0 count: 14
Temporal Quality Flag = 1 count: 173

Temporal Quality Flag = 0 count: 11
Temporal Quality Flag = 1 count: 57

Temporal Quality Flag = 0 count: 17
Temporal Quality Flag = 1 count: 3

Temporal Quality Flag = 0 count: 2
Temporal Quality Flag = 1 count: 18

Temporal Quality Flag = 0 count: 59
Temporal Quality Flag = 1 count: 210
</code></pre>
</div>
</div>
<section id="outcomes" class="level3">
<h3 class="anchored" data-anchor-id="outcomes">outcomes</h3>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>attr<span class="op">=</span><span class="st">'PQF (CDP)'</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'total cities: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[<span class="op">~</span>df[attr].isnull(), var_city].count())</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'inconsistent cities: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, var_city].count() )</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[attr]<span class="op">==</span><span class="dv">1</span>, var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total cities: 187
inconsistent cities: 14
173</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="bu">abs</span>(df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, refyr] <span class="op">-</span> df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, <span class="st">'Current Population Year (CDP)'</span>] )</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'range: '</span> <span class="op">+</span> <span class="bu">repr</span>(delta.<span class="bu">min</span>()) <span class="op">+</span> <span class="st">' - '</span> <span class="op">+</span> <span class="bu">repr</span>(delta.<span class="bu">max</span>())</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>range: 5.0 - 24.0

30     5.0 
41     5.0 
52     5.0 
89     8.0 
162    7.0 
207    5.0 
221    24.0
245    5.0 
251    7.0 
257    5.0 
259    5.0 
302    5.0 
306    11.0
315    17.0
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>attr<span class="op">=</span><span class="st">'PQF (carbonn)'</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'total cities: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[<span class="op">~</span>df[attr].isnull(), var_city].count())</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'inconsistent cities: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, var_city].count() )</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[attr]<span class="op">==</span><span class="dv">1</span>, var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total cities: 68
inconsistent cities: 11
57</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="bu">abs</span>(df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, refyr] <span class="op">-</span> df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, <span class="st">'pop_yr (carbonn)'</span>] )</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'range: '</span> <span class="op">+</span> <span class="bu">repr</span>(delta.<span class="bu">min</span>()) <span class="op">+</span> <span class="st">' - '</span> <span class="op">+</span> <span class="bu">repr</span>(delta.<span class="bu">max</span>())</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>range: 5.0 - 20.0

27     8.0 
36     6.0 
77     7.0 
100    20.0
137    5.0 
141    6.0 
201    9.0 
217    6.0 
231    6.0 
250    5.0 
275    5.0 
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>attr<span class="op">=</span><span class="st">'PQF (WB)'</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'total cities: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[<span class="op">~</span>df[attr].isnull(), var_city].count())</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'inconsistent cities: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, var_city].count() )</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[attr]<span class="op">==</span><span class="dv">1</span>, var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total cities: 20
inconsistent cities: 17
3</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="bu">abs</span>(df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, refyr] <span class="op">-</span> df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, <span class="st">'population_year (WB)'</span>] )</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'range: '</span> <span class="op">+</span> <span class="bu">repr</span>(delta.<span class="bu">min</span>()) <span class="op">+</span> <span class="st">' - '</span> <span class="op">+</span> <span class="bu">repr</span>(delta.<span class="bu">max</span>())</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>range: 6.0 - 15.0

19     8.0 
26     6.0 
53     12.0
55     6.0 
78     9.0 
101    10.0
178    13.0
187    14.0
189    9.0 
206    10.0
227    9.0 
243    14.0
261    11.0
264    7.0 
268    15.0
291    8.0 
294    8.0 
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>attr<span class="op">=</span><span class="st">'PQF (WB2010)'</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'total cities: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[<span class="op">~</span>df[attr].isnull(), var_city].count())</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'inconsistent cities: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, var_city].count() )</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[attr]<span class="op">==</span><span class="dv">1</span>, var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total cities: 20
inconsistent cities: 2
18</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>attr<span class="op">=</span><span class="st">'PQF (OTHERS)'</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'total cities: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[<span class="op">~</span>df[attr].isnull(), var_city].count())</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'inconsistent cities: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, var_city].count() )</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[attr]<span class="op">==</span><span class="dv">1</span>, var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total cities: 269
inconsistent cities: 59
210</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="bu">abs</span>(df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, refyr] <span class="op">-</span> df.loc[df[attr]<span class="op">==</span><span class="dv">0</span>, popyr_others] )</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'range: '</span> <span class="op">+</span> <span class="bu">repr</span>(delta.<span class="bu">min</span>()) <span class="op">+</span> <span class="st">' - '</span> <span class="op">+</span> <span class="bu">repr</span>(delta.<span class="bu">max</span>())</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> delta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>range: 5.0 - 22.0

1      6.0 
8      6.0 
23     9.0 
30     5.0 
33     6.0 
36     6.0 
41     7.0 
47     6.0 
48     5.0 
49     6.0 
52     6.0 
65     6.0 
72     6.0 
76     6.0 
81     5.0 
89     10.0
92     6.0 
97     5.0 
99     6.0 
100    22.0
106    5.0 
110    11.0
117    5.0 
123    6.0 
137    7.0 
141    9.0 
161    9.0 
162    9.0 
185    12.0
191    7.0 
199    7.0 
201    10.0
217    5.0 
218    5.0 
220    6.0 
221    22.0
222    5.0 
235    5.0 
236    5.0 
245    6.0 
251    7.0 
256    5.0 
257    5.0 
261    6.0 
265    6.0 
267    6.0 
272    7.0 
275    5.0 
292    5.0 
298    5.0 
302    11.0
304    8.0 
306    11.0
312    8.0 
313    5.0 
315    18.0
319    5.0 
330    6.0 
342    7.0 
dtype: float64</code></pre>
</div>
</div>
</section>
</section>
<section id="tqf-household-size" class="level2">
<h2 class="anchored" data-anchor-id="tqf-household-size">TQF household size</h2>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>hhyr_others <span class="op">=</span> <span class="st">'year_household_size (updated) (others)'</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>hhyr_gea <span class="op">=</span> <span class="st">'year_household_size (GEA+)'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[(<span class="op">~</span>df[hhyr_others].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df[hhyr_gea].isnull()), var_city].count()</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>df.loc[(<span class="op">~</span>df[hhyr_others].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df[hhyr_gea].isnull()), [var_city, <span class="st">'Scope 1 year'</span>,hhyr_gea, hhyr_others] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>52</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/homel/cnangini/anaconda2/lib/python2.7/site-packages/ipykernel_launcher.py:2: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  </code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="43">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Scope 1 year</th>
      <th>year_household_size (GEA+)</th>
      <th>year_household_size (updated) (others)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>Amsterdam</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Athens</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Atlanta</td>
      <td>NaN</td>
      <td>2010</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Austin</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Barcelona</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Birmingham</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Bologna</td>
      <td>NaN</td>
      <td>2004</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Boulder</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Brasília</td>
      <td>NaN</td>
      <td>2010</td>
      <td>2010</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Buffalo City</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Calgary</td>
      <td>NaN</td>
      <td>2006.0</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Cape Town</td>
      <td>NaN</td>
      <td>2008.0</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Chicago</td>
      <td>NaN</td>
      <td>2010</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Copenhagen</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Curitiba</td>
      <td>NaN</td>
      <td>2010</td>
      <td>2010</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Denver</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>101</th>
      <td>Greater London</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>109</th>
      <td>Hamburg</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>119</th>
      <td>Helsinki</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>126</th>
      <td>Hong Kong</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>127</th>
      <td>Houston</td>
      <td>NaN</td>
      <td>2010</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>137</th>
      <td>Istanbul</td>
      <td>NaN</td>
      <td>2000.0</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>149</th>
      <td>Johannesburg</td>
      <td>NaN</td>
      <td>2007.0</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>168</th>
      <td>Leicester</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>173</th>
      <td>Lisbon</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>175</th>
      <td>Ljubljana</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Los Angeles</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>181</th>
      <td>Madrid</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>185</th>
      <td>Manchester</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>186</th>
      <td>Melbourne</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>187</th>
      <td>Mexico City</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>188</th>
      <td>Milano</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Minneapolis</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>206</th>
      <td>New York City</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>213</th>
      <td>Oslo</td>
      <td>NaN</td>
      <td>2004.0</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>216</th>
      <td>Paris</td>
      <td>NaN</td>
      <td>? (2006?)</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>227</th>
      <td>Portland, OR</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>230</th>
      <td>Pretoria Tshwane</td>
      <td>NaN</td>
      <td>2007</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>243</th>
      <td>Rio de Janeiro</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2010</td>
    </tr>
    <tr>
      <th>245</th>
      <td>Roma</td>
      <td>NaN</td>
      <td>2004</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>251</th>
      <td>San Diego</td>
      <td>NaN</td>
      <td>2010</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>252</th>
      <td>San Francisco</td>
      <td>NaN</td>
      <td>2010</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>264</th>
      <td>Seattle</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>268</th>
      <td>Seoul</td>
      <td>NaN</td>
      <td>2009.0</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>279</th>
      <td>Stockholm</td>
      <td>NaN</td>
      <td>2011</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>283</th>
      <td>Sydney</td>
      <td>NaN</td>
      <td>2011</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>291</th>
      <td>Tokyo</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>293</th>
      <td>Torino</td>
      <td>NaN</td>
      <td>2004</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>294</th>
      <td>Toronto</td>
      <td>NaN</td>
      <td>2006.0</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>305</th>
      <td>Vancouver</td>
      <td>NaN</td>
      <td>2006</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>338</th>
      <td>Zürich</td>
      <td>NaN</td>
      <td>2000</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Örebro</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2017</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#NB: Paris GEA+ household value is a string</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>df.loc[(df[var_city]<span class="op">==</span><span class="st">'Paris'</span>) , <span class="st">'year_household_size (GEA+)'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>216    ? (2006?)
Name: year_household_size (GEA+), dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Figure out flag value for string year range in external HH year</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> hhyr_others</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>condnan <span class="op">=</span> (<span class="op">~</span>df[attr].isnull())</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>conds1 <span class="op">=</span>  (df[attr]<span class="op">==</span><span class="st">'2011-2015'</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>conds2 <span class="op">=</span>  (df[attr]<span class="op">==</span><span class="st">'2016-2017'</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>conds3 <span class="op">=</span>  (df[attr]<span class="op">==</span><span class="st">'2012-2016'</span>)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[condnan <span class="op">&amp;</span> conds1 <span class="op">|</span> conds2 <span class="op">|</span> conds3, var_city].count()</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>df.loc[condnan <span class="op">&amp;</span> conds1 <span class="op">|</span> conds2 <span class="op">|</span> conds3, [var_city,<span class="st">'Scope 1 year'</span>,attr] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>65</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/homel/cnangini/anaconda2/lib/python2.7/site-packages/ipykernel_launcher.py:9: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  if __name__ == '__main__':</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="45">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Scope 1 year</th>
      <th>year_household_size (updated) (others)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Abington</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Albany</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Alton, IL</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Arlington, VA</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Aspen and Pitkin County</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Atlanta</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Austin</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Baltimore</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Benicia</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Blacksburg</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Boston</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Boulder</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Brisbane, CA</td>
      <td>NaN</td>
      <td>2016-2017</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Burlington</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Chicago</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Cleveland</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>68</th>
      <td>Columbus</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Dallas</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>76</th>
      <td>Davis, CA</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Denver</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Detroit</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>80</th>
      <td>District of Columbia</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Durham</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Emeryville, CA</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Eugene</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Flagstaff</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Fort Collins</td>
      <td>NaN</td>
      <td>2012-2016</td>
    </tr>
    <tr>
      <th>114</th>
      <td>Hayward</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>121</th>
      <td>Hermosa Beach, CA</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>127</th>
      <td>Houston</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>164</th>
      <td>Lancaster, PA</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>166</th>
      <td>Las Vegas</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Los Altos Hills</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Los Angeles</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Minneapolis</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>202</th>
      <td>Nashville and Davidson</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>204</th>
      <td>New Orleans</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>206</th>
      <td>New York City</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>210</th>
      <td>Oakland</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>215</th>
      <td>Palo Alto</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>219</th>
      <td>Philadelphia</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>222</th>
      <td>Piedmont, CA</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>226</th>
      <td>Pittsburgh</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>227</th>
      <td>Portland, OR</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>240</th>
      <td>Reno</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>242</th>
      <td>Richmond, VA</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>244</th>
      <td>Roanoke</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>249</th>
      <td>San Antonio</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>251</th>
      <td>San Diego</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>252</th>
      <td>San Francisco</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>255</th>
      <td>Santa Monica</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>263</th>
      <td>Savannah</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>264</th>
      <td>Seattle</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>276</th>
      <td>Somerville, MA</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>278</th>
      <td>St Louis</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>296</th>
      <td>Tucson</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>302</th>
      <td>University City, MO</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>307</th>
      <td>Vilnius</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>312</th>
      <td>West Hollywood</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
    <tr>
      <th>330</th>
      <td>Yonkers</td>
      <td>NaN</td>
      <td>2011-2015</td>
    </tr>
  </tbody>
</table>
<p>65 rows × 3 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="bu">int</span>(df.loc[condnan <span class="op">&amp;</span> conds1 <span class="op">|</span> conds2 <span class="op">|</span> conds3, attr].<span class="bu">str</span>.split(<span class="st">'-'</span>).tolist()[<span class="dv">0</span>][<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2011</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>f, axs <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>edgeColour <span class="op">=</span> <span class="st">'#75766D'</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>barfill <span class="op">=</span> <span class="st">'#E2D5C1'</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>(df[refyr]<span class="op">-</span>df.loc[(df[var_city]<span class="op">!=</span><span class="st">'Paris'</span>) , <span class="st">'year_household_size (GEA+)'</span>].<span class="bu">apply</span>(pd.to_numeric) ).hist(color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'count'</span>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'HH size year diff (GEA+)'</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">15</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=-</span><span class="dv">15</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>, <span class="dv">50</span>))</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>condnan <span class="op">=</span> (<span class="op">~</span>df[hhyr_others].isnull())</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>condr1 <span class="op">=</span>  (df[hhyr_others]<span class="op">!=</span><span class="st">'2011-2015'</span>)</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>condr2 <span class="op">=</span>  (df[hhyr_others]<span class="op">!=</span><span class="st">'2016-2017'</span>)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>condr3 <span class="op">=</span>  (df[hhyr_others]<span class="op">!=</span><span class="st">'2012-2016'</span>)</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>(df[refyr]<span class="op">-</span> df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, hhyr_others].astype(<span class="st">'int'</span>)  ).hist(color<span class="op">=</span>barfill, ec<span class="op">=</span>edgeColour)</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'HH size year diff (others)'</span>)</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">15</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=-</span><span class="dv">15</span>, color<span class="op">=</span><span class="st">'m'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>plt.ylim((<span class="dv">0</span>, <span class="dv">50</span>))</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>f.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="TechnicalValidation_qualityFlags_files/figure-html/cell-59-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_computeTQF_hh(df,refyr, attr, qflag):</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Add quality flag 0 or 1 to col 'qflag' if abs(refyr - attr) is &gt;= c or &lt; c, respectively, where</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co">        cutoff 'c' = 5 years for population and 15 years for household size given the slow changes of this variable.</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="dv">15</span> <span class="co">#cutoff year for household size</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    df[qflag] <span class="op">=</span> np.nan</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> attr <span class="op">==</span> <span class="st">'year_household_size (GEA+)'</span>:</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>        cond <span class="op">=</span> (df[var_city]<span class="op">!=</span><span class="st">'Paris'</span>)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>        df[qflag] <span class="op">=</span> df.loc[(df[refyr]<span class="op">-</span>df.loc[cond,attr].<span class="bu">apply</span>(pd.to_numeric) ).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, qflag] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>        df[qflag] <span class="op">=</span> df.loc[(df[refyr]<span class="op">-</span>df.loc[cond,attr].<span class="bu">apply</span>(pd.to_numeric) ).<span class="bu">abs</span>() <span class="op">&lt;</span>c, qflag] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> <span class="st">'Temporal Quality Flag = 0 count: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[ (df[refyr] <span class="op">-</span> df.loc[cond, attr].<span class="bu">apply</span>(pd.to_numeric) ).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, var_city].count())    </span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> <span class="st">'Temporal Quality Flag = 1 count: '</span> <span class="op">+</span> <span class="bu">repr</span>(df.loc[ (df[refyr] <span class="op">-</span> df.loc[cond, attr].<span class="bu">apply</span>(pd.to_numeric) ).<span class="bu">abs</span>() <span class="op">&lt;</span> c, var_city].count())</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> attr <span class="op">==</span> <span class="st">'year_household_size (updated) (external)'</span>:</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">#First compute flags for all numerical values</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>        condnan <span class="op">=</span> (<span class="op">~</span>df[attr].isnull())</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>        condr1 <span class="op">=</span>  (df[attr]<span class="op">!=</span><span class="st">'2011-2015'</span>)</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>        condr2 <span class="op">=</span>  (df[attr]<span class="op">!=</span><span class="st">'2016-2017'</span>)</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>        condr3 <span class="op">=</span>  (df[attr]<span class="op">!=</span><span class="st">'2012-2016'</span>)</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>        df[qflag] <span class="op">=</span> df.loc[ (df[refyr]<span class="op">-</span> df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr].astype(<span class="st">'int'</span>)).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, qflag] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>        df[qflag] <span class="op">=</span> df.loc[ (df[refyr]<span class="op">-</span> df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr].astype(<span class="st">'int'</span>)).<span class="bu">abs</span>() <span class="op">&lt;</span> c, qflag] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> df.loc[ (df[refyr]<span class="op">-</span> df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr].astype(<span class="st">'int'</span>)).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, var_city].count()</span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>fn_computeTQF_hh(df,refyr, <span class="st">'year_household_size (GEA+)'</span>, <span class="st">'HQF (GEA+)'</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Temporal Quality Flag = 0 count: 0
Temporal Quality Flag = 1 count: 102
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Clean up</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>qflag <span class="op">=</span> <span class="st">'HQF (GEA+)'</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>attr<span class="op">=</span><span class="st">'year_household_size (GEA+)'</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>df.loc[(df[<span class="st">'year_household_size (GEA+)'</span>].isnull()),qflag]<span class="op">=</span>np.nan</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>df.loc[(df[<span class="st">'year_household_size (GEA+)'</span>].isnull()), [var_city, refyr,attr,qflag] ].head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Year of Emission</th>
      <th>year_household_size (GEA+)</th>
      <th>HQF (GEA+)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aarhus</td>
      <td>2016.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Abington</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Addis Ababa</td>
      <td>2012.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute 'TQF household size (external)' manually</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>c<span class="op">=</span><span class="dv">15</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> hhyr_others</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>qflag<span class="op">=</span><span class="st">'HQF (OTHERS)'</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>condnan <span class="op">=</span> (<span class="op">~</span>df[attr].isnull())</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>condr1 <span class="op">=</span>  (df[attr]<span class="op">!=</span><span class="st">'2011-2015'</span>)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>condr2 <span class="op">=</span>  (df[attr]<span class="op">!=</span><span class="st">'2016-2017'</span>)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>condr3 <span class="op">=</span>  (df[attr]<span class="op">!=</span><span class="st">'2012-2016'</span>)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[ (df[refyr]<span class="op">-</span> pd.to_numeric(df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr]) ).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, var_city].count()</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>df.loc[ (df[refyr]<span class="op">-</span> pd.to_numeric(df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr]) ).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, qflag] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>df.loc[ (df[refyr]<span class="op">-</span> pd.to_numeric(df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr]) ).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, [var_city, refyr,attr,<span class="st">'HQF (OTHERS)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="51">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Year of Emission</th>
      <th>year_household_size (updated) (others)</th>
      <th>HQF (OTHERS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>Graz</td>
      <td>1994.0</td>
      <td>2013</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>221</th>
      <td>Piacenza</td>
      <td>1990.0</td>
      <td>2013</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[ (df[refyr]<span class="op">-</span> pd.to_numeric(df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr]) ).<span class="bu">abs</span>() <span class="op">&lt;</span> c, var_city].count()</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>df.loc[ (df[refyr]<span class="op">-</span> pd.to_numeric(df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr]) ).<span class="bu">abs</span>() <span class="op">&lt;</span> c, qflag] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>df.loc[ (df[refyr]<span class="op">-</span> pd.to_numeric(df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr]) ).<span class="bu">abs</span>() <span class="op">&lt;</span> c, [var_city, refyr,attr,<span class="st">'HQF (OTHERS)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>109</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Year of Emission</th>
      <th>year_household_size (updated) (others)</th>
      <th>HQF (OTHERS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aarhus</td>
      <td>2016.0</td>
      <td>2017</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelaide</td>
      <td>2013.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Aerøskøbing</td>
      <td>2015.0</td>
      <td>2017</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Ajax, ON</td>
      <td>2008.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Amman</td>
      <td>2014.0</td>
      <td>2008</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Amsterdam</td>
      <td>2016.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Athens</td>
      <td>2014.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Auckland</td>
      <td>2013.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Barcelona</td>
      <td>2012.0</td>
      <td>2014</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Barreiro</td>
      <td>2014.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Basel</td>
      <td>2016.0</td>
      <td>2014</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Belo Horizonte</td>
      <td>2013.0</td>
      <td>2010</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Birmingham</td>
      <td>2013.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Bogotá</td>
      <td>2015.0</td>
      <td>2016</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Bologna</td>
      <td>2009.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Bournemouth</td>
      <td>2013.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Brasília</td>
      <td>2012.0</td>
      <td>2010</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Buffalo City</td>
      <td>2007.0</td>
      <td>2007</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Calgary</td>
      <td>2015.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Canberra</td>
      <td>2015.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Cape Town</td>
      <td>2012.0</td>
      <td>2008</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Cardiff</td>
      <td>2013.0</td>
      <td>2012</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Copenhagen</td>
      <td>2015.0</td>
      <td>2017</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Curitiba</td>
      <td>2013.0</td>
      <td>2010</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Dublin</td>
      <td>2011.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Edmonton</td>
      <td>2014.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Faro</td>
      <td>2010.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Ferrara</td>
      <td>2007.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Florianópolis</td>
      <td>2013.0</td>
      <td>2010</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Genova</td>
      <td>2011.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>243</th>
      <td>Rio de Janeiro</td>
      <td>2012.0</td>
      <td>2010</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>245</th>
      <td>Roma</td>
      <td>2010.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>247</th>
      <td>Rotterdam</td>
      <td>2016.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>248</th>
      <td>Salvador</td>
      <td>2013.0</td>
      <td>2010</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>254</th>
      <td>San Luis Potosí</td>
      <td>2015.0</td>
      <td>2016</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>258</th>
      <td>Santiago</td>
      <td>2013.0</td>
      <td>2010</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>262</th>
      <td>Sapporo</td>
      <td>2014.0</td>
      <td>2018</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>268</th>
      <td>Seoul</td>
      <td>2013.0</td>
      <td>2017</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>277</th>
      <td>Sorocaba</td>
      <td>2012.0</td>
      <td>2010</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>279</th>
      <td>Stockholm</td>
      <td>2015.0</td>
      <td>2016</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>281</th>
      <td>Suwon</td>
      <td>2013.0</td>
      <td>2015</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>283</th>
      <td>Sydney</td>
      <td>2015.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>285</th>
      <td>Taipei City</td>
      <td>2014.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>288</th>
      <td>Taoyuan</td>
      <td>2014.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>291</th>
      <td>Tokyo</td>
      <td>2014.0</td>
      <td>2017</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>293</th>
      <td>Torino</td>
      <td>2014.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>294</th>
      <td>Toronto</td>
      <td>2013.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>297</th>
      <td>Turku</td>
      <td>2013.0</td>
      <td>2014</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>300</th>
      <td>Udine</td>
      <td>2013.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>305</th>
      <td>Vancouver</td>
      <td>2014.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>306</th>
      <td>Venezia</td>
      <td>2005.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>309</th>
      <td>Warsaw</td>
      <td>2014.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>311</th>
      <td>Wellington</td>
      <td>2014.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>314</th>
      <td>Windsor, ON</td>
      <td>2014.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>315</th>
      <td>Winnipeg</td>
      <td>1998.0</td>
      <td>2011</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>327</th>
      <td>Yilan</td>
      <td>2013.0</td>
      <td>2013</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>329</th>
      <td>Yokohama</td>
      <td>2013.0</td>
      <td>2015</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>331</th>
      <td>Zaragoza</td>
      <td>2014.0</td>
      <td>2014</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>338</th>
      <td>Zürich</td>
      <td>2014.0</td>
      <td>2014</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Örebro</td>
      <td>2015.0</td>
      <td>2017</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>109 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[ (df[refyr]<span class="op">-</span> pd.to_numeric(df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr]) ).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, var_city].count()</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[ (df[refyr]<span class="op">-</span> pd.to_numeric(df.loc[condnan <span class="op">&amp;</span> condr1 <span class="op">&amp;</span> condr2 <span class="op">&amp;</span> condr3, attr]) ).<span class="bu">abs</span>() <span class="op">&lt;</span> c, var_city].count()</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[qflag]<span class="op">==</span><span class="dv">0</span>, var_city].count()</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[qflag]<span class="op">==</span><span class="dv">1</span>, var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2
109

2
109</code></pre>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Next compute flags for string year ranges (eg '2011-2015')</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>conds1 <span class="op">=</span>  (df[attr]<span class="op">==</span><span class="st">'2011-2015'</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>conds2 <span class="op">=</span>  (df[attr]<span class="op">==</span><span class="st">'2016-2017'</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>conds3 <span class="op">=</span>  (df[attr]<span class="op">==</span><span class="st">'2012-2016'</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Check if min year in range exceeds emissions year</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>df[qflag] <span class="op">=</span> df.loc[ (df[refyr]<span class="op">-</span>  <span class="bu">int</span>(df.loc[condnan <span class="op">&amp;</span> conds1 <span class="op">|</span> conds2 <span class="op">|</span> conds3, attr].<span class="bu">str</span>.split(<span class="st">'-'</span>).tolist()[<span class="dv">0</span>][<span class="dv">0</span>]) ).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, qflag] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[ (df[refyr]<span class="op">-</span>  <span class="bu">int</span>(df.loc[condnan <span class="op">&amp;</span> conds1 <span class="op">|</span> conds2 <span class="op">|</span> conds3, attr].<span class="bu">str</span>.split(<span class="st">'-'</span>).tolist()[<span class="dv">0</span>][<span class="dv">0</span>]) ).<span class="bu">abs</span>() <span class="op">&gt;=</span> c, var_city].count()</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>df.loc[ (df[refyr]<span class="op">-</span>  <span class="bu">int</span>(df.loc[condnan <span class="op">&amp;</span> conds1 <span class="op">|</span> conds2 <span class="op">|</span> conds3, attr].<span class="bu">str</span>.split(<span class="st">'-'</span>).tolist()[<span class="dv">0</span>][<span class="dv">0</span>]) ).<span class="bu">abs</span>() <span class="op">&gt;=</span> c,[var_city, refyr,attr,<span class="st">'HQF (OTHERS)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="54">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Year of Emission</th>
      <th>year_household_size (updated) (others)</th>
      <th>HQF (OTHERS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>Graz</td>
      <td>1994.0</td>
      <td>2013</td>
      <td>0</td>
    </tr>
    <tr>
      <th>221</th>
      <td>Piacenza</td>
      <td>1990.0</td>
      <td>2013</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check if min year in range is within c years of emissions year  </span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>condnan <span class="op">=</span> (<span class="op">~</span>df[attr].isnull()) </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>df[qflag] <span class="op">=</span> df.loc[(df[refyr]<span class="op">-</span>  <span class="bu">int</span>(df.loc[condnan <span class="op">&amp;</span> conds1 <span class="op">|</span> conds2 <span class="op">|</span> conds3, attr].<span class="bu">str</span>.split(<span class="st">'-'</span>).tolist()[<span class="dv">0</span>][<span class="dv">0</span>]) ).<span class="bu">abs</span>() <span class="op">&lt;</span> c, qflag] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[ (df[refyr]<span class="op">-</span>  <span class="bu">int</span>(df.loc[condnan <span class="op">&amp;</span> conds1 <span class="op">|</span> conds2 <span class="op">|</span> conds3, attr].<span class="bu">str</span>.split(<span class="st">'-'</span>).tolist()[<span class="dv">0</span>][<span class="dv">0</span>]) ).<span class="bu">abs</span>() <span class="op">&lt;</span> c, var_city].count()</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>df.loc[ (df[refyr]<span class="op">-</span>  <span class="bu">int</span>(df.loc[condnan <span class="op">&amp;</span> conds1 <span class="op">|</span> conds2 <span class="op">|</span> conds3, attr].<span class="bu">str</span>.split(<span class="st">'-'</span>).tolist()[<span class="dv">0</span>][<span class="dv">0</span>]) ).<span class="bu">abs</span>() <span class="op">&lt;</span> c,[var_city, refyr,attr,<span class="st">'HQF (others)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>341</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/homel/cnangini/anaconda2/lib/python2.7/site-packages/ipykernel_launcher.py:7: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  import sys</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="55">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Year of Emission</th>
      <th>year_household_size (updated) (others)</th>
      <th>HQF (others)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aarhus</td>
      <td>2016.0</td>
      <td>2017</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Abington</td>
      <td>2010.0</td>
      <td>2011-2015</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Addis Ababa</td>
      <td>2012.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelaide</td>
      <td>2013.0</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Aerøskøbing</td>
      <td>2015.0</td>
      <td>2017</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Aguascalientes</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ahmedabad</td>
      <td>2008.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Ajax, ON</td>
      <td>2008.0</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Albany</td>
      <td>2010.0</td>
      <td>2011-2015</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Alton, IL</td>
      <td>2013.0</td>
      <td>2011-2015</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Amman</td>
      <td>2014.0</td>
      <td>2008</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Amsterdam</td>
      <td>2016.0</td>
      <td>2013</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Anshan</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Anyang</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Arlington, VA</td>
      <td>2015.0</td>
      <td>2011-2015</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Aspen and Pitkin County</td>
      <td>2014.0</td>
      <td>2011-2015</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Athens</td>
      <td>2014.0</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Atlanta</td>
      <td>2014.0</td>
      <td>2011-2015</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Auckland</td>
      <td>2013.0</td>
      <td>2013</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Austin</td>
      <td>2013.0</td>
      <td>2011-2015</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Balikpapan</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Baltimore</td>
      <td>2014.0</td>
      <td>2011-2015</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Bandung</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Bangalore</td>
      <td>2008.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Baoding</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Baotou</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Barcelona</td>
      <td>2012.0</td>
      <td>2014</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Barranquilla</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Barreiro</td>
      <td>2014.0</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Basel</td>
      <td>2016.0</td>
      <td>2014</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>313</th>
      <td>Windhoek</td>
      <td>2016.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>314</th>
      <td>Windsor, ON</td>
      <td>2014.0</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>315</th>
      <td>Winnipeg</td>
      <td>1998.0</td>
      <td>2011</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>316</th>
      <td>Wonju</td>
      <td>2012.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>317</th>
      <td>Wuhan</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>318</th>
      <td>Wuxi</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>319</th>
      <td>Xi'an, Shaanxi</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>320</th>
      <td>Xiamen</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>321</th>
      <td>Xiangtan</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>322</th>
      <td>Xiangyang</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>323</th>
      <td>Xining</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>324</th>
      <td>Xinxiang</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>325</th>
      <td>Xuzhou</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>326</th>
      <td>Yantai</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>327</th>
      <td>Yilan</td>
      <td>2013.0</td>
      <td>2013</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>328</th>
      <td>Yinchuan</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>329</th>
      <td>Yokohama</td>
      <td>2013.0</td>
      <td>2015</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>330</th>
      <td>Yonkers</td>
      <td>2010.0</td>
      <td>2011-2015</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>331</th>
      <td>Zaragoza</td>
      <td>2014.0</td>
      <td>2014</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>332</th>
      <td>Zhangjiakou</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>333</th>
      <td>Zhanjiang</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>334</th>
      <td>Zhaozhuang</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>335</th>
      <td>Zhengzhou</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>336</th>
      <td>Zhuzhou</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>337</th>
      <td>Zibo</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>338</th>
      <td>Zürich</td>
      <td>2014.0</td>
      <td>2014</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>339</th>
      <td>eThekwini</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Águeda</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Örebro</td>
      <td>2015.0</td>
      <td>2017</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Ürümqi (Wulumqi)</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>341 rows × 4 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="clean-up" class="level1">
<h1>Clean up</h1>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Clean up</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>df.loc[df[var_city]<span class="op">==</span><span class="st">'Graz'</span> ,<span class="st">'HQF (OTHERS)'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>df.loc[df[var_city]<span class="op">==</span><span class="st">'Piacenza'</span> ,<span class="st">'HQF (OTHERS)'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>df.loc[df[var_city]<span class="op">==</span><span class="st">'Graz'</span> ,[var_city, <span class="st">'Scope 1 year'</span>,<span class="st">'year_household_size (GEA+)'</span>, hhyr_others,<span class="st">'HQF (GEA+)'</span>,<span class="st">'HQF (OTHERS)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/homel/cnangini/anaconda2/lib/python2.7/site-packages/ipykernel_launcher.py:4: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  after removing the cwd from sys.path.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="56">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Scope 1 year</th>
      <th>year_household_size (GEA+)</th>
      <th>year_household_size (updated) (others)</th>
      <th>HQF (GEA+)</th>
      <th>HQF (OTHERS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>Graz</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2013</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>df.loc[(df[hhyr_others].isnull()), <span class="st">'HQF (OTHERS)'</span>] <span class="op">=</span> np.nan</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>df.loc[(df[hhyr_others].isnull()), [var_city, <span class="st">'Scope 1 year'</span>, hhyr_others,<span class="st">'HQF (OTHERS)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/homel/cnangini/anaconda2/lib/python2.7/site-packages/ipykernel_launcher.py:2: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  </code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="57">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Scope 1 year</th>
      <th>year_household_size (updated) (others)</th>
      <th>HQF (OTHERS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Addis Ababa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Aguascalientes</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ahmedabad</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Anshan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Anyang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Balikpapan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Bandung</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Bangalore</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Baoding</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Baotou</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Barranquilla</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Batangas</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Beijing</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Benxi</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Betim</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Bhubaneswar</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Bogor</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Bornova</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Bristol</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Brussels</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Buenos Aires</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Caracas</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Cascais</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Changchun</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Changsha, Hunan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Changzhou</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Chengdou</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>64</th>
      <td>Chongqing</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Cochin</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Coimbatore</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>295</th>
      <td>Torres Vedras</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>298</th>
      <td>Tuxtla Gutiérrez</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>299</th>
      <td>Ubon Ratchathani</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>301</th>
      <td>Umeå</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>303</th>
      <td>Uppsala</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>304</th>
      <td>Valledupar</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>308</th>
      <td>Växjö</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>310</th>
      <td>Weifang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>313</th>
      <td>Windhoek</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>316</th>
      <td>Wonju</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>317</th>
      <td>Wuhan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>318</th>
      <td>Wuxi</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>319</th>
      <td>Xi'an, Shaanxi</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>320</th>
      <td>Xiamen</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>321</th>
      <td>Xiangtan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>322</th>
      <td>Xiangyang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>323</th>
      <td>Xining</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>324</th>
      <td>Xinxiang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>325</th>
      <td>Xuzhou</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>326</th>
      <td>Yantai</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>328</th>
      <td>Yinchuan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>332</th>
      <td>Zhangjiakou</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>333</th>
      <td>Zhanjiang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>334</th>
      <td>Zhaozhuang</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>335</th>
      <td>Zhengzhou</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>336</th>
      <td>Zhuzhou</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>337</th>
      <td>Zibo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>339</th>
      <td>eThekwini</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Águeda</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Ürümqi (Wulumqi)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>167 rows × 4 columns</p>
</div>
</div>
</div>
</section>
<section id="check" class="level1">
<h1>Check</h1>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>df[ [var_city, refyr,<span class="st">'year_household_size (GEA+)'</span>, hhyr_others,<span class="st">'HQF (GEA+)'</span>,<span class="st">'HQF (OTHERS)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Year of Emission</th>
      <th>year_household_size (GEA+)</th>
      <th>year_household_size (updated) (others)</th>
      <th>HQF (GEA+)</th>
      <th>HQF (OTHERS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aarhus</td>
      <td>2016.0</td>
      <td>NaN</td>
      <td>2017</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Abington</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>2011-2015</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Addis Ababa</td>
      <td>2012.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelaide</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>2011</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Aerøskøbing</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>2017</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Aguascalientes</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ahmedabad</td>
      <td>2008.0</td>
      <td>2011.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Ajax, ON</td>
      <td>2008.0</td>
      <td>NaN</td>
      <td>2011</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Albany</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>2011-2015</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Alton, IL</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>2011-2015</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Amman</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>2008</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Amsterdam</td>
      <td>2016.0</td>
      <td>2004.0</td>
      <td>2013</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Anshan</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Anyang</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Arlington, VA</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>2011-2015</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Aspen and Pitkin County</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>2011-2015</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Athens</td>
      <td>2014.0</td>
      <td>2004.0</td>
      <td>2011</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Atlanta</td>
      <td>2014.0</td>
      <td>2010</td>
      <td>2011-2015</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Auckland</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>2013</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Austin</td>
      <td>2013.0</td>
      <td>2010.0</td>
      <td>2011-2015</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Balikpapan</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Baltimore</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>2011-2015</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Bandung</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Bangalore</td>
      <td>2008.0</td>
      <td>2011.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Baoding</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Baotou</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Barcelona</td>
      <td>2012.0</td>
      <td>2004.0</td>
      <td>2014</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Barranquilla</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Barreiro</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>2011</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Basel</td>
      <td>2016.0</td>
      <td>NaN</td>
      <td>2014</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>313</th>
      <td>Windhoek</td>
      <td>2016.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>314</th>
      <td>Windsor, ON</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>2011</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>315</th>
      <td>Winnipeg</td>
      <td>1998.0</td>
      <td>NaN</td>
      <td>2011</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>316</th>
      <td>Wonju</td>
      <td>2012.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>317</th>
      <td>Wuhan</td>
      <td>2010.0</td>
      <td>2003</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>318</th>
      <td>Wuxi</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>319</th>
      <td>Xi'an, Shaanxi</td>
      <td>2010.0</td>
      <td>2003</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>320</th>
      <td>Xiamen</td>
      <td>2010.0</td>
      <td>2003</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>321</th>
      <td>Xiangtan</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>322</th>
      <td>Xiangyang</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>323</th>
      <td>Xining</td>
      <td>2010.0</td>
      <td>2003</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>324</th>
      <td>Xinxiang</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>325</th>
      <td>Xuzhou</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>326</th>
      <td>Yantai</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>327</th>
      <td>Yilan</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>2013</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>328</th>
      <td>Yinchuan</td>
      <td>2010.0</td>
      <td>2003</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>329</th>
      <td>Yokohama</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>2015</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>330</th>
      <td>Yonkers</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>2011-2015</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>331</th>
      <td>Zaragoza</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>2014</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>332</th>
      <td>Zhangjiakou</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>333</th>
      <td>Zhanjiang</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>334</th>
      <td>Zhaozhuang</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>335</th>
      <td>Zhengzhou</td>
      <td>2010.0</td>
      <td>2003</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>336</th>
      <td>Zhuzhou</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>337</th>
      <td>Zibo</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>338</th>
      <td>Zürich</td>
      <td>2014.0</td>
      <td>2000</td>
      <td>2014</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>339</th>
      <td>eThekwini</td>
      <td>2015.0</td>
      <td>2007.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>340</th>
      <td>Águeda</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Örebro</td>
      <td>2015.0</td>
      <td>2011.0</td>
      <td>2017</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>342</th>
      <td>Ürümqi (Wulumqi)</td>
      <td>2010.0</td>
      <td>2003</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>343 rows × 6 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>df.loc[df[var_city]<span class="op">==</span><span class="st">'Graz'</span> ,[var_city, refyr,<span class="st">'year_household_size (GEA+)'</span>, hhyr_others,<span class="st">'HQF (GEA+)'</span>,<span class="st">'HQF (OTHERS)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Year of Emission</th>
      <th>year_household_size (GEA+)</th>
      <th>year_household_size (updated) (others)</th>
      <th>HQF (GEA+)</th>
      <th>HQF (OTHERS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>Graz</td>
      <td>1994.0</td>
      <td>NaN</td>
      <td>2013</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>df.loc[df[var_city]<span class="op">==</span><span class="st">'Piacenza'</span> ,[var_city, refyr,<span class="st">'year_household_size (GEA+)'</span>, hhyr_others,<span class="st">'HQF (GEA+)'</span>,<span class="st">'HQF (OTHERS)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Year of Emission</th>
      <th>year_household_size (GEA+)</th>
      <th>year_household_size (updated) (others)</th>
      <th>HQF (GEA+)</th>
      <th>HQF (OTHERS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>221</th>
      <td>Piacenza</td>
      <td>1990.0</td>
      <td>NaN</td>
      <td>2013</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[<span class="op">~</span>df[<span class="st">'HQF (GEA+)'</span>].isnull(), var_city].count()</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[<span class="st">'HQF (GEA+)'</span>]<span class="op">==</span><span class="dv">0</span>, var_city].count()</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[<span class="st">'HQF (GEA+)'</span>]<span class="op">==</span><span class="dv">1</span>, var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>103
0
103</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[<span class="op">~</span>df[<span class="st">'HQF (OTHERS)'</span>].isnull(), var_city].count()</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[<span class="st">'HQF (OTHERS)'</span>]<span class="op">==</span><span class="dv">0</span>, var_city].count()</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.loc[df[<span class="st">'HQF (OTHERS)'</span>]<span class="op">==</span><span class="dv">1</span>, var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>176
2
174</code></pre>
</div>
</div>
</section>
<section id="drop-dummy-col" class="level1">
<h1>Drop dummy col</h1>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>df.drop(<span class="st">'dummy'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rename-columns-to-match-manuscript" class="level1">
<h1>Rename columns to match manuscript</h1>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'city name'</span>:<span class="st">'City name'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'country'</span>:<span class="st">'Country'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'region'</span>:<span class="st">'Region'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'City Name (CDP)'</span>:<span class="st">'City name (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'full city name (carbonn)'</span>:<span class="st">'City name (carbonn)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'full city name (PKU)'</span>:<span class="st">'City name (PKU)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'full city name (GEA)'</span>:<span class="st">'City name (GEA)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'full city name (UITP)'</span>:<span class="st">'City name (UITP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'full city name (WB)'</span>:<span class="st">'City name (WB)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Reporting Year (CDP)'</span>:<span class="st">'Reporting year (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'study_year (WB)'</span>:<span class="st">'Study year (WB)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'city_type (carbonn)'</span>:<span class="st">'Definition (carbonn)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'definition  (WB)'</span>:<span class="st">'Definition (WB)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Boundary (CDP)'</span>:<span class="st">'Definition (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'City Location (CDP)'</span>:<span class="st">'City location (CDP) [degrees]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Current Population (CDP)'</span>:<span class="st">'Population (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Current Population Year (CDP)'</span>:<span class="st">'Population year (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'pop (carbonn)'</span>:<span class="st">'Population (carbonn)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'pop_yr (carbonn)'</span>:<span class="st">'Population year (carbonn)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'population (GEA)'</span>:<span class="st">'Population (GEA)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'population (UITP)'</span>:<span class="st">'Population (UITP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'population (WB)'</span>:<span class="st">'Population (WB)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'population_year (WB)'</span>:<span class="st">'Population year (WB)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'pop_1950 (WB)'</span>:<span class="st">'Population 1950 (WB)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'pop_1990 (WB)'</span>:<span class="st">'Population 1990 (WB)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'pop_2010 (WB)'</span>:<span class="st">'Population 2010 (WB)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'growth_rate_1950-2010 (WB)'</span>:<span class="st">'Population growth rate 1950-2010 (WB) [people/60years]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'growth_rate_1990-2010 (WB)'</span>:<span class="st">'Population growth rate 1990-2010 (WB) [people/20years]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'population (others)'</span>:<span class="st">'Population (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'population (others) source year'</span>:<span class="st">'Population year (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'population (others) source'</span>:<span class="st">'Population source (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'population_density (GEA)'</span>:<span class="st">'Population density (GEA) [people/km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'population_density (UITP)'</span>:<span class="st">'Population density (UITP) [people/km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'pop_density (WB)'</span>:<span class="st">'Population density (WB) [people/km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Urban Population (PKU)'</span>:<span class="st">'Urban population (PKU)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Scope-1 GHG emissions'</span>:<span class="st">'Scope-1 GHG emissions [tCO2 or tCO2-eq]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-39"><a href="#cb109-39" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'S1 lower bd [tCO2] (CDP)'</span>:<span class="st">'S1 lower bound (CDP) [tCO2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-40"><a href="#cb109-40" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'S1 upper bd [tCO2] (CDP)'</span>:<span class="st">'S1 upper bound (CDP) [tCO2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-41"><a href="#cb109-41" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'S1 mean [tCO2] (CDP)'</span>:<span class="st">'S1 mean (CDP) [tCO2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-42"><a href="#cb109-42" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'TOT lower bd [tCO2] (CDP)'</span>:<span class="st">'TOT lower bound (CDP) [tCO2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-43"><a href="#cb109-43" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'TOT upper bd [tCO2] (CDP)'</span>:<span class="st">'TOT upper bound (CDP) [tCO2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-44"><a href="#cb109-44" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'TOT mean [tCO2] (CDP)'</span>:<span class="st">'TOT mean (CDP) [tCO2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-45"><a href="#cb109-45" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Methodology Details (CDP)'</span>:<span class="st">'Methodology details (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-46"><a href="#cb109-46" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Scope 2 [metric ton CO2e] (CDP)'</span>: <span class="st">'Scope-2 (CDP) [tCO2-eq]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-47"><a href="#cb109-47" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Total Emissions [metric ton CO2e] (CDP)'</span>: <span class="st">'Total emissions (CDP) [tCO2-eq]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-48"><a href="#cb109-48" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Year of Emission'</span>:<span class="st">'Year of emission'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-49"><a href="#cb109-49" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Emissions Protocol'</span>:<span class="st">'Emissions protocol'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-50"><a href="#cb109-50" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'scope fraction (CDP)'</span>:<span class="st">'Scope fraction (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-51"><a href="#cb109-51" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'CO2 Emissions Per Capita (Ton) (PKU)'</span>:<span class="st">'CO2 emissions per capita (PKU) [tCO2/capita]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-52"><a href="#cb109-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-53"><a href="#cb109-53" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Land area (in square km) (CDP)'</span>:<span class="st">'City area (CDP) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-54"><a href="#cb109-54" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'area_size (GEA)'</span>:<span class="st">'City area (GEA) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-55"><a href="#cb109-55" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'area_size (WB)'</span>:<span class="st">'City area (WB) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-56"><a href="#cb109-56" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'area [km2] (others)'</span>:<span class="st">'City area (others) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-57"><a href="#cb109-57" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'area [km2] (others) source year'</span>:<span class="st">'City area source year (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-58"><a href="#cb109-58" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'area [km2] (others) source'</span>:<span class="st">'City area source (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-59"><a href="#cb109-59" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'pop/sqrt(area_size) (GEA)'</span>:<span class="st">'Population/sqrt(area) (GEA) [people/km]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-60"><a href="#cb109-60" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'pop/sqrt(area) (WB)'</span>:<span class="st">'Population/sqrt(area) (WB) [people/km]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-61"><a href="#cb109-61" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Built-up Area (km2) (PKU)'</span>:<span class="st">'Built-up area (PKU) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-62"><a href="#cb109-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-63"><a href="#cb109-63" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Urban Area Name (UEX)'</span>:<span class="st">'Urban area name (UEX)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-64"><a href="#cb109-64" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Low BUA - 1990 (UEX)'</span>:<span class="st">'Low BUA - 1990 (UEX) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-65"><a href="#cb109-65" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Low BUA </span><span class="ch">\xe2\x80\x93</span><span class="st"> 2000 (UEX)'</span>:<span class="st">'Low BUA - 2000 (UEX) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-66"><a href="#cb109-66" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Low BUA </span><span class="ch">\xe2\x80\x93</span><span class="st"> 2014 (UEX)'</span>:<span class="st">'Low BUA - 2014 (UEX) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-67"><a href="#cb109-67" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'High BUA - 1990 (UEX)'</span>:<span class="st">'High BUA - 1990 (UEX) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-68"><a href="#cb109-68" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'High BUA </span><span class="ch">\xe2\x80\x93</span><span class="st"> 2000 (UEX)'</span>:<span class="st">'High BUA - 2000 (UEX) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-69"><a href="#cb109-69" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'High BUA </span><span class="ch">\xe2\x80\x93</span><span class="st"> 2014 (UEX)'</span>:<span class="st">'High BUA - 2014 (UEX) [km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-70"><a href="#cb109-70" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Low BUA % - 1990 (UEX)'</span>:<span class="st">'Low BUA % - 1990 (UEX) [percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-71"><a href="#cb109-71" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Low BUA % </span><span class="ch">\xe2\x80\x93</span><span class="st"> 2000 (UEX)'</span>:<span class="st">'Low BUA % - 2000 (UEX) [percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-72"><a href="#cb109-72" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Low BUA % </span><span class="ch">\xe2\x80\x93</span><span class="st"> 2014 (UEX)'</span>:<span class="st">'Low BUA % - 2014 (UEX) [percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-73"><a href="#cb109-73" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'High BUA % - 1990 (UEX)'</span>:<span class="st">'High BUA % - 1990 (UEX) [percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-74"><a href="#cb109-74" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'High BUA % </span><span class="ch">\xe2\x80\x93</span><span class="st"> 2000 (UEX)'</span>:<span class="st">'High BUA % - 2000 (UEX) [percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-75"><a href="#cb109-75" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'High BUA % </span><span class="ch">\xe2\x80\x93</span><span class="st"> 2014 (UEX)'</span>:<span class="st">'High BUA % - 2014 (UEX) [percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-76"><a href="#cb109-76" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Low BUA pop density - 1990 (UEX)'</span>:<span class="st">'Low BUA population density - 1990 (UEX) [people/km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-77"><a href="#cb109-77" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Low BUA pop density </span><span class="ch">\xe2\x80\x93</span><span class="st"> 2000 (UEX)'</span>:<span class="st">'Low BUA population density - 2000 (UEX) [people/km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-78"><a href="#cb109-78" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Low BUA pop density </span><span class="ch">\xe2\x80\x93</span><span class="st"> 2014 (UEX)'</span>:<span class="st">'Low BUA population density - 2014 (UEX) [people/km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-79"><a href="#cb109-79" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'High BUA pop density </span><span class="ch">\xe2\x80\x93</span><span class="st"> 1990 (UEX)'</span>:<span class="st">'High BUA population density - 1990 (UEX) [people/km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-80"><a href="#cb109-80" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'High BUA pop density - 2000 (UEX)'</span>:<span class="st">'High BUA population density - 2000 (UEX) [people/km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-81"><a href="#cb109-81" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'High BUA pop density - 2014 (UEX)'</span>:<span class="st">'High BUA population density - 2014 (UEX) [people/km2]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-82"><a href="#cb109-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-83"><a href="#cb109-83" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'weather_station_id (GEA+)'</span>:<span class="st">'Weather station ID (GEA+)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-84"><a href="#cb109-84" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'HDD_15.5C (GEA+)'</span>:<span class="st">'HDD 15.5C (GEA+) [degrees C × days]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-85"><a href="#cb109-85" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'CDD_23C (GEA+)'</span>:<span class="st">'CDD 23C (GEA+) [degrees C × days]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-86"><a href="#cb109-86" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'HDD_15.5C (clim)'</span>:<span class="st">'HDD 15.5C (clim) [degrees C × days]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-87"><a href="#cb109-87" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'CDD_23C (clim)'</span>:<span class="st">'CDD 23C (clim) [degrees C × days]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-88"><a href="#cb109-88" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Average altitude (m)'</span>:<span class="st">'Average altitude [m]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-89"><a href="#cb109-89" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Average annual temperature (in Celsius) (CDP)'</span>:<span class="st">'Average annual temperature (CDP) [degrees Celsius]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-90"><a href="#cb109-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-91"><a href="#cb109-91" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'City GDP (CDP)'</span>:<span class="st">'GDP (CDP) [multiple units]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-92"><a href="#cb109-92" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'GDP Currency (CDP)'</span>:<span class="st">'GDP unit (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-93"><a href="#cb109-93" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Year of GDP (CDP)'</span>:<span class="st">'GDP year (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-94"><a href="#cb109-94" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'GDP Source (CDP)'</span>:<span class="st">'GDP source (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-95"><a href="#cb109-95" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'GDP (carbonn)'</span>:<span class="st">'GDP (carbonn) [multiple units]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-96"><a href="#cb109-96" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'GDP (10000 RMB) (PKU)'</span>:<span class="st">'GDP (PKU) [10000 RMB]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-97"><a href="#cb109-97" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Income Per Capita (RMB) (PKU)'</span>:<span class="st">'Income per capita (PKU) [RMB/capita]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-98"><a href="#cb109-98" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'GDP-PPP/cap (GEA)'</span>:<span class="st">'GDP-PPP/capita (GEA) [USD/year]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-99"><a href="#cb109-99" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'GDP-PPP/cap (UITP)'</span>:<span class="st">'GDP-PPP/capita (UITP) [USD/year]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-100"><a href="#cb109-100" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'GDP-PPP/cap (WB)'</span>:<span class="st">'GDP-PPP/capita (WB) [USD/year]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-101"><a href="#cb109-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-102"><a href="#cb109-102" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'GDP-PPP [$BN] (others)'</span>:<span class="st">'GDP-PPP (others) [$BN]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-103"><a href="#cb109-103" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'GDP-PPP/cap [$USD] (others)'</span>:<span class="st">'GDP-PPP/capita (others) [USD/capita]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-104"><a href="#cb109-104" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'GDP-PPP [$BN] (others) source'</span>:<span class="st">'GDP-PPP source (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-105"><a href="#cb109-105" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'nGDP [$BN] (others)'</span>:<span class="st">'nGDP (others) [$BN]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-106"><a href="#cb109-106" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'nGDP/cap [$USD] (others)'</span>:<span class="st">'nGDP/capita (others) [USD/capita]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-107"><a href="#cb109-107" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'nGDP [$BN] (others) source'</span>:<span class="st">'nGDP source (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-108"><a href="#cb109-108" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'nGDP [$BN] (others) source'</span>:<span class="st">'nGDP source (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-109"><a href="#cb109-109" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'nGDP [$BN] (others) source year'</span>:<span class="st">'nGDP year (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-110"><a href="#cb109-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-111"><a href="#cb109-111" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'nGDP (carbonn)'</span>:<span class="st">'nGDP (carbonn) [multiple units]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-112"><a href="#cb109-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-113"><a href="#cb109-113" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'total_final_consumption_per_capita (GEA)'</span>:<span class="st">'Total final consumption per capita (GEA) [GJ/capita/yr]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-114"><a href="#cb109-114" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'energy_per_cap_CO2 (WB)'</span>:<span class="st">'Energy per capita CO2 (WB) [tCO2-eq/capita/yr]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-115"><a href="#cb109-115" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'diesel_price (GEA+)'</span>:<span class="st">'Diesel price (GEA+) [USD/liter]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-116"><a href="#cb109-116" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'gasoline_price (GEA+)'</span>:<span class="st">'Gasoline price (GEA+) [USD/liter]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-117"><a href="#cb109-117" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'household_size (GEA+)'</span>:<span class="st">'Household size (GEA+) [people/household]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-118"><a href="#cb109-118" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'household_source (GEA+)'</span>:<span class="st">'Household source (GEA+)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-119"><a href="#cb109-119" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'year_household_size (GEA+)'</span>:<span class="st">'Household size year (GEA+)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-120"><a href="#cb109-120" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'household_source (GEA+)'</span>:<span class="st">'Household size source (GEA+)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-121"><a href="#cb109-121" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'comment_household_size (GEA+)'</span>:<span class="st">'Household size comment (GEA+)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-122"><a href="#cb109-122" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'urbanization_ratio (GEA+)'</span>:<span class="st">'Urbanization ratio (GEA+) [percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-123"><a href="#cb109-123" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'center_of_commerce_index (GEA+)'</span>:<span class="st">'Center of commerce index (GEA+) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-124"><a href="#cb109-124" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'water_bounded (GEA+)'</span>:<span class="st">'Water bounded (GEA+)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-125"><a href="#cb109-125" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'other_bounded (GEA+)'</span>:<span class="st">'Other bounded (GEA+)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-126"><a href="#cb109-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-127"><a href="#cb109-127" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'diesel_price (2014) (others)'</span>:<span class="st">'Diesel price 2014 (others) [USD/liter]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-128"><a href="#cb109-128" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'gasoline_price (2014) (others)'</span>:<span class="st">'Gasoline price 2014 (others) [USD/liter]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-129"><a href="#cb109-129" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'household_size (updated) (others)'</span>:<span class="st">'Household size (others) [people/household]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-130"><a href="#cb109-130" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'year_household_size (updated) (others)'</span>:<span class="st">'Household size year (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-131"><a href="#cb109-131" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'household_source (updated) (others)'</span>:<span class="st">'Household size source (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-132"><a href="#cb109-132" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'comment_household_size (updated) (others)'</span>:<span class="st">'Household size comment (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-133"><a href="#cb109-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-134"><a href="#cb109-134" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'mean travel time [min] (others)'</span>:<span class="st">'Mean one-way travel time (others) [minutes]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-135"><a href="#cb109-135" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'mean travel time ref year (others)'</span>:<span class="st">'Mean one-way travel time year (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-136"><a href="#cb109-136" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'mean travel time ref (others)'</span>:<span class="st">'Mean one-way travel time source (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-137"><a href="#cb109-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-138"><a href="#cb109-138" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Peak hours spent in congestion (INRIX)'</span>:<span class="st">'Peak hours spent in congestion (INRIX) [hours]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-139"><a href="#cb109-139" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Average Congestion Rate (INRIX)'</span>:<span class="st">'Average congestion rate (INRIX) [percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-140"><a href="#cb109-140" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Congestion Rank (INRIX)'</span>:<span class="st">'Congestion rank (INRIX) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-141"><a href="#cb109-141" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'INRIX Congestion Index (INRIX)'</span>:<span class="st">'INRIX congestion index (INRIX) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-142"><a href="#cb109-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-143"><a href="#cb109-143" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Congestion Level (TomTom)'</span>:<span class="st">'Congestion level (TomTom) [× 100 percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-144"><a href="#cb109-144" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Congestion Change (TomTom)'</span>:<span class="st">'Congestion change (TomTom) [× 100 percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-145"><a href="#cb109-145" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Morning Peak (TomTom)'</span>:<span class="st">'Morning peak (TomTom) [percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-146"><a href="#cb109-146" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Evening Peak (TomTom)'</span>:<span class="st">'Evening peak (TomTom) [percent]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-147"><a href="#cb109-147" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Congestion Rank (TomTom)'</span>:<span class="st">'Congestion rank (TomTom) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-148"><a href="#cb109-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-149"><a href="#cb109-149" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'economy (IESE)'</span>:<span class="st">'Economy (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-150"><a href="#cb109-150" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'environment (IESE)'</span>:<span class="st">'Environment (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-151"><a href="#cb109-151" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'governance (IESE)'</span>:<span class="st">'Governance (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-152"><a href="#cb109-152" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'human capital (IESE)'</span>:<span class="st">'Human capital (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-153"><a href="#cb109-153" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'international impact (IESE)'</span>:<span class="st">'International impact (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-154"><a href="#cb109-154" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'mobility and transportation (IESE)'</span>:<span class="st">'Mobility and transportation (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-155"><a href="#cb109-155" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'public management (IESE)'</span>:<span class="st">'Public management (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-156"><a href="#cb109-156" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'social cohesion (IESE)'</span>:<span class="st">'Social cohesion (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-157"><a href="#cb109-157" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'technology (IESE)'</span>:<span class="st">'Technology (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-158"><a href="#cb109-158" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'urban planning (IESE)'</span>:<span class="st">'Urban planning (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-159"><a href="#cb109-159" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'CIMI (IESE)'</span>:<span class="st">'CIMI (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-160"><a href="#cb109-160" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'CIMI Ranking (IESE)'</span>:<span class="st">'CIMI ranking (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-161"><a href="#cb109-161" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'CIMI Performance (IESE)'</span>:<span class="st">'CIMI performance (IESE) [dimensionless]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-162"><a href="#cb109-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-163"><a href="#cb109-163" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'lat'</span>:<span class="st">'Latitude (others) [degrees]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-164"><a href="#cb109-164" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'lon'</span>:<span class="st">'Longitude (others) [degrees]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-165"><a href="#cb109-165" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'coord source'</span>:<span class="st">'Coordinate source (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-166"><a href="#cb109-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-167"><a href="#cb109-167" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Exports (m3)'</span>:<span class="st">'Exports (others) [m3]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-168"><a href="#cb109-168" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Production (m3)'</span>:<span class="st">'Production (others) [m3]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-169"><a href="#cb109-169" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'Export/Production'</span>:<span class="st">'Natgas Export/Production ratio (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-170"><a href="#cb109-170" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'CH4_waste/person'</span>:<span class="st">'CH4_waste/capita (others) [tCH4/capita]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-171"><a href="#cb109-171" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'CH4_(waste+natgas)/person'</span>:<span class="st">'CH4_waste+natgas/capita (others) [tCH4/capita]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-172"><a href="#cb109-172" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'corrected CH4_(waste+natgas)/person'</span>:<span class="st">'Corrected CH4_(waste+natgas)/capita (others) [tCH4/capita]'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb109-173"><a href="#cb109-173" aria-hidden="true" tabindex="-1"></a>df.rename(columns <span class="op">=</span> {<span class="st">'data from CIA World Fact Book for 2014'</span>:<span class="st">'Year from CIA (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 179)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>['City name',
 'City name (CDP)',
 'City name (carbonn)',
 'City name (PKU)',
 'City name (GEA)',
 'City name (UITP)',
 'City name (WB)',
 'Definition (CDP)',
 'Definition (carbonn)',
 'Definition (WB)',
 'Study year (WB)',
 'Reporting year (CDP)',
 'Scope-1 GHG emissions [tCO2 or tCO2-eq]',
 'Scope-1 source dataset',
 'Scope-1 GHG emissions units',
 'Year of emission',
 'Emissions protocol',
 'Gases included (CDP)',
 'Methodology details (CDP)',
 'Increase/Decrease from last year (CDP)',
 'Reason for increase/decrease in emissions (CDP)',
 'Scope-2 (CDP) [tCO2-eq]',
 'Total emissions (CDP) [tCO2-eq]',
 'CDP2016 data edited (CDP)',
 'Emissions Quality Flag (CDP)',
 'S1 lower bound [tCO2] (CDP)',
 'S1 upper bound [tCO2] (CDP)',
 'S1 mean (CDP) [tCO2]',
 'TOT lower bound [tCO2] (CDP)',
 'TOT upper bound [tCO2] (CDP)',
 'TOT mean (CDP) [tCO2]',
 'Scope fraction (CDP)',
 'CO2 emissions per capita (PKU) [tCO2/capita]',
 'City location (CDP) [degrees]',
 'Latitude (others) [degrees]',
 'Longitude (others) [degrees]',
 'Coordinate source (others)',
 'Country',
 'Region',
 'Population (CDP)',
 'Population year (CDP)',
 'Population (carbonn)',
 'Population year (carbonn)',
 'Urban population (PKU)',
 'Population (GEA)',
 'Population (UITP)',
 'Population (WB)',
 'Population year (WB)',
 'Population (others)',
 'Population year (others)',
 'Population source (others)',
 'Population 1950 (WB)',
 'Population 1990 (WB)',
 'Population 2010 (WB)',
 'Population growth rate 1950-2010 (WB) [people/60years]',
 'Population growth rate 1990-2010 (WB) [people/20years]',
 'Ancillary from GEA+',
 'City area (CDP) [km2]',
 'City area (GEA) [km2]',
 'City area (WB) [km2]',
 'Built-up area (PKU) [km2]',
 'City area (others) [km2]',
 'City area source year (others)',
 'City area source (others)',
 'Population density (GEA) [people/km2]',
 'Population density (UITP) [people/km2]',
 'Population density (WB) [people/km2]',
 'Population/sqrt(area) (GEA) [people/km]',
 'Population/sqrt(area) (WB) [people/km]',
 'Average altitude [m]',
 'Average annual temperature (CDP) [degrees Celsius]',
 'Weather station ID (GEA+)',
 'CDD 23C (GEA+) [degrees C \xc3\x97 days]',
 'HDD 15.5C (GEA+) [degrees C \xc3\x97 days]',
 'HDD 15.5C (clim) [degrees C \xc3\x97 days]',
 'CDD 23C (clim) [degrees C \xc3\x97 days]',
 'GDP (CDP) [multiple units]',
 'GDP unit (CDP)',
 'GDP year (CDP)',
 'GDP source (CDP)',
 'GDP (carbonn) [multiple units]',
 'nGDP (carbonn) [multiple units]',
 'GDP unit (carbonn)',
 'GDP year (carbonn)',
 'GDP (PKU) [10000 RMB]',
 'Income per capita (PKU) [RMB/capita]',
 'GDP-PPP (others) [$BN]',
 'GDP-PPP/capita (others) [USD/capita]',
 'GDP-PPP source (others)',
 'GDP-PPP year (others)',
 'nGDP (others) [$BN]',
 'nGDP/capita (others) [USD/capita]',
 'nGDP source (others)',
 'nGDP year (others)',
 'GDP-PPP/capita (GEA) [USD/year]',
 'GDP-PPP/capita (UITP) [USD/year]',
 'GDP-PPP/capita (WB) [USD/year]',
 'Total final consumption per capita (GEA) [GJ/capita/yr]',
 'Energy per capita CO2 (WB) [tCO2-eq/capita/yr]',
 'Diesel price (GEA+) [USD/liter]',
 'Gasoline price (GEA+) [USD/liter]',
 'Center of commerce index (GEA+) [dimensionless]',
 'Household size (GEA+) [people/household]',
 'Household size year (GEA+)',
 'Household source (GEA+)',
 'Household size comment (GEA+)',
 'Urbanization ratio (GEA+) [percent]',
 'Water bounded (GEA+)',
 'Other bounded (GEA+)',
 'Mean one-way travel time (others) [minutes]',
 'Mean one-way travel time year (others)',
 'Mean one-way travel time source (others)',
 'Diesel price 2014 (others) [USD/liter]',
 'Gasoline price 2014 (others) [USD/liter]',
 'Household size (others) [people/household]',
 'Household size year (others)',
 'Household size source (others)',
 'Household size comment (others)',
 'Congestion rank (INRIX) [dimensionless]',
 'Peak hours spent in congestion (INRIX) [hours]',
 'INRIX congestion index (INRIX) [dimensionless]',
 'Average congestion rate (INRIX) [percent]',
 'Congestion rank (TomTom) [dimensionless]',
 'Congestion level (TomTom) [\xc3\x97 100 percent]',
 'Congestion change (TomTom) [\xc3\x97 100 percent]',
 'Morning peak (TomTom) [percent]',
 'Evening peak (TomTom) [percent]',
 'Economy (IESE) [dimensionless]',
 'Environment (IESE) [dimensionless]',
 'Governance (IESE) [dimensionless]',
 'Human capital (IESE) [dimensionless]',
 'International impact (IESE) [dimensionless]',
 'Mobility and transportation (IESE) [dimensionless]',
 'Public management (IESE) [dimensionless]',
 'Social cohesion (IESE) [dimensionless]',
 'Technology (IESE) [dimensionless]',
 'Urban planning (IESE) [dimensionless]',
 'CIMI (IESE) [dimensionless]',
 'CIMI ranking (IESE) [dimensionless]',
 'CIMI performance (IESE) [dimensionless]',
 'Urban area name (UEX)',
 'Low BUA - 1990 (UEX) [km2]',
 'Low BUA - 2000 (UEX) [km2]',
 'Low BUA - 2014 (UEX) [km2]',
 'High BUA - 1990 (UEX) [km2]',
 'High BUA - 2000 (UEX) [km2]',
 'High BUA - 2014 (UEX) [km2]',
 'Low BUA % - 1990 (UEX) [percent]',
 'Low BUA % - 2000 (UEX) [percent]',
 'Low BUA % - 2014 (UEX) [percent]',
 'High BUA % - 1990 (UEX) [percent]',
 'High BUA % - 2000 (UEX) [percent]',
 'High BUA % - 2014 (UEX) [percent]',
 'Low BUA population density - 1990 (UEX) [people/km2]',
 'High BUA population density - 1990 (UEX) [people/km2]',
 'Low BUA population density - 2000 (UEX) [people/km2]',
 'High BUA population density - 2000 (UEX) [people/km2]',
 'Low BUA population density - 2014 (UEX) [people/km2]',
 'High BUA population density - 2014 (UEX) [people/km2]',
 'Exports (others) [m3]',
 'Production (others) [m3]',
 'Natgas Export/Production ratio (others)',
 'CH4_waste/capita (others) [tCH4/capita]',
 'CH4_waste+natgas/capita (others) [tCH4/capita]',
 'Corrected CH4_(waste+natgas)/capita (others) [tCH4/capita]',
 'Year from CIA (others)',
 'AQF (CDP/GEA)',
 'AQF (CDP/WB)',
 'AQF (CDP/OTHERS)',
 'AQF (PKU/GEA)',
 'AQF (PKU/WB)',
 'AQF (PKU/OTHERS)',
 'PQF (CDP)',
 'PQF (carbonn)',
 'PQF (WB)',
 'PQF (WB2010)',
 'PQF (OTHERS)',
 'HQF (GEA+)',
 'HQF (OTHERS)']</code></pre>
</div>
</div>
</section>
<section id="save" class="level1">
<h1>save</h1>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 179)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'DATA/D_FINAL.tsv'</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>df.to_csv(fname, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span> , encoding<span class="op">=</span><span class="st">'utf-8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>