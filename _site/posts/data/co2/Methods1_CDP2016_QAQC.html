<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Rebecca Barter – methods1_cdp2016_qaqc</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Rebecca Barter</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
 <span class="menu-text">About Rebecca</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rlbarter"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/rlbarter"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">



<section id="step-1.-scope-1-ghg-emissions-from-cdp" class="level1">
<h1>Step 1. Scope-1 GHG emissions from CDP</h1>
<p>The 2016 edition of the CDP emissions dataset (D<sup>CDP2016</sup>) provides annual mean GHG emissions in CO2 equivalents from 187 cities. Reported emissions categories include Scope 1 being the direct territorial emissions from residential and industrial heating, transport, industrial sectors, Scope 2 being emissions from purchased energy generated upstream from the city, mainly electricity, and Total Emissions, nominally equal to the sum of Scope 1 and Scope 2.</p>
<p>Here, emission data in D<sup>CDP2016</sup> are checked for inconsistencies and replaced by a more recent version of the CDP data called D<sup>CDP2017</sup>. Based on this quality control procedure, quality flags are assigned to the GHG Scope-1 emissions of each city.</p>
<p><strong>Emissions Quality Flags (EQFs)</strong></p>
<p><strong>A</strong> = TOT = S1 + S2 (within 15% tolerance) or TOT can be derived by summing scopes<br>
<strong>B</strong> = S3 included in total, but TOT = S1 + S2. Both cannot be true.<br>
<strong>C</strong> = S1 exists, S2 missing (3 cities), or in S2 exists, S1 missing (later derived) (6 cities)<br>
<strong>D</strong> = both scopes are missing <strong>E</strong> = S1 exists, S2 missing, and TOT = S1 + S2 = S1. S1 likely correct therefore TOT is incomplete.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> collections</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_colwidth'</span>, <span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pd.__version__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>u'0.22.0'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>np.version.version</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>'1.14.0'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>matplotlib.__version__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>'2.1.2'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>csv.__version__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>'1.0'</code></pre>
</div>
</div>
</section>
<section id="variables" class="level1">
<h1>Variables</h1>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>var_account <span class="op">=</span> <span class="st">'Account Number'</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>var_city2016 <span class="op">=</span> <span class="st">'City Short Name (CDP2016)'</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>var_city2017 <span class="op">=</span> <span class="st">'City (CDP2017)'</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>var_country <span class="op">=</span> <span class="st">'Country (CDP2016)'</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>var_pop2016 <span class="op">=</span> <span class="st">'Current Population (CDP2016)'</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>var_popyr2016 <span class="op">=</span> <span class="st">'Current Population Year (CDP2016)'</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>var_pop2017 <span class="op">=</span> <span class="st">'Population (CDP2017)'</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>var_popyr2017 <span class="op">=</span> <span class="st">'Population year (CDP2017)'</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>var_bd2016 <span class="op">=</span> <span class="st">'Boundary (CDP2016)'</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>var_bd2017 <span class="op">=</span> <span class="st">'Boundary (CDP2017)'</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>var_yr2016 <span class="op">=</span> <span class="st">'Measurement year only (CDP2016)'</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>var_yr2017 <span class="op">=</span> <span class="st">'Measurement year only (CDP2017)'</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>var_protocol2016 <span class="op">=</span> <span class="st">'Primary Methodology (CDP2016)'</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>var_protocol2017 <span class="op">=</span> <span class="st">'Protocol (CDP2017)'</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Emissions</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>var_tot2016 <span class="op">=</span> <span class="st">'Total City-wide Emissions (metric tonnes CO2e) (CDP2016)'</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>var_s1_2016 <span class="op">=</span> <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)'</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>var_s2_2016 <span class="op">=</span> <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)'</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>var_tot2017 <span class="op">=</span> <span class="st">'Total emissions (metric tonnes CO2e) (CDP2017)'</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>var_s1_2017 <span class="op">=</span> <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)'</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>var_s2_2017 <span class="op">=</span> <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)'</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>var_sf2016 <span class="op">=</span> <span class="st">'scope fraction (CDP2016)'</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>var_sf2017 <span class="op">=</span> <span class="st">'scope fraction (CDP2017)'</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>var_gases2016 <span class="op">=</span> <span class="st">'Gases included (CDP2016)'</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>var_gases2017 <span class="op">=</span> <span class="st">'Gases included (CDP2017)'</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>var_incScopes <span class="op">=</span> <span class="st">'Scopes Included (CDP2017)'</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>str_scopesAll <span class="op">=</span> <span class="st">'Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)'</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>str_scopesTwo <span class="op">=</span> <span class="st">'Total Scope 1 and Scope 2'</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>var_forgiveness <span class="op">=</span> <span class="fl">0.15</span>  <span class="co">#tolerance given for sum check</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>var_eqf <span class="op">=</span> <span class="st">'Emissions Quality Flag'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="functions" class="level1">
<h1>Functions</h1>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tag_column_names_with_datasetname(df, tagname):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Add to column name dataset from which column was obtained"""</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    col_names <span class="op">=</span> <span class="bu">list</span>(df)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cname <span class="kw">in</span> col_names:</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cname <span class="op">!=</span> <span class="st">'Account Number'</span>:</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>            df.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' ('</span> <span class="op">+</span> tagname <span class="op">+</span> <span class="st">')'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="case-checks" class="level2">
<h2 class="anchored" data-anchor-id="case-checks">Case checks</h2>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 1: TOT = s1 OR s2</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a) both scopes exist</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_case1a(df, var_s1, var_s2, var_tot):</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Check if tot = s1 OR s2, where BOTH scopes exist.</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Ignore cities that have already been checked.</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Action: Assume total is incorrect. Recalculate total by summing the scopes."""</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    case1a <span class="op">=</span> (</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        (<span class="op">~</span>df[var_s1].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df[var_s2].isnull()) </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df[var_tot] <span class="op">==</span> df[var_s1]) <span class="op">|</span> (df[var_tot] <span class="op">==</span> df[var_s2])</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df[<span class="st">'CDP2016 data edited'</span>].isnull()) </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    )     </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> case1a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 1: TOT = s1 OR s2</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a) s1 OR s2 exists</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_case1b(df, var_s1, var_s2, var_tot):</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Check if tot = s1 OR s2, where EITHER scope1 or scope2 exists. </span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Ignore cities that have already been checked.</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Action: Check CDP2017, if that doesn't resolve it, nothing can be done."""</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    case1b <span class="op">=</span> (</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        (df[var_tot] <span class="op">==</span> df[var_s1]) <span class="op">|</span> (df[var_tot] <span class="op">==</span> df[var_s2]) </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> ( (<span class="op">~</span>df[var_s1].isnull()) <span class="op">|</span> (<span class="op">~</span>df[var_s2].isnull())  )</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df[<span class="st">'CDP2016 data edited'</span>].isnull())  </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> case1b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 2: TOT = s1 + s2</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tolerable (WITHIN FORGIVENESS RANGE): 1 - var_forgiveness &lt; scope fraction &lt; 1 + var_forgiveness</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_case2_tolerable(df, var_s1, var_s2, var_tot, var_sf):</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Check if tot &lt; (s1+s2) within the forgiveness factor.</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Ignore cities that have already been checked.</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Action for CDP2016: See if CDP2017 has useable values when scope fraction is near the extremes. </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">    If not, leave as is."""</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    case2_tolerable <span class="op">=</span> (   </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        (df[var_tot] <span class="op">!=</span> df[[var_s1, var_s2]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) ) </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df[<span class="st">'CDP2016 data edited'</span>].isnull() )</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> ( (<span class="dv">1</span> <span class="op">-</span> var_forgiveness) <span class="op">&lt;</span> df[var_sf] ) <span class="op">&amp;</span> ( df[var_sf] <span class="op">&lt;</span> (<span class="dv">1</span> <span class="op">+</span> var_forgiveness)  )</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> case2_tolerable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 3: TOT != s1 + s2</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a) Intolerable (OUTSIDE FORGIVENESS RANGE): </span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># scope fraction &lt; 1 - var_forgiveness OR scope fraction &gt; 1 + var_forgiveness</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_case3a_intolerable(df, var_s1, var_s2, var_tot, var_sf):</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Check if tot &lt;&lt; (s1+s2) by more than forgiveness factor.</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Ignore cities that have already been checked.</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Action for CDP2016: See if CDP2017 has useable values. If not, flag for CDP to check."""</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    case3a_intolerable <span class="op">=</span> (   </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        (df[var_tot] <span class="op">!=</span> df[[var_s1, var_s2]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) ) </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df[<span class="st">'CDP2016 data edited'</span>].isnull() )</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> ( df[var_sf] <span class="op">&lt;</span> (<span class="dv">1</span> <span class="op">-</span> var_forgiveness) ) <span class="op">|</span> ( df[var_sf] <span class="op">&gt;</span> (<span class="dv">1</span> <span class="op">+</span> var_forgiveness)  )</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> case3a_intolerable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 3</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># b) Intolerable: TOT &lt; s1 OR s2 (NO FORGIVENESS) </span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_case3b_intolerable(df, var_s, var_tot):</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Check if tot &lt; s_i, no forgiveness</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Ignore cities that have already been checked.</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Action for CDP2016: Flag for CDP to check."""</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    case3b_intolerable <span class="op">=</span> (   </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        (df[var_tot] <span class="op">&lt;</span> df[var_s] )</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df[<span class="st">'CDP2016 data edited'</span>].isnull() )  </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> case3b_intolerable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 4: </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a) One scope missing, the other exists</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_case4a_fixable(df, var_s_missing, var_s_exists):</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Check if s1 missing, s2 exists.</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Ignore cities that have already been checked.</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Action: Calculate s1 by s1 = TOT - s2."""</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    case4a_fixable <span class="op">=</span> (</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>        (df[var_s_missing].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df[var_s_exists].isnull()) </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df[<span class="st">'CDP2016 data edited'</span>].isnull()) </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    )     </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> case4a_fixable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 4</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># b) both s1 and s2 are missing</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_case4b(df, var_s1, var_s2):</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Check if both scopes are missing.</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Ignore cities that have already been checked.</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Action: See if CDP2017 has useable values. If that doesn't resolve it, nothing can be done."""</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    case4b <span class="op">=</span> (</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        (df[var_s1].isnull()) <span class="op">&amp;</span> (df[var_s2].isnull()) </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df[<span class="st">'CDP2016 data edited'</span>].isnull()) </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    )     </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> case4b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="for-replacing-cdp2016-data-by-cdp2017" class="level3">
<h3 class="anchored" data-anchor-id="for-replacing-cdp2016-data-by-cdp2017">For replacing CDP2016 data by CDP2017</h3>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>list2016 <span class="op">=</span> [<span class="st">'Reporting Year (CDP2016)'</span>, <span class="st">'Measurement Year (CDP2016)'</span>, <span class="st">'Measurement year only (CDP2016)'</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Boundary (CDP2016)'</span>, <span class="st">'Primary Methodology (CDP2016)'</span>, <span class="st">'Methodology Details (CDP2016)'</span>, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Gases included (CDP2016)'</span>, <span class="st">'Total City-wide Emissions (metric tonnes CO2e) (CDP2016)'</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)'</span>, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)'</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Increase/Decrease from last year (CDP2016)'</span>, </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Reason for increase/decrease in emissions (CDP2016)'</span>, </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Current Population (CDP2016)'</span>, <span class="st">'Current Population Year (CDP2016)'</span>, <span class="st">'scope fraction (CDP2016)'</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>           ]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>list2017 <span class="op">=</span> [<span class="st">'Reporting year (CDP2017)'</span>, <span class="st">'Accounting year (CDP2017)'</span>, <span class="st">'Measurement year only (CDP2017)'</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Boundary (CDP2017)'</span>, <span class="st">'Protocol (CDP2017)'</span>, <span class="st">'Comment (CDP2017)'</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Gases included (CDP2017)'</span>, <span class="st">'Total emissions (metric tonnes CO2e) (CDP2017)'</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)'</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)'</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Increase/Decrease from last year (CDP2017)'</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Reason for increase/decrease in emissions (CDP2017)'</span>,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Population (CDP2017)'</span>, <span class="st">'Population year (CDP2017)'</span>, <span class="st">'scope fraction (CDP2017)'</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>           ]</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_replace2016(df, condition, replaceReason, list2016, list2017):</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Replaces values in list2016 columns with values from list2017 columns"""</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    idx<span class="op">=</span><span class="dv">0</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> colname <span class="kw">in</span> list2016:</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>        df.loc[condition, colname] <span class="op">=</span> df[list2017[idx]]</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>        idx <span class="op">=</span> idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    df.loc[condition, <span class="st">'CDP2016 data edited'</span>] <span class="op">=</span> <span class="st">'Replaced by CDP2017 data. Reason: '</span> <span class="op">+</span> replaceReason</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="read-data" class="level1">
<h1>Read data</h1>
<section id="updated-cdp2016-containing-scopes" class="level2">
<h2 class="anchored" data-anchor-id="updated-cdp2016-containing-scopes">Updated CDP2016 (containing scopes)</h2>
<p>https://data.cdp.net/Cities/2016-Citywide-GHG-Emissions/dfed-thx7/data</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'DATA/ORIGINAL_EMISSIONS_SOURCEFILES/2016_-_Citywide_GHG_Emissions_updatedDec2017_formatted.csv'</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df_scopes <span class="op">=</span> pd.read_csv(fname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df_scopes.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Account Number</th>
      <th>City Name</th>
      <th>Country</th>
      <th>City Short Name</th>
      <th>C40</th>
      <th>Reporting Year</th>
      <th>Measurement Year</th>
      <th>Boundary</th>
      <th>Primary Methodology</th>
      <th>Methodology Details</th>
      <th>...</th>
      <th>Current Population</th>
      <th>City GDP</th>
      <th>GDP Currency</th>
      <th>Year of GDP</th>
      <th>GDP Source</th>
      <th>Average annual temperature (in Celsius)​</th>
      <th>​Land area (in square km)</th>
      <th>Average altitude (m)</th>
      <th>City Location</th>
      <th>Country Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>54650</td>
      <td>Prefeitura de Palmas</td>
      <td>Brazil</td>
      <td>Palmas</td>
      <td>NaN</td>
      <td>2016</td>
      <td>12/31/2013 12:00:00 AM</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>O diagnóstico qualitativo das informações complementa a avaliação quantitativa.</td>
      <td>...</td>
      <td>272726.0</td>
      <td>899887.0</td>
      <td>BRL     Brazilian Real</td>
      <td>2016.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>(-10.249091, -48.324286)</td>
      <td>(-14.235004, -51.92528)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>59996</td>
      <td>Batangas City</td>
      <td>Philippines</td>
      <td>Batangas</td>
      <td>NaN</td>
      <td>2016</td>
      <td>12/20/2010 12:00:00 AM</td>
      <td>A metropolitan area</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>332458.0</td>
      <td>NaN</td>
      <td>PHP     Philippine Peso</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>285.0</td>
      <td>10.0</td>
      <td>(13.756465, 121.058308)</td>
      <td>(12.879721, 121.774017)</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 27 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_scopes.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>(187, 27)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df_scopes.loc[df_scopes[<span class="st">'City Short Name'</span>] <span class="op">==</span> <span class="st">'Rotterdam'</span>, [<span class="st">'City Short Name'</span>, <span class="st">'Total City-wide Emissions (metric tonnes CO2e)'</span>, <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e)'</span>, <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e)'</span>, <span class="st">'Gases included'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name</th>
      <th>Total City-wide Emissions (metric tonnes CO2e)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e)</th>
      <th>Gases included</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>Rotterdam</td>
      <td>31512000.0</td>
      <td>30011000.0</td>
      <td>1501000.0</td>
      <td>CO2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="manually-adjust-aspen-and-pitkin-county-values" class="level3">
<h3 class="anchored" data-anchor-id="manually-adjust-aspen-and-pitkin-county-values">Manually adjust Aspen and Pitkin County values</h3>
<p>The emission values to use are:</p>
<p>TOT = 394,341 tCO2 and erase S1 and S2 values.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df_scopes.loc[df_scopes[<span class="st">'City Short Name'</span>] <span class="op">==</span> <span class="st">'Aspen and Pitkin County'</span>, [<span class="st">'City Short Name'</span>, <span class="st">'Total City-wide Emissions (metric tonnes CO2e)'</span>, <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e)'</span>, <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e)'</span>, <span class="st">'Gases included'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name</th>
      <th>Total City-wide Emissions (metric tonnes CO2e)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e)</th>
      <th>Gases included</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>132</th>
      <td>Aspen and Pitkin County</td>
      <td>394341.0</td>
      <td>341208.0</td>
      <td>136413.0</td>
      <td>CO2; CH4; N2O</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df_scopes.loc[df_scopes[<span class="st">'City Short Name'</span>] <span class="op">==</span> <span class="st">'Aspen and Pitkin County'</span>, <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e)'</span>] <span class="op">=</span> np.nan</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df_scopes.loc[df_scopes[<span class="st">'City Short Name'</span>] <span class="op">==</span> <span class="st">'Aspen and Pitkin County'</span>, <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e)'</span>] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check:</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df_scopes.loc[df_scopes[<span class="st">'City Short Name'</span>] <span class="op">==</span> <span class="st">'Aspen and Pitkin County'</span>, [<span class="st">'City Short Name'</span>, <span class="st">'Total City-wide Emissions (metric tonnes CO2e)'</span>, <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e)'</span>, <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e)'</span>, <span class="st">'Gases included'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name</th>
      <th>Total City-wide Emissions (metric tonnes CO2e)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e)</th>
      <th>Gases included</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>132</th>
      <td>Aspen and Pitkin County</td>
      <td>394341.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CO2; CH4; N2O</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df_scopes.rename(columns <span class="op">=</span> {<span class="st">'Average annual temperature (in Celsius)</span><span class="ch">\xe2\x80\x8b</span><span class="st">'</span>:<span class="st">'Average annual temperature (in Celsius)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df_scopes.rename(columns <span class="op">=</span> {<span class="st">'</span><span class="ch">\xe2\x80\x8b</span><span class="st">Land area (in square km)'</span>:<span class="st">'Land area (in square km)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-formatted-measurement-year-column-to-df_scopes" class="level3">
<h3 class="anchored" data-anchor-id="add-formatted-measurement-year-column-to-df_scopes">Add formatted Measurement year column to df_scopes</h3>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First change to datetime format</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>df_scopes[<span class="st">'Measurement Year'</span>] <span class="op">=</span> pd.to_datetime(df_scopes[<span class="st">'Measurement Year'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create new column, extracting only year from 'Measurement year' column</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df_scopes[<span class="st">'Measurement year only'</span>] <span class="op">=</span> df_scopes[<span class="st">'Measurement Year'</span>].dt.year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tag_column_names_with_datasetname(df_scopes, <span class="st">'CDP2016'</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_scopes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>['Account Number',
 'City Name (CDP2016)',
 'Country (CDP2016)',
 'City Short Name (CDP2016)',
 'C40 (CDP2016)',
 'Reporting Year (CDP2016)',
 'Measurement Year (CDP2016)',
 'Boundary (CDP2016)',
 'Primary Methodology (CDP2016)',
 'Methodology Details (CDP2016)',
 'Gases included (CDP2016)',
 'Total City-wide Emissions (metric tonnes CO2e) (CDP2016)',
 'Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)',
 'Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)',
 'Increase/Decrease from last year (CDP2016)',
 'Reason for increase/decrease in emissions (CDP2016)',
 'Current Population Year (CDP2016)',
 'Current Population (CDP2016)',
 'City GDP (CDP2016)',
 'GDP Currency (CDP2016)',
 'Year of GDP (CDP2016)',
 'GDP Source (CDP2016)',
 'Average annual temperature (in Celsius) (CDP2016)',
 'Land area (in square km) (CDP2016)',
 'Average altitude (m) (CDP2016)',
 'City Location (CDP2016)',
 'Country Location (CDP2016)',
 'Measurement year only (CDP2016)']</code></pre>
</div>
</div>
</section>
</section>
<section id="cdp-2017" class="level2">
<h2 class="anchored" data-anchor-id="cdp-2017">CDP 2017</h2>
<p>https://data.cdp.net/Cities/2017-Cities-Community-Wide-Emissions/kyi6-dk5h/data</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'DATA/ORIGINAL_EMISSIONS_SOURCEFILES/2017_-_Cities_Community_Wide_Emissions_updatedDec2017_formatted.csv'</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>df_2017 <span class="op">=</span> pd.read_csv(fname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df_2017.rename(columns <span class="op">=</span> {<span class="st">'Account number'</span>:<span class="st">'Account Number'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#white space</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>df_2017.rename(columns <span class="op">=</span> {<span class="st">'Scopes Included '</span>:<span class="st">'Scopes Included'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract measurement year only</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df_2017[<span class="st">'Accounting year'</span>] <span class="op">=</span> pd.to_datetime(df_2017[<span class="st">'Accounting year'</span>])</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>df_2017[<span class="st">'Measurement year only'</span>] <span class="op">=</span> df_2017[<span class="st">'Accounting year'</span>].dt.year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="manually-adjust-rotterdam-cdp2017-values" class="level3">
<h3 class="anchored" data-anchor-id="manually-adjust-rotterdam-cdp2017-values">Manually adjust Rotterdam CDP2017 values</h3>
<p>Scope 1 emissions excluding emissions from grid-supplied energy generation are 17,840,039 metric tonnes CO2e.<br>
Remove Scope 2 value since they do not include eneregy generation.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df_2017.loc[df_2017[<span class="st">'City'</span>] <span class="op">==</span> <span class="st">'Rotterdam'</span>, [<span class="st">'City'</span>, <span class="st">'Total emissions (metric tonnes CO2e)'</span>, <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e)'</span>, <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e)'</span>, <span class="st">'Gases included'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City</th>
      <th>Total emissions (metric tonnes CO2e)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e)</th>
      <th>Gases included</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>220</th>
      <td>Rotterdam</td>
      <td>34190633.0</td>
      <td>32619756.0</td>
      <td>1570877.0</td>
      <td>CO2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df_2017.loc[df_2017[<span class="st">'City'</span>] <span class="op">==</span> <span class="st">'Rotterdam'</span>, <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e)'</span>] <span class="op">=</span> <span class="dv">17840039</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df_2017.loc[df_2017[<span class="st">'City'</span>] <span class="op">==</span> <span class="st">'Rotterdam'</span>, <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e)'</span>] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check:</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>df_2017.loc[df_2017[<span class="st">'City'</span>] <span class="op">==</span> <span class="st">'Rotterdam'</span>, [<span class="st">'City'</span>, <span class="st">'Total emissions (metric tonnes CO2e)'</span>, <span class="st">'Total Scope 1 Emissions (metric tonnes CO2e)'</span>, <span class="st">'Total Scope 2 Emissions (metric tonnes CO2e)'</span>, var_eqf,<span class="st">'Gases included'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/homel/cnangini/anaconda2/lib/python2.7/site-packages/ipykernel_launcher.py:2: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  
/homel/cnangini/anaconda2/lib/python2.7/site-packages/pandas/core/indexing.py:1367: FutureWarning: 
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
http://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike
  return self._getitem_tuple(key)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="35">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City</th>
      <th>Total emissions (metric tonnes CO2e)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e)</th>
      <th>Emissions Quality Flag</th>
      <th>Gases included</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>220</th>
      <td>Rotterdam</td>
      <td>34190633.0</td>
      <td>17840039.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CO2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>tag_column_names_with_datasetname(df_2017, <span class="st">'CDP2017'</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_2017.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(229, 24)</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="combine-cdp2016-data-with-cdp2017" class="level1">
<h1>Combine CDP2016 data with CDP2017</h1>
<p>=&gt; There are 153 cities in common between 2016 and 2017</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First merge 2016 and 2017 on same city, then filter for common cities and for same measurement year</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_scopes.shape</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_2017.shape</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>df_merge <span class="op">=</span> pd.merge(df_scopes, df_2017, on<span class="op">=</span><span class="st">'Account Number'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(187, 28)
(229, 24)
(263, 51)</code></pre>
</div>
</div>
</section>
<section id="extract-cdp2016-cities-only-from-the-merge" class="level1">
<h1>Extract CDP2016 cities only from the merge</h1>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract from merge CDP cities only</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df_venn <span class="op">=</span> df_merge[df_merge[<span class="st">'Account Number'</span>].isin(df_scopes[<span class="st">'Account Number'</span>])]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>df_venn.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>(187, 51)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of CDP2016 cities in CDP2017 =&gt; 153</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'Number of CDP2017 cities in CDP2017: '</span> <span class="op">+</span> <span class="bu">repr</span>(df_venn.loc[<span class="op">~</span>df_venn[var_tot2017].isnull(), var_city2016].count())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of CDP2017 cities in CDP2017: 153</code></pre>
</div>
</div>
</section>
<section id="qaqc-on-cdp2016-data" class="level1">
<h1>QA/QC on CDP2016 data</h1>
<p>Look if cities with large scope discord in 2016 can be replaced by 2017 data where large discord is defined as Scope1 + Scope2 != total by &gt; 15%</p>
<p>NB!!! In CDP2017, Tot Emissions is not necessarily just scope1 + scope2. There could be more, e.g.:</p>
<p>df_venn[‘Scopes Included (CDP2017)’][5] = ‘Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)’</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[ (<span class="op">~</span>df_venn[var_s1_2016].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_s2_2016].isnull()), [<span class="st">'City Short Name (CDP2016)'</span>, var_s1_2016, var_s2_2016] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Palmas</td>
      <td>589055.31</td>
      <td>36336.28</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Batangas</td>
      <td>344419.00</td>
      <td>107239.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Okayama</td>
      <td>114000.00</td>
      <td>6802000.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Alton, IL</td>
      <td>138542.00</td>
      <td>262537.00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Eugene</td>
      <td>1106250.00</td>
      <td>137500.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Cape Town</td>
      <td>9783734.00</td>
      <td>12860112.00</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Bogotá</td>
      <td>10679585.14</td>
      <td>1094791.71</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Durban</td>
      <td>11681810.00</td>
      <td>10905271.00</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Portland, OR</td>
      <td>4610317.00</td>
      <td>2364227.00</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Paris</td>
      <td>3359242.00</td>
      <td>1836421.00</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Buenos Aires</td>
      <td>15561157.00</td>
      <td>4105971.00</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Adelaide</td>
      <td>63724.00</td>
      <td>422817.00</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Canberra</td>
      <td>1757500.00</td>
      <td>2246400.00</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Melbourne</td>
      <td>785326.00</td>
      <td>3587094.00</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Athens</td>
      <td>1260355.00</td>
      <td>3451221.00</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Sydney</td>
      <td>359064.00</td>
      <td>3197465.00</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Belo Horizonte</td>
      <td>2804787.00</td>
      <td>436925.00</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Curitiba</td>
      <td>2686488.00</td>
      <td>349791.00</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Florianópolis</td>
      <td>1305206.00</td>
      <td>145259.00</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Región Metropolitana de Santiago</td>
      <td>23120027.80</td>
      <td>8306669.00</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Udine</td>
      <td>438005.00</td>
      <td>175583.00</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Windsor</td>
      <td>2475703.00</td>
      <td>6709.00</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Rio de Janeiro</td>
      <td>16171534.00</td>
      <td>4096511.00</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Salvador</td>
      <td>3242166.00</td>
      <td>366395.00</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Calgary</td>
      <td>10448332.00</td>
      <td>7758900.00</td>
    </tr>
    <tr>
      <th>41</th>
      <td>City of Winnipeg</td>
      <td>5167453.00</td>
      <td>89872.00</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Hjørring</td>
      <td>289000.00</td>
      <td>128000.00</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Toronto</td>
      <td>16151019.00</td>
      <td>2169947.00</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Edmonton</td>
      <td>10215142.00</td>
      <td>6361560.00</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Hamilton</td>
      <td>6304593.00</td>
      <td>10164690.00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>143</th>
      <td>Yonkers</td>
      <td>982940.00</td>
      <td>265710.00</td>
    </tr>
    <tr>
      <th>144</th>
      <td>Denver</td>
      <td>4557000.00</td>
      <td>4385000.00</td>
    </tr>
    <tr>
      <th>145</th>
      <td>Atlanta</td>
      <td>3548215.00</td>
      <td>5476020.00</td>
    </tr>
    <tr>
      <th>151</th>
      <td>Boston</td>
      <td>3603270.00</td>
      <td>2462912.00</td>
    </tr>
    <tr>
      <th>152</th>
      <td>Boulder</td>
      <td>741287.00</td>
      <td>980709.00</td>
    </tr>
    <tr>
      <th>153</th>
      <td>Knoxville</td>
      <td>2061435.00</td>
      <td>1938439.00</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Cleveland</td>
      <td>7750563.00</td>
      <td>4139032.00</td>
    </tr>
    <tr>
      <th>156</th>
      <td>District of Columbia</td>
      <td>3132786.00</td>
      <td>4253621.00</td>
    </tr>
    <tr>
      <th>157</th>
      <td>Lakewood</td>
      <td>553900.00</td>
      <td>1173960.00</td>
    </tr>
    <tr>
      <th>158</th>
      <td>Lancaster, PA</td>
      <td>37918.00</td>
      <td>214442.00</td>
    </tr>
    <tr>
      <th>159</th>
      <td>Las Vegas</td>
      <td>11002925.00</td>
      <td>18654205.00</td>
    </tr>
    <tr>
      <th>160</th>
      <td>Los Altos Hills</td>
      <td>47552.00</td>
      <td>9691.00</td>
    </tr>
    <tr>
      <th>162</th>
      <td>University City, MO</td>
      <td>266265.00</td>
      <td>234882.00</td>
    </tr>
    <tr>
      <th>163</th>
      <td>Minneapolis</td>
      <td>2890572.00</td>
      <td>1904136.00</td>
    </tr>
    <tr>
      <th>166</th>
      <td>New York City</td>
      <td>20995619.00</td>
      <td>16888770.00</td>
    </tr>
    <tr>
      <th>167</th>
      <td>Oakland</td>
      <td>578560.00</td>
      <td>368019.00</td>
    </tr>
    <tr>
      <th>169</th>
      <td>Philadelphia</td>
      <td>12397594.06</td>
      <td>6815276.00</td>
    </tr>
    <tr>
      <th>170</th>
      <td>Piedmont, CA</td>
      <td>17876.00</td>
      <td>25566.00</td>
    </tr>
    <tr>
      <th>172</th>
      <td>St Louis</td>
      <td>2481945.42</td>
      <td>6153317.90</td>
    </tr>
    <tr>
      <th>173</th>
      <td>Pittsburgh</td>
      <td>2073556.00</td>
      <td>2729490.00</td>
    </tr>
    <tr>
      <th>175</th>
      <td>Richmond, VA</td>
      <td>1470127.00</td>
      <td>1682371.00</td>
    </tr>
    <tr>
      <th>176</th>
      <td>San Francisco</td>
      <td>4186111.00</td>
      <td>1131352.00</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Santa Monica</td>
      <td>302510.00</td>
      <td>241253.00</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Savannah</td>
      <td>1203108.00</td>
      <td>1228219.00</td>
    </tr>
    <tr>
      <th>180</th>
      <td>Somerville, MA</td>
      <td>461798.00</td>
      <td>124510.00</td>
    </tr>
    <tr>
      <th>181</th>
      <td>Tucson</td>
      <td>2571089.00</td>
      <td>4088012.00</td>
    </tr>
    <tr>
      <th>182</th>
      <td>Alcaldía Metropolitana de Caracas</td>
      <td>14364103.00</td>
      <td>3410672.00</td>
    </tr>
    <tr>
      <th>184</th>
      <td>La Paz</td>
      <td>1152922.40</td>
      <td>273611.40</td>
    </tr>
    <tr>
      <th>185</th>
      <td>Sorocaba</td>
      <td>980290.00</td>
      <td>133680.50</td>
    </tr>
    <tr>
      <th>186</th>
      <td>Zaragoza</td>
      <td>1175162.74</td>
      <td>613341.01</td>
    </tr>
  </tbody>
</table>
<p>126 rows × 3 columns</p>
</div>
</div>
</div>
<section id="define-the-scope-fraction" class="level2">
<h2 class="anchored" data-anchor-id="define-the-scope-fraction">Define the Scope Fraction</h2>
<p>scope fraction = (Scope_1 + Scope_2)/total</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scope fraction for CDP2016 </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[ (<span class="op">~</span>df_venn[var_s1_2016].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_s2_2016].isnull()), <span class="st">'scope fraction (CDP2016)'</span>] <span class="op">=</span> (df_venn[var_s1_2016] <span class="op">+</span> df_venn[var_s2_2016])<span class="op">/</span>df_venn[var_tot2016]  <span class="co">#.round(2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/homel/cnangini/anaconda2/lib/python2.7/site-packages/pandas/core/indexing.py:357: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.obj[key] = _infer_fill_value(value)
/homel/cnangini/anaconda2/lib/python2.7/site-packages/pandas/core/indexing.py:537: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self.obj[item] = s</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scope fraction for CDP2017</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[ (<span class="op">~</span>df_venn[var_s1_2017].isnull()) <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_s2_2017].isnull()), <span class="st">'scope fraction (CDP2017)'</span>] <span class="op">=</span> ((df_venn[var_s1_2017] <span class="op">+</span> df_venn[var_s2_2017])<span class="op">/</span>df_venn[var_tot2017]).<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(187, 53)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df_venn <span class="op">=</span> df_venn.sort_values(<span class="st">'scope fraction (CDP2016)'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df_venn[[var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017, var_sf2016, var_sf2017, var_incScopes]].head(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>124</th>
      <td>Pingtung</td>
      <td>4604805.0</td>
      <td>3.704683e+10</td>
      <td>1.435430e+10</td>
      <td>4969246.69</td>
      <td>2768427.4</td>
      <td>2200856.14</td>
      <td>11162.499957</td>
      <td>1.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Lima</td>
      <td>15432105.0</td>
      <td>1.237873e+07</td>
      <td>1.543210e+07</td>
      <td>2868080.00</td>
      <td>12688756.0</td>
      <td>3919620.00</td>
      <td>1.802142</td>
      <td>5.79</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Lahti</td>
      <td>685460.0</td>
      <td>9.221200e+05</td>
      <td>1.236800e+05</td>
      <td>717200.00</td>
      <td>717200.0</td>
      <td>157607.00</td>
      <td>1.525691</td>
      <td>1.22</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
    <tr>
      <th>105</th>
      <td>Cascais</td>
      <td>565382.0</td>
      <td>5.653820e+05</td>
      <td>2.662210e+05</td>
      <td>565382.00</td>
      <td>565382.0</td>
      <td>266221.00</td>
      <td>1.470869</td>
      <td>1.47</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Región Metropolitana de Santiago</td>
      <td>23120027.8</td>
      <td>2.312003e+07</td>
      <td>8.306669e+06</td>
      <td>28406420.00</td>
      <td>18030830.0</td>
      <td>10375589.00</td>
      <td>1.359285</td>
      <td>1.00</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Ljubljana</td>
      <td>2079758.0</td>
      <td>1.829808e+06</td>
      <td>9.040420e+05</td>
      <td>2733850.00</td>
      <td>1829808.0</td>
      <td>904042.00</td>
      <td>1.314504</td>
      <td>1.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="case-1.-cdp2016-tot-scope1-or-scope2" class="level2">
<h2 class="anchored" data-anchor-id="case-1.-cdp2016-tot-scope1-or-scope2">Case 1. CDP2016 TOT == scope1 OR scope2</h2>
<section id="case-1a.-both-scopes-exist" class="level3">
<h3 class="anchored" data-anchor-id="case-1a.-both-scopes-exist">Case 1a. both scopes exist</h3>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Initialize column to keep track of edits made to CDP2016 data</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>df_venn[<span class="st">'CDP2016 data edited'</span>] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>currentCondition <span class="op">=</span> fn_case1a(df_venn, var_s1_2016, var_s2_2016, var_tot2016)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition, var_city2016].count()</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017, var_sf2016, var_sf2017, var_incScopes, <span class="st">'CDP2016 data edited'</span>] ]</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; 4 cities satisfy Case 1.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="47">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>79</th>
      <td>Lima</td>
      <td>15432105.0</td>
      <td>12378734.0</td>
      <td>15432105.0</td>
      <td>2868080.0</td>
      <td>12688756.0</td>
      <td>3919620.0</td>
      <td>1.802142</td>
      <td>5.79</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>105</th>
      <td>Cascais</td>
      <td>565382.0</td>
      <td>565382.0</td>
      <td>266221.0</td>
      <td>565382.0</td>
      <td>565382.0</td>
      <td>266221.0</td>
      <td>1.470869</td>
      <td>1.47</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Región Metropolitana de Santiago</td>
      <td>23120027.8</td>
      <td>23120027.8</td>
      <td>8306669.0</td>
      <td>28406420.0</td>
      <td>18030830.0</td>
      <td>10375589.0</td>
      <td>1.359285</td>
      <td>1.00</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Windsor</td>
      <td>2475703.0</td>
      <td>2475703.0</td>
      <td>6709.0</td>
      <td>1074018.0</td>
      <td>1775831.0</td>
      <td>109527.0</td>
      <td>1.002710</td>
      <td>1.76</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="action-for-case-1a" class="level3">
<h3 class="anchored" data-anchor-id="action-for-case-1a">Action for Case 1a</h3>
<ul>
<li>Assume the total is incorrect. Recalculate total by summing scopes.<br>
</li>
<li>Re-calculate scope fraction based on new total.<br>
</li>
<li>Add a note in new column ‘CDP2016 data edited’ to keep track of all modified data</li>
</ul>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, var_tot2016] <span class="op">=</span> df_venn[[var_s1_2016, var_s2_2016]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, var_sf2016] <span class="op">=</span> df_venn[[var_s1_2016, var_s2_2016]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)<span class="op">/</span>df_venn[var_tot2016]</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, <span class="st">'CDP2016 data edited'</span>] <span class="op">=</span> <span class="st">'Case 1a: re-calculated CDP2016 TOT by summing CDP2016 s1+s2'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, var_sf2016, var_tot2016,var_s1_2016,var_s2_2016, <span class="st">'CDP2016 data edited'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>79</th>
      <td>Lima</td>
      <td>1.0</td>
      <td>27810839.0</td>
      <td>12378734.0</td>
      <td>15432105.0</td>
      <td>Case 1a: re-calculated CDP2016 TOT by summing CDP2016 s1+s2</td>
    </tr>
    <tr>
      <th>105</th>
      <td>Cascais</td>
      <td>1.0</td>
      <td>831603.0</td>
      <td>565382.0</td>
      <td>266221.0</td>
      <td>Case 1a: re-calculated CDP2016 TOT by summing CDP2016 s1+s2</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Región Metropolitana de Santiago</td>
      <td>1.0</td>
      <td>31426696.8</td>
      <td>23120027.8</td>
      <td>8306669.0</td>
      <td>Case 1a: re-calculated CDP2016 TOT by summing CDP2016 s1+s2</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Windsor</td>
      <td>1.0</td>
      <td>2482412.0</td>
      <td>2475703.0</td>
      <td>6709.0</td>
      <td>Case 1a: re-calculated CDP2016 TOT by summing CDP2016 s1+s2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="conclusion-for-case-1a" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-for-case-1a">Conclusion for Case 1a</h3>
<ul>
<li>all 4 cities that pass this check have been resolved</li>
</ul>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Record changes in 'CDP2016 data edited' column</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, <span class="st">'CDP2016 data edited'</span>] <span class="op">=</span> (</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CDP2016 TOT recalculated by summing both CDP2016 scopes.'</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Assign Emisisons Quality Flag</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'A'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="case-1b.-tot-s1-or-s2-only-one-of-the-scopes-exist" class="level3">
<h3 class="anchored" data-anchor-id="case-1b.-tot-s1-or-s2-only-one-of-the-scopes-exist">Case 1b. TOT = s1 OR s2, only one of the scopes exist</h3>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>currentCondition <span class="op">=</span> fn_case1b(df_venn, var_s1_2016, var_s2_2016, var_tot2016)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition, var_city2016].count()</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017, var_sf2016, var_sf2017, var_incScopes, <span class="st">'CDP2016 data edited'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Bogor</td>
      <td>2193642.0</td>
      <td>2193642.0</td>
      <td>NaN</td>
      <td>2193642.0</td>
      <td>954020.0</td>
      <td>1239622.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Addis Ababa</td>
      <td>3708292.0</td>
      <td>3708292.0</td>
      <td>NaN</td>
      <td>3708292.0</td>
      <td>3708292.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Reykjavík</td>
      <td>346630.0</td>
      <td>346630.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Vilnius</td>
      <td>1994560.0</td>
      <td>1994560.0</td>
      <td>NaN</td>
      <td>1944330.0</td>
      <td>1944329.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Lagos</td>
      <td>29426266.0</td>
      <td>29426266.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>133</th>
      <td>Davis, CA</td>
      <td>348437.0</td>
      <td>348437.0</td>
      <td>NaN</td>
      <td>348437.0</td>
      <td>348437.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>164</th>
      <td>Nashville and Davidson</td>
      <td>12275845.0</td>
      <td>12275845.0</td>
      <td>NaN</td>
      <td>12481363.0</td>
      <td>6680194.0</td>
      <td>5801169.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>Total Scope 1, Scope 2  (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>168</th>
      <td>Palo Alto</td>
      <td>152631.0</td>
      <td>152631.0</td>
      <td>NaN</td>
      <td>153948.0</td>
      <td>153948.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>183</th>
      <td>Brasília</td>
      <td>7739830.0</td>
      <td>7739830.0</td>
      <td>NaN</td>
      <td>7739830.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="action-for-case-1b" class="level3">
<h3 class="anchored" data-anchor-id="action-for-case-1b">Action for Case 1b</h3>
<ul>
<li>For 2 cities (Bogor; Nashville and Davidson) where sf2017 = 1.0, can replace with CDP2017. Note that Scopes Included (CDP2017) does not have Scope 3, so the TOT makes sense. Assign Emissions Quality Flag A</li>
<li>Assume that TOT is wrong for remaining 7 cities because missing scope is 0 =&gt; EQF E. Therefore leave as is. Especially as CDP2017 replacement candidate values either do not exist, have the same problem, or include Scope 3…</li>
</ul>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>replaceReason <span class="op">=</span> (</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">' TOT = s1, s2 does not exist (Case 1b) in CDP2016. Soln: Replace with CDP2017 values'</span> \</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">' (TOT, s1 and s2)'</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>fn_replace2016(</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    df_venn, df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Bogor'</span>), replaceReason, list2016, list2017</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>fn_replace2016(</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    df_venn, df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Nashville'</span>), replaceReason, list2016, list2017</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Assign Emissions Quality Flag (EQF) A</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Bogor'</span>), <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Nashville'</span>), <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Bogor'</span>), </span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>            [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_sf2016,</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>             var_sf2017,var_tot2017, </span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>             var_s1_2017, var_s2_2017,<span class="st">'CDP2016 data edited'</span>, <span class="st">'Emissions Quality Flag'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>CDP2016 data edited</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Bogor</td>
      <td>2193642.0</td>
      <td>954020.0</td>
      <td>1239622.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2193642.0</td>
      <td>954020.0</td>
      <td>1239622.0</td>
      <td>Replaced by CDP2017 data. Reason:  TOT = s1, s2 does not exist (Case 1b) in CDP2016. Soln: Replace with CDP2017 values (TOT, s1 and s2)</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Nashville'</span>), </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>            [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_sf2016,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>             var_sf2017,var_tot2017, </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>             var_s1_2017, var_s2_2017,<span class="st">'CDP2016 data edited'</span>, <span class="st">'Emissions Quality Flag'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>CDP2016 data edited</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>164</th>
      <td>Nashville and Davidson</td>
      <td>12481363.0</td>
      <td>6680194.0</td>
      <td>5801169.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>12481363.0</td>
      <td>6680194.0</td>
      <td>5801169.0</td>
      <td>Replaced by CDP2017 data. Reason:  TOT = s1, s2 does not exist (Case 1b) in CDP2016. Soln: Replace with CDP2017 values (TOT, s1 and s2)</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="add-emissions-quality-flag" class="level3">
<h3 class="anchored" data-anchor-id="add-emissions-quality-flag">Add Emissions Quality Flag</h3>
<p>EQF E: TOT is not the total since one scope is missing.</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition <span class="op">&amp;</span> (df_venn[var_sf2016].isnull()),<span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'E'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make note in 'CDP2016 data edited' column</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition <span class="op">&amp;</span> (df_venn[var_sf2016].isnull()), <span class="st">'CDP2016 data edited'</span>] <span class="op">=</span> (</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CDP2016 TOT likely wrong because one scope is missing.'</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[<span class="st">'Emissions Quality Flag'</span>]<span class="op">==</span><span class="st">'E'</span>, </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>            [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_sf2016,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>             var_sf2017,var_tot2017, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>             var_s1_2017, var_s2_2017,<span class="st">'CDP2016 data edited'</span>, <span class="st">'Emissions Quality Flag'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>CDP2016 data edited</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>58</th>
      <td>Addis Ababa</td>
      <td>3708292.0</td>
      <td>3708292.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3708292.0</td>
      <td>3708292.0</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Reykjavík</td>
      <td>346630.0</td>
      <td>346630.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Vilnius</td>
      <td>1994560.0</td>
      <td>1994560.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1944330.0</td>
      <td>1944329.0</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Lagos</td>
      <td>29426266.0</td>
      <td>29426266.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>133</th>
      <td>Davis, CA</td>
      <td>348437.0</td>
      <td>348437.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>348437.0</td>
      <td>348437.0</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>168</th>
      <td>Palo Alto</td>
      <td>152631.0</td>
      <td>152631.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>153948.0</td>
      <td>153948.0</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>183</th>
      <td>Brasília</td>
      <td>7739830.0</td>
      <td>7739830.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7739830.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="case-2.-cdp2016-tot-scope1-scope2-within-forgiveness-range" class="level2">
<h2 class="anchored" data-anchor-id="case-2.-cdp2016-tot-scope1-scope2-within-forgiveness-range">Case 2. CDP2016 TOT = (scope1 + scope2) within forgiveness range</h2>
<p>Exclude cities that have already been investigated (column ‘CDP2016 data edited’ not null).</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>currentCondition <span class="op">=</span> fn_case2_tolerable(df_venn, var_s1_2016, var_s2_2016, var_tot2016, var_sf2016)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition, var_city2016].count()</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017, var_sf2016, var_sf2017, var_incScopes, <span class="st">'CDP2016 data edited'</span>] ].head(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>33</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="58">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Suwon</td>
      <td>5775155.00</td>
      <td>3670140.00</td>
      <td>2710235.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.104797</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>120</th>
      <td>Lausanne</td>
      <td>499573.00</td>
      <td>456843.00</td>
      <td>45730.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.006005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>186</th>
      <td>Zaragoza</td>
      <td>1785603.75</td>
      <td>1175162.74</td>
      <td>613341.01</td>
      <td>1785603.750</td>
      <td>1175162.74</td>
      <td>613341.01</td>
      <td>1.001624</td>
      <td>1.0</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>106</th>
      <td>Faro</td>
      <td>265.85</td>
      <td>128.00</td>
      <td>138.00</td>
      <td>246.331</td>
      <td>104.00</td>
      <td>143.00</td>
      <td>1.000564</td>
      <td>1.0</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#How much within tolerance are these 33 cities?</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, var_sf2016]].sort_values(var_sf2016)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>139</th>
      <td>Houston</td>
      <td>0.914997</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Bogotá</td>
      <td>0.952672</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Salvador</td>
      <td>0.975560</td>
    </tr>
    <tr>
      <th>102</th>
      <td>Madrid</td>
      <td>0.979461</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Batangas</td>
      <td>0.987688</td>
    </tr>
    <tr>
      <th>176</th>
      <td>San Francisco</td>
      <td>0.988066</td>
    </tr>
    <tr>
      <th>172</th>
      <td>St Louis</td>
      <td>0.992139</td>
    </tr>
    <tr>
      <th>116</th>
      <td>Iowa</td>
      <td>0.993070</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Eugene</td>
      <td>0.995000</td>
    </tr>
    <tr>
      <th>126</th>
      <td>Hermosa Beach, CA</td>
      <td>0.999534</td>
    </tr>
    <tr>
      <th>129</th>
      <td>Bournemouth</td>
      <td>0.999968</td>
    </tr>
    <tr>
      <th>135</th>
      <td>Burlington</td>
      <td>0.999992</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Venezia</td>
      <td>0.999999</td>
    </tr>
    <tr>
      <th>185</th>
      <td>Sorocaba</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Belo Horizonte</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Milano</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>182</th>
      <td>Alcaldía Metropolitana de Caracas</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>184</th>
      <td>La Paz</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Kadiovacik</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Palmas</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>169</th>
      <td>Philadelphia</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>115</th>
      <td>Yilan</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Guaratinguetá</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Vancouver</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>110</th>
      <td>Santarém</td>
      <td>1.000003</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Tokyo</td>
      <td>1.000014</td>
    </tr>
    <tr>
      <th>113</th>
      <td>Pretoria - Tshwane</td>
      <td>1.000148</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Ravenna</td>
      <td>1.000303</td>
    </tr>
    <tr>
      <th>112</th>
      <td>Johannesburg</td>
      <td>1.000513</td>
    </tr>
    <tr>
      <th>106</th>
      <td>Faro</td>
      <td>1.000564</td>
    </tr>
    <tr>
      <th>186</th>
      <td>Zaragoza</td>
      <td>1.001624</td>
    </tr>
    <tr>
      <th>120</th>
      <td>Lausanne</td>
      <td>1.006005</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Suwon</td>
      <td>1.104797</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="conclusion-for-case-2" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-for-case-2">Conclusion for Case 2</h3>
<p>Of the 33 cities that pass Case 2 check:<br>
* The scope fraction for all ranges from 0.91-1.10 for the 29 cities that pass this check, therefore leave as is.</p>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check where TOT == S1+S2 exactly</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_case2_exact(df, var_s1, var_s2, var_tot, var_sf):</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Check if tot == (s1+s2) exactly.</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Ignore cities that have already been checked."""</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    case2_exact <span class="op">=</span> (   </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>        (df[var_tot] <span class="op">==</span> df[[var_s1, var_s2]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) ) </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (df[<span class="st">'CDP2016 data edited'</span>].isnull() )</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> case2_exact</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>currentCondition <span class="op">=</span> fn_case2_exact(df_venn, var_s1_2016, var_s2_2016, var_tot2016, var_sf2016)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition, var_city2016].count()</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                               var_s1_2017, var_s2_2017, var_sf2016, var_sf2017, var_incScopes, </span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'CDP2016 data edited'</span>] ].head(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>76</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="61">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>34</th>
      <td>Udine</td>
      <td>613588.00</td>
      <td>438005.00</td>
      <td>175583.0</td>
      <td>613588.00</td>
      <td>438005.0</td>
      <td>175583.00</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>142</th>
      <td>Arlington, VA</td>
      <td>2480700.00</td>
      <td>1257464.00</td>
      <td>1223236.0</td>
      <td>279743.00</td>
      <td>1239302.0</td>
      <td>1273559.00</td>
      <td>1.0</td>
      <td>8.98</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>137</th>
      <td>Dallas</td>
      <td>17229388.00</td>
      <td>119881.00</td>
      <td>17109507.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>136</th>
      <td>Flagstaff</td>
      <td>1211617.47</td>
      <td>621293.07</td>
      <td>590324.4</td>
      <td>1424562.96</td>
      <td>949707.2</td>
      <td>474855.76</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016]<span class="op">==</span><span class="st">'Rotterdam'</span>, [var_city2016, var_tot2016,var_tot2017,var_s1_2016, var_s1_2017,var_s2_2016, var_s2_2017,<span class="st">'CDP2016 data edited'</span>,var_eqf]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>CDP2016 data edited</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>Rotterdam</td>
      <td>31512000.0</td>
      <td>34190633.0</td>
      <td>30011000.0</td>
      <td>17840039.0</td>
      <td>1501000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>replaceReason <span class="op">=</span> (</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">' TOT = s1, s2 does not exist (Case 1b) in CDP2016. Soln: Replace with CDP2017 values'</span> \</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">' (TOT, s1 and s2)'</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>fn_replace2016(</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    df_venn, df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Bogor'</span>), replaceReason, list2016, list2017</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Account Number</th>
      <th>City Name (CDP2016)</th>
      <th>Country (CDP2016)</th>
      <th>City Short Name (CDP2016)</th>
      <th>C40 (CDP2016)</th>
      <th>Reporting Year (CDP2016)</th>
      <th>Measurement Year (CDP2016)</th>
      <th>Boundary (CDP2016)</th>
      <th>Primary Methodology (CDP2016)</th>
      <th>Methodology Details (CDP2016)</th>
      <th>...</th>
      <th>Reason for increase/decrease in emissions (CDP2017)</th>
      <th>Population (CDP2017)</th>
      <th>Population year (CDP2017)</th>
      <th>City Location (CDP2017)</th>
      <th>Country Location (CDP2017)</th>
      <th>Measurement year only (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>CDP2016 data edited</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>124</th>
      <td>57347</td>
      <td>Pingtung County Government</td>
      <td>Taiwan</td>
      <td>Pingtung</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>The main increased department are energy, industry, and waste</td>
      <td>835792.0</td>
      <td>2016.0</td>
      <td>(22.6558, 120.4703)</td>
      <td>(23.69781, 120.960515)</td>
      <td>2013.0</td>
      <td>11162.499957</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>79</th>
      <td>31170</td>
      <td>Metropolitan Municipality of Lima</td>
      <td>Peru</td>
      <td>Lima</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>La metodología Global Protocol for Community- scale Greenhouse Gas emissions (GPC) establece que los límites pueden definirse en cualquiera de tres niveles: Internacional, inter-ciudades/subnacional, o al interior de la ciudad.</td>
      <td>...</td>
      <td>Han aumentado puesto que no se ha trabajado en proyectos o programas que tengan gran potencial de reducción en gases con efecto invernadero.</td>
      <td>8755262.0</td>
      <td>2014.0</td>
      <td>(-12.046374, -77.042793)</td>
      <td>(-9.189967, -75.015152)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>5.79</td>
      <td>CDP2016 TOT recalculated by summing both CDP2016 scopes.</td>
      <td>A</td>
    </tr>
    <tr>
      <th>61</th>
      <td>54402</td>
      <td>City of Lahti</td>
      <td>Finland</td>
      <td>Lahti</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>With some national modifications</td>
      <td>...</td>
      <td>Decreased from baseline year 1990. New waste gasification plant 2012 and collecting separate energy waste from citizens. Effective waste water treatment with collecting biogas before composting the sludge. Effective and energy-efficient waste and biowaste collection and treatment (new biogas plant 2014). Better energy effiency in buildings.</td>
      <td>119452.0</td>
      <td>2016.0</td>
      <td>(60.9833, 25.65)</td>
      <td>(61.92411, 25.748151)</td>
      <td>2015.0</td>
      <td>1.525691</td>
      <td>1.22</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>105</th>
      <td>50680</td>
      <td>Cascais</td>
      <td>Portugal</td>
      <td>Cascais</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>this was made with calculous platforms from international organizations such as UN (IPCC, and ICLEI) as well as EU comission</td>
      <td>...</td>
      <td>We have verified a decrease in fuel consumption between the mentioned time period.</td>
      <td>208122.0</td>
      <td>2014.0</td>
      <td>(38.6970565, -9.4222945)</td>
      <td>(39.399872, -8.224454)</td>
      <td>2010.0</td>
      <td>1.000000</td>
      <td>1.47</td>
      <td>CDP2016 TOT recalculated by summing both CDP2016 scopes.</td>
      <td>A</td>
    </tr>
    <tr>
      <th>33</th>
      <td>31180</td>
      <td>Región Metropolitana de Santiago</td>
      <td>Chile</td>
      <td>Región Metropolitana de Santiago</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>GPC was used for organizing information, while for the estimation of emissions (equations and emission factors) the IPCC guidelines was used.</td>
      <td>...</td>
      <td>The emissions has decreased 1% respect year 2012. There was a significant decrease in the energy industry emissions, however it was counteracted by an increase in the transport sector.</td>
      <td>6527903.0</td>
      <td>2012.0</td>
      <td>(-33.44889, -70.669265)</td>
      <td>(-35.675147, -71.542969)</td>
      <td>2013.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>CDP2016 TOT recalculated by summing both CDP2016 scopes.</td>
      <td>A</td>
    </tr>
    <tr>
      <th>89</th>
      <td>43920</td>
      <td>City of Ljubljana</td>
      <td>Slovenia</td>
      <td>Ljubljana</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>The difference that occurs in emissions (between C1.4 and C1.5) is a result of different emissions counting from electricity consumption as required by the COM. Check the XLS REPORT: Table B. Summary - I.4.4 Energy supplied to the grid is informal only - not summed in the total emissions (Scope 1), like in your caclulation C1.5 row 3 - CITY INDUCED FRAMEWORK ONLY</td>
      <td>...</td>
      <td>due to the actions taken. city centre closed for traffic, ordering of electricity (100 % RES), refurbishment of building (public and private through subsidies from public companies and state Eco-fund), iintroduction of CNG and electric buses in public transport, installation on electric cars charging stations, ...</td>
      <td>288307.0</td>
      <td>2016.0</td>
      <td>(46.056947, 14.505751)</td>
      <td>(46.151241, 14.995463)</td>
      <td>2014.0</td>
      <td>1.314504</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>84</th>
      <td>44185</td>
      <td>Suwon City</td>
      <td>South Korea</td>
      <td>Suwon</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.104797</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>120</th>
      <td>54520</td>
      <td>Ville de Lausanne</td>
      <td>Switzerland</td>
      <td>Lausanne</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Baseline Emission Inventory of the Covenant of Mayor</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.006005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>35</th>
      <td>50578</td>
      <td>City of Windsor</td>
      <td>Canada</td>
      <td>Windsor</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>Community emissions have decreased between 2011 and 2014.  The largest sources of declines were in Industrial, Commercial, Institutional emissions and can likely be credited in no small part to efficiency improvements and the Province's closing of coal fired electricity generation.  The Province of Ontario made a commitment in 2002 to close all coal fired-electricity plants by 2015.  In 2014, the last coal fired electricity generation plant was closed in Ontario.</td>
      <td>217188.0</td>
      <td>2016.0</td>
      <td>(42.314937, -83.036363)</td>
      <td>(56.130366, -106.346771)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.76</td>
      <td>CDP2016 TOT recalculated by summing both CDP2016 scopes.</td>
      <td>A</td>
    </tr>
    <tr>
      <th>186</th>
      <td>46473</td>
      <td>City of Zaragoza</td>
      <td>Spain</td>
      <td>Zaragoza</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Metodología propia basada en los factores oficiales del Ministerio de Agricultura y Medioambiente para las emisiones directas y en los de la Comisión Nacional de la Energía para las debidas al uso de la electricidad</td>
      <td>...</td>
      <td>Fundamentalmente, las medidas adoptadas en las estrategias anteriormente citadas han conseguido una importante reducción de las emisiones en los sectores contemplados en el Pacto de Alcaldes: residencial y movilidad. Y ello tanto en el último año como desde 2015. Por su parte, el sector industrial ha reducido sus emisiones en el último año aunque, desde 2005 estas han aumentado, Aparte de la influencia de determinadas actuaciones del Ayuntamiento (Plan de Acuerdos voluntarios) la crisis económica ha frenado en parte el incremento de las emisiones en este sector.</td>
      <td>702564.0</td>
      <td>2016.0</td>
      <td>(41.608629, -0.887012)</td>
      <td>(40.463667, -3.74922)</td>
      <td>2014.0</td>
      <td>1.001624</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>106</th>
      <td>50673</td>
      <td>Faro</td>
      <td>Portugal</td>
      <td>Faro</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Irradiare Science of evolution</td>
      <td>...</td>
      <td>The data was collected in 2014 show that the emissions decreased in scope1 and increased in scope2. But in general the emissions decreased</td>
      <td>61019.0</td>
      <td>2015.0</td>
      <td>(37.019355, -7.93044)</td>
      <td>(39.399872, -8.224454)</td>
      <td>2014.0</td>
      <td>1.000564</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>112</th>
      <td>31115</td>
      <td>City of Johannesburg</td>
      <td>South Africa</td>
      <td>Johannesburg</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>The City of Johannesburg 2014 inventory is the first GPC compliant inventory compiled for the City. It builds on the pioneering work undertaken by Siemens who compiled the first inventory for the City for the 2007 calendar year. Siemens prepared the initial report under an arrangement with C40 in 2012, and analyses the high-level changes between the two inventory years.</td>
      <td>...</td>
      <td>This decrease could be attributed to a number of reasons, for example there seems to be a correlation between it and the drop in electricity consumption. This drop in electricity consumption is mirrored in all the major municipalities in South Africa. There may well be data deficiency artefacts. The real reasons for this decrease and/or other trend that becomes apparent,will become clear as we become more thorough in quality data collection methods. Furthermore, to enhance our understand we will do bottom up data collection at a project level.</td>
      <td>4900000.0</td>
      <td>2016.0</td>
      <td>(-26.2041028, 28.0473051)</td>
      <td>(-30.559482, 22.937506)</td>
      <td>2014.0</td>
      <td>1.000513</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>82</th>
      <td>36263</td>
      <td>Comune di Ravenna</td>
      <td>Italy</td>
      <td>Ravenna</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-21 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>The Emission Inventory (MEI)  is updated within the Sustainable Energy Action Plan. It is based on the methodology and toolkit developed by ARPA ER (Environmental Protection Agency of Emilia-Romagna Region) within the instrument IPSI (Inventory of greenhouse gas emissions for the Covenant of Mayors - Italian version). The methodology was improved and adapted by a specific working group “Climate Plan”  at regional level including the main cities and Provinces. The background knowledge is based on the Regional Greenhouse Gas Emissions Inventory realized by the Region with the support of ARPA ER, following standard estimation methodologies, internationally recognized (IPCC, CORINAIR). The MEI includes: direct emissions of the Municipality considered as an organization with its own consumptions; indirect emissions, generated by activities within the Municipal area estimated by ARPA ER as a breakdown of the regional inventory. According to the European and Regional methodology, activities within ETS (Emissions Trade System) are not taken into account.</td>
      <td>...</td>
      <td>According to the Convenant of Mayors a series of actions have been implemented and are still on going in order to reach the goal of a reduction of CO2 emissions by at least 20% by 2020.</td>
      <td>391414.0</td>
      <td>2016.0</td>
      <td>(41.913028, 12.518037)</td>
      <td>(41.87194, 12.56738)</td>
      <td>2016.0</td>
      <td>1.000303</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113</th>
      <td>49360</td>
      <td>Pretoria - Tshwane</td>
      <td>South Africa</td>
      <td>Pretoria - Tshwane</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2015-06-30 00:00:00</td>
      <td>A metropolitan area</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>The methodology as defined in the International Local Government GHG Emissions Analysis Protocol V1.0 and the Local Government Operations Protocol for the Quantification and Reporting of GHG Inventories V1.1 where used where applicable and viable.</td>
      <td>...</td>
      <td>The exclusion of the Eskom and Pre-paid energy usage in the baseline figures. The two subsequent years the afore-mentioned usage was included.</td>
      <td>3300000.0</td>
      <td>2017.0</td>
      <td>(-25.746111, 28.188056)</td>
      <td>(-30.559482, 22.937506)</td>
      <td>2014.0</td>
      <td>1.000148</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>86</th>
      <td>31111</td>
      <td>Tokyo Metropolitan Government</td>
      <td>Japan</td>
      <td>Tokyo</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2014-03-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>The guideline set by the Ministry of environmnet , Japan</td>
      <td>...</td>
      <td>NaN</td>
      <td>13646764.0</td>
      <td>2017.0</td>
      <td>(35.6896342, 139.6921007)</td>
      <td>(36.204824, 138.252924)</td>
      <td>2013.0</td>
      <td>1.000014</td>
      <td>6.32</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>110</th>
      <td>50672</td>
      <td>Santarém</td>
      <td>Portugal</td>
      <td>Santarém</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2006-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>61752.0</td>
      <td>2011.0</td>
      <td>(39.236669, -8.685994)</td>
      <td>(39.399872, -8.224454)</td>
      <td>2014.0</td>
      <td>1.000003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>53</th>
      <td>20113</td>
      <td>City of Vancouver</td>
      <td>Canada</td>
      <td>Vancouver</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>The City has compiled a GPC-compliant inventory for 2014 as a Compact of Mayors signatory.</td>
      <td>...</td>
      <td>Community LDV emissions have decreased with continued increase in landfill gas capture efficiency. Also a decrease in overall stationary energy use: green building policies and improved energy efficiency contribute to this, but also a warmer winter season in 2015. Transportation Scope 1 emissions increased: fuel sales within region increased. Economic growth is one factor, but also USD-CAD exchange rate. Due to our proximity to US border (where fuel can be considerably less expensive), cross-border fuel-ups are significant. Unfavourable exchange rates correlate to decline in cross-border fuel purchasing behaviour.</td>
      <td>631486.0</td>
      <td>2016.0</td>
      <td>(49.261226, -123.1139268)</td>
      <td>(56.130366, -106.346771)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>1.90</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>81</th>
      <td>54610</td>
      <td>Estância Turística de Guaratinguetá</td>
      <td>Brazil</td>
      <td>Guaratinguetá</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2015-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>115</th>
      <td>61753</td>
      <td>Yilan County</td>
      <td>Taiwan</td>
      <td>Yilan</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>458117.0</td>
      <td>2015.0</td>
      <td>(24.730918, 121.763222)</td>
      <td>(23.6978, 120.9605)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>169</th>
      <td>31181</td>
      <td>City of Philadelphia</td>
      <td>USA</td>
      <td>Philadelphia</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>In general the ICLEI protocol was followed, however in some cases data was not available in the same fashion or format as described in the protocol. Electricity, natural gas and steam usage was provided by the local utilities. Data related to onsite combustion of fuels was derived using the American Communities Surveys and allocated to Philadelphia based on population. Emissions from transportation was derived using the local regional planning commission's transportation model and EPA MOVES. EPA's non road emissions model was used for off road vehicles Industrial emissions were estimated by looking at EPAs GHG reporting project data and comparing it to previously known information from utilities. Waste data was modeled using MSW and private collection data along with local landfill and incinerator emissions based on total waste. This was counted as a scope 3 emissions because none of these facilities are within the City of Philadelphia</td>
      <td>...</td>
      <td>See www.phila.gov/green for Greenworks: A Vision for a Sustainable Philadelphia, which describes progress on carbon reductions to date. Philadelphia will be releasing a citywide energy vision document later in 2017 with more details on the expected trajectory of emissions in the city and strategies for meeting our 80 by 50 commitment.</td>
      <td>1555072.0</td>
      <td>2015.0</td>
      <td>(39.952335, -75.163789)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>2.29</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>54650</td>
      <td>Prefeitura de Palmas</td>
      <td>Brazil</td>
      <td>Palmas</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>O diagnóstico qualitativo das informações complementa a avaliação quantitativa.</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>34</th>
      <td>36518</td>
      <td>Comune di Udine</td>
      <td>Italy</td>
      <td>Udine</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>respect to the baseline of 2006 the GHG emissions decreased of 4% in 2013</td>
      <td>99528.0</td>
      <td>2013.0</td>
      <td>(46.0667, 13.2333)</td>
      <td>(41.87194, 12.56738)</td>
      <td>2013.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>142</th>
      <td>55799</td>
      <td>City of Arlington, VA</td>
      <td>USA</td>
      <td>Arlington, VA</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2015-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>Transportation, fuel oil use, and solid waste emissions data are the most recent available, from a 2012 inventory. Electricity and natural gas consumption in the community reflect actual 2015 data based on utility reporting.</td>
      <td>...</td>
      <td>This is our first year of calculation using the GPC method. A comparison will be available later in 2017 when a 2016 inventory is completed.</td>
      <td>220400.0</td>
      <td>2016.0</td>
      <td>(37.226486, -76.002594)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2012.0</td>
      <td>1.000000</td>
      <td>8.98</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>137</th>
      <td>35860</td>
      <td>City of Dallas</td>
      <td>USA</td>
      <td>Dallas</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Methodology included a combination of Environmental Protection Agency (EPA) reported emission factors and EPA recommended emission modeling tools.</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>136</th>
      <td>54113</td>
      <td>City of Flagstaff</td>
      <td>USA</td>
      <td>Flagstaff</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Formulas taken from The Climate Registry: Pacificorp Data ('07 Generation)</td>
      <td>...</td>
      <td>Emissions resulting from transportation (specifically, the amount of gasoline and diesel) have increased since our last reported emissions inventory (2015 data). Additionally, we have improved some emissions data collection methods, which may have resulted in more accurate, but higher, emissions being recorded. We have also included natural gas used for transportation, which was not included in the previous inventory.</td>
      <td>68667.0</td>
      <td>2013.0</td>
      <td>(35.1992, -111.6311)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2016.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>134</th>
      <td>3422</td>
      <td>Greater London Authority</td>
      <td>United Kingdom</td>
      <td>London</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>London's inventory is in line with the GPC, but in 2013 does not fully break down emissions according to GPC requirements. Stationary - Published central government datasets used for energy consumption and CO2 emissions from homes (residential buildings) and workplaces (commercial, industrial and government buildings and facilities). Mobile - The London Atmospheric Emissions Inventory (in-house model) is used to calculate distances travelled from transport of people and goods by  road, railways, water-borne navigation, aviation, and off-road surface transport. National emissions factors are applied.</td>
      <td>...</td>
      <td>London's CO2 emissions decreased between 2013 and 2014. As of 2014 they are 16% lower than 1990 levels and expected to reach a 20% reduction in the 2015 GHG assessment (currently being finalised for publication later in 2017). This decline is due to decarbonisation of the national electricity grid, with a reduction in coal use and an increase in renewables share of the national energy mix. Gas usage has also decreased, due to energy efficiency improvements in homes and workplaces (including the roll-out of more efficient gas fired boilers) and a reduction in industrial activity within London. London's population continues to increase year on year and as of 2014 London's per capita emissions remain the UK's lowest at 4.4 tonnes.</td>
      <td>8600000.0</td>
      <td>2015.0</td>
      <td>(51.504858, -0.078689)</td>
      <td>(55.378051, -3.435973)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>3.06</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>128</th>
      <td>43910</td>
      <td>City of Columbus</td>
      <td>USA</td>
      <td>Columbus</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2015-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>Basic Reporting.</td>
      <td>...</td>
      <td>Greenhouse gas emissions have again increased since our baseline emission inventory of 2013, but decreased since the 2014 inventory.</td>
      <td>850106.0</td>
      <td>2016.0</td>
      <td>(39.9611755, -82.9987942)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2016.0</td>
      <td>1.000000</td>
      <td>6.10</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>125</th>
      <td>31446</td>
      <td>Taipei City Government</td>
      <td>Taiwan</td>
      <td>Taipei City</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>Taipei city using GPC methodology to make City GHG inventory since 2014.</td>
      <td>...</td>
      <td>The GHG emissions of Taipei City have been verified by third party, BSI Taiwan (British Standards Institution Taiwan), from 2005 to 2015 in 2016. The greenhouse gas emissions of Taipei City in 2015 were 12,117,400 metric tons. The greenhouse gas emissions of the City present a rising tendency in 2005-2008. The increasing tendency slowed down and began to decline since the 2008. There is no power plant in Taipei City jurisdiction; electricity usage is all dependent on the electricity grid from outside county. Although Taipei city’s electricity consumption in 2015 was lower 70 million KWh than that in 2014, the GHG emissions increased slightly in 2015 cause of the country’s electricity emission factor increased about 1.34%.</td>
      <td>2695704.0</td>
      <td>2016.0</td>
      <td>(25.037525, 121.563782)</td>
      <td>(23.69781, 120.960515)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>58627</td>
      <td>City of Alton, IL</td>
      <td>USA</td>
      <td>Alton, IL</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>123</th>
      <td>56276</td>
      <td>New Taipei City Government</td>
      <td>Taiwan</td>
      <td>New Taipei</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>GHG Protocol is working to give cities the standards and tools they need to measure their emissions, build more effective emissions reduction strategies, set measurable and more ambitious emission reduction goals, and to track their progress more accurately and comprehensively.</td>
      <td>...</td>
      <td>Saving energy and reducing GHGs emission efficiently.</td>
      <td>3970644.0</td>
      <td>2016.0</td>
      <td>(25.0111, 121.4458)</td>
      <td>(23.69781, 120.960515)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>4.88</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>83</th>
      <td>31110</td>
      <td>Roma Capitale</td>
      <td>Italy</td>
      <td>Roma</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>The metodology is top - down, using data of primary energy source amount.</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>88</th>
      <td>36154</td>
      <td>Vilnius City Municipality</td>
      <td>Lithuania</td>
      <td>Vilnius</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>Inventory report is prepared in accordance with the methodology recommended by the Intergovernmental Panel on Climate Change (IPCC) publications: 1. Revised 1996 Guidelines for National Greenhouse Gas Inventories, IPCC, 1997; 2. Good Practice Guidance and Uncertainty Management in National Greenhouse Gas Inventories, IPCC, 2000; 3. 2006 IPCC Guidelines for National Greenhouse Gas Inventories, IPCC, 2006 GHG emissions were calculated from activity levels in the different sectors that are in accordance with the IPCC publications.</td>
      <td>...</td>
      <td>Increased wooden biomass utilization in Energy sector for the central heating.</td>
      <td>542626.0</td>
      <td>2015.0</td>
      <td>(54.687156, 25.279651)</td>
      <td>(55.169438, 23.881275)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>90</th>
      <td>31167</td>
      <td>City of Lagos</td>
      <td>Nigeria</td>
      <td>Lagos</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>93</th>
      <td>31148</td>
      <td>City of Amsterdam</td>
      <td>Netherlands</td>
      <td>Amsterdam</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2016-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Local standard based on electricity, gas, district heat en local transportation.</td>
      <td>...</td>
      <td>The decrease is very strong (10%) The reason for this is the exclution of emissions related to transport on national roads. Due to a new calculation model of the traffic department of the city these roads are no longer included in the vehicle movement calculation of the city.</td>
      <td>834713.0</td>
      <td>2016.0</td>
      <td>(52.370216, 4.895168)</td>
      <td>(52.132633, 5.291266)</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>103</th>
      <td>55325</td>
      <td>Município de Águeda</td>
      <td>Portugal</td>
      <td>Águeda</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>0</td>
      <td>Other</td>
      <td>Sustainable Energy Action Plan (SEAP) + SEAP Monitoring Report: Águeda’s SEAP holds a total carbon reduction potential of 33% by 2020, using 2002 as the reference year. The considered actions will also result in substantial economical benefits for the region’s citizens, companies and municipality, estimated at an average of 8 million Euros per year.An average investment of 3,3 million Euros per year is required to implement the actions included in the SEAP, but the bulk of this cost can be supported by external investment (public incentives, bank loans, ESCO models and the transaction of white certificates and carbon credits), which reduces to 1,2 million Euros per year the investment to be supported by the region’s citizens, companies and municipality.</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>109</th>
      <td>46514</td>
      <td>City of Porto</td>
      <td>Portugal</td>
      <td>Porto</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2009-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>The GHG emissions inventory was developed through the energy supply and demand data by the Portuguese Directorate-General for Energy and Geology (www.dgeg.pt) and the National Statistics Institute (www.ine.pt). The Transports sector was estimated through a separate and specific mobility needs model.</td>
      <td>...</td>
      <td>Porto Energy Agency has already calculated GHG emissions for 2004 , 2009 and 2012 and 2015 (this last one with non definite or mature data). The 2004 GHG emissions were the basis for the Sustainable Action Plan development. The 2009 and 2015 GHG emissions balance, point to a decrease in the emissions (by 22% and 26% respectively) - which indicates that Porto is half way of his ambitious target to 2020 – and these results are mainly  because of the decrease in the demand of fossil fuels (in mobility due to the Metro expansion) and “greener” national grid electricity.</td>
      <td>238954.0</td>
      <td>2011.0</td>
      <td>(41.1579438, -8.6291053)</td>
      <td>(39.399872, -8.224454)</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>111</th>
      <td>19233</td>
      <td>Torres Vedras Municipality</td>
      <td>Portugal</td>
      <td>Torres Vedras</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2009-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>The city has done a emission inventory in 2009 and another in 2014, the results indicate that the emissions has decreased (the changes are due to emissions redution actions  foreseen in sustainable energy action plan and to the national economic crises).</td>
      <td>79465.0</td>
      <td>2011.0</td>
      <td>(38.763669, -9.30148)</td>
      <td>(39.399872, -8.224454)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>118</th>
      <td>3429</td>
      <td>City of Stockholm</td>
      <td>Sweden</td>
      <td>Stockholm</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>The Stockholm proprietary method. The total emissions for the community include (Scope 1 &amp; 2 as defined in "International standard for determining GHG for cities" Version 2.1 and "Global protocol for community-scale GHG (GPD)" Pilot Version 1.0”. Scope 3 defined as the life cycle emissions of the energy use): Scope 1 &amp; 3 emissions from district heating &amp; cooling system and other in-boundary fuel combustion for heating; Scope 2 &amp; 3 emissions of the house-hold electricity consumption within the community boundary; Scope 1 &amp; 3 emissions of use of gas  e.g. cooking; Scope 2 &amp; 3 emissions for electricity use in the transportation system (metro, commuter, train) within the community; Scope 1 &amp; 3 emissions for the fuel consumption from road traffic, non-road vehicles and shipping, &amp; scope 1 emissions from aviation (within the landing &amp; take-off cycle, i.e. up to 915m). This means that scope 3 emissions from transport of inhabitants outside the community boundary is not included (but transport of non-inhabitants within the community boundary is). Emission from household waste incineration is embedded in the district heating emissions, since household waste is a source of energy used in district heating. Energy use for waste-water handling is included in the total community energy use. \nEmission factors are collected from a report published by Swedish Environmental Research Institute Ltd. (IVL) in 2001 and Thermal Engineering Research Institute (Värmeforsk) in 2011. The reports are widely used and acknowledged. The global warming potentials are GWP100 from IPCC 2007, as recommended by the Swedish Environmental Protection Agency (SEPA). Energy statistics are collected from different sources: district heating &amp; gas statistics are collected from the companies; electricity statistics is compiled and collected from Statistics Sweden; emissions from road transport is modeled using an extensive emission model combined with a road model over Stockholm (includes a variety vehicles, speeds, road types etc) and non-road emissions are taken from Statistics Sweden; marine emissions within the community boundary are based on emissions &amp; energy use presented in environmental reports from shipping companies and Ports of Stockholm.</td>
      <td>...</td>
      <td>Total emissions from the categories in Stockholm estimates at system boundaries have been reduced significantly over the past 10 years. Meanwhile, the population has grown by about 200 000 inhabitants. In Stockholm, it can be said that the reduction in per capita emissions by half will depend on the actual response, half of the population growth. The greenhouse gas emissions in Stockholm is calculated to 2.5 tonnes per capita in 2015, which can be compared to 2.6 tonnes per capita in 2014. Energy use for heating has decreased, which is due to energy efficiency measures and conversions (from oil to heat pumps). Stockholm has a clear reduction of the energy supply per capita for heating sector. Electricity use is however quite constant. The car traffic is constant in the last years even though the population has increased. However, there has been an increase in truck traffic. The overall greenhouse gas emissions from transportation is constant over the last years.</td>
      <td>923516.0</td>
      <td>2015.0</td>
      <td>(59.3293235, 18.0685808)</td>
      <td>(60.128161, 18.643501)</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>119</th>
      <td>31151</td>
      <td>Basel-Stadt</td>
      <td>Switzerland</td>
      <td>Basel-Stadt</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Other</td>
      <td>Energy-consumption statistics of the canton Basel-Stadt. CO2-emissions can be calculated according to the energy consumption. The calculation of the air-quality report of the canton Basel-Stadt is based on Corinair: http://www.eea.europa.eu/publications/EMEPCORINAIR5. Air-quality report: http://www.baselland.ch/fileadmin/baselland/files/docs/bud/lufthygiene/plan/luftreinhalteplan_2010_bericht.pdf. Last actualisation 2010. Next actualisation 2015. Report about the 2000-Watt-Society: http://www.aue.bs.ch/Energiestudie-BS-Endbericht-2011.pdf</td>
      <td>...</td>
      <td>NaN</td>
      <td>198206.0</td>
      <td>2016.0</td>
      <td>(47.5619, 7.5928)</td>
      <td>(46.818188, 8.227512)</td>
      <td>2016.0</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>121</th>
      <td>35449</td>
      <td>Stadt Zürich</td>
      <td>Switzerland</td>
      <td>Stadt Zürich</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>The 2000-Watt society methodology is a concept of sustainable development that uses two indicators: Primary energy demand and greenhouse gas emissions. The methodology is based on the final energy demand. Primary energy factors and GHG emission coefficients are according to the ecoinvent database (database with consistent and transparent, up-to-date Life Cycle Inventory (LCI) data – www.ecoinvent.org/database/). The grey energy of net imported other goods and services is not included in the methodology used by the city of Zurich as there is no specific data available. The methodology does not include emissions from non-energetic sources (e.g. landfills, waste water treatment). Primary energy, final energy and effective energy: The 2000-watt methodology defines primary energy as the total energy present in the original energy source, plus its grey energy. The energy that reaches the customer, after all conversion and transmission losses, is called final energy. In turn, only a part of this is actually used: the effective energy. The rest is lost as waste heat. Basis for all calculations is the final energy demand. Territorial principle: Basis of the methodology is the territorial principle. It refers to the energy consumed in the city area and the emissions which occur there. The energy sources grey energy and grey emissions are also taken into account. The grey energy of net imported other goods and service is not included in the 2000 watt society methodology (lack of specific data). However, the aim is to separately calculate and indicate the gray energy of net imported other goods and services. All calculations in regards to primary energy demand and greenhouse gas emissions are made with the balancing program ECORegion (http://www.ecospeed.ch/).</td>
      <td>...</td>
      <td>The course of greenhouse gas emissions since 2008 is more or less constant. We assume that the positive effects of modernizing insulation of buildings are mostly compensated  by increased demands for comfort (e.g. higher room temperatures, larger living spaces, longer heating periods).</td>
      <td>415682.0</td>
      <td>2016.0</td>
      <td>(47.3686498, 8.5391825)</td>
      <td>(46.818188, 8.227512)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>127</th>
      <td>1850</td>
      <td>Birmingham City Council</td>
      <td>United Kingdom</td>
      <td>Birmingham</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Other</td>
      <td>Data supplied by Department of Energy &amp; Climate Change annually with a two year lag.  Dataset is Local Authority Emissions within scope.</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>130</th>
      <td>31052</td>
      <td>City of Cardiff</td>
      <td>United Kingdom</td>
      <td>Cardiff</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Department of Energy and Climate Change (DECC) local authority CO2 emissions data</td>
      <td>...</td>
      <td>Main reduction in industry / commercial emissions but also some decrease in domestic emissions</td>
      <td>354300.0</td>
      <td>2014.0</td>
      <td>(51.481581, -3.17909)</td>
      <td>(55.378051, -3.435973)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>131</th>
      <td>54529</td>
      <td>City of Leicester</td>
      <td>United Kingdom</td>
      <td>Leicester</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>132</th>
      <td>52897</td>
      <td>City of Aspen and Pitkin County</td>
      <td>USA</td>
      <td>Aspen and Pitkin County</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>Aggregate emissions: -7.4% between 2004 and 2014. Res. Energy: +5%; Comm. Energy: -26%; Vehicles: - 13%; Airport: +15%; Waste:=2%</td>
      <td>8427.0</td>
      <td>2010.0</td>
      <td>(39.195, -106.837)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>1.21</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>133</th>
      <td>59552</td>
      <td>City of Davis, CA</td>
      <td>USA</td>
      <td>Davis, CA</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-01-01 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>The City updated the inventory in 2012 using the latest available data from 2010.</td>
      <td>...</td>
      <td>Lower carbon emission electricity energy mix (grid).</td>
      <td>65600.0</td>
      <td>2010.0</td>
      <td>(38.544907, -121.740517)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2009.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>138</th>
      <td>35898</td>
      <td>Greater Manchester</td>
      <td>United Kingdom</td>
      <td>Manchester</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>A GPC Compliant dataset has been established for Greater Manchester, including primary data from 2013. This work has been undertaken by Anthesis, who also support the World Resources Institute in the development of Carbon Reduction and emissions reporting and trajectory methodologies and reporting tools.</td>
      <td>...</td>
      <td>Emissions decreased from is 18.1 to 17.9 million tonnes between 2013 and 2014. This represents a change from our GHG emissions tonnage figure reported to CDP in 2015 and a slight decrease in the first 2013 Global GHC protocol compliant Baseline Emissions inventory.  Repeating the reasons for the change - between emissions reported in 2015 submission and now (due to move to a compliant BEI process), this is due to inclusion of scope 3 emissions included in the Basic/Basic+ element of the inventory which GM commissioned which is now compliant with the Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI).  Previous submissions to CDP only included scope 1 and 2 emissions which drew directly from the national government DECC Local and Regional CO2 Emissions Estimates for 2005-2012 which used similar but not identical methodologies. This is part of a longer trend of decreasing emissions, punctuated with occasional increase years. Primary factors which determine the performance are the use of coal in any one year for grid electricity generation, and weather conditions during spring and autumn, where an extended heating season can occur if these are cold. A decline in total energy consumption is the most significant long term trend factor, due to the uptake of more energy efficient appliances, home adaptations, goods, services and transport</td>
      <td>2762000.0</td>
      <td>2014.0</td>
      <td>(53.4575955, -2.1578377)</td>
      <td>(55.378051, -3.435973)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>146</th>
      <td>35853</td>
      <td>City of Baltimore</td>
      <td>USA</td>
      <td>Baltimore</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>ICLEI’s methodology provides a systematic framework for local governments to track energy- and waste-related activities in the community, and to calculate the amounts of greenhouse gases produced by each activity and sector. The inventory methodology involves two sections: a community-wide assessment and a separate inventory of government operations. Once completed, these inventories provide the basis for an emission forecast, and allow for the quantification of emission reductions associated with proposed measures. Baltimore City’s Greenhouse Gas Emissions Inventory consists of two essentially distinct inventories: one for the Baltimore City community as a whole, defined by geographic borders, and one highlighting emissions resulting from the City of Baltimore’s Government operations and buildings owned. The Government Inventory is a subset of the Community Inventory (emissions from the municipal operations are embedded in the community inventory). Distinguishing the City Governmental emissions in this way allows the City, which formally committed to reducing emissions, to lead by example in tracking its own facilities and vehicles while evaluating the effectiveness of its emission reduction efforts. Compiling Baltimore City’s emissions inventory required the collection of information from a variety of sources. The data represents 2010 energy usage, except where notes indicate data gaps that necessitated use of older records. For our scope, all emissions associated with energy consumed in Baltimore City are included, regardless of the location of the original energy source. This means that, even though the electricity used by Baltimore residents is produced in a plant outside of Baltimore City’s geographical borders, this energy and the emissions associated with it appear in Baltimore City’s inventory. The decision to capture emissions in this way reflects the general philosophy that a community should take full responsibility for the impacts associated with its energy consumption, regardless of where the energy generation occurs.</td>
      <td>...</td>
      <td>Natural gas consumption decreased in residential sector but increased in commercial and industrial sectors. Electricity consumption increased across the board. Even though electricity emissions factors decreased in 2014, the increase in electricity consumption offset improvements in emissions factors. On-road and rail activity increased. Solid waste generation decreased slightly due to increased diversion of waste from the landfill but waste water generation increased.</td>
      <td>614664.0</td>
      <td>2016.0</td>
      <td>(39.2903848, -76.6121893)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>147</th>
      <td>35884</td>
      <td>City of San Diego</td>
      <td>USA</td>
      <td>San Diego</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2009-12-31 00:00:00</td>
      <td>0</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>IPCC</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>148</th>
      <td>49787</td>
      <td>City of Benicia</td>
      <td>USA</td>
      <td>Benicia</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>In 2010, community-wide emissions with large industrial emitters had increased from 2005 by 24% while community-wide emissions without large industrial emitters increased by 41%.  There was a 5.6% increase in emissions (2000-2005, with large emitters).   When the baseline inventory was completed, the team predicted that by 2010, emissions (w/ large industrial emitters) would increase 9% from 2005 to 4.6 million metric tons.  If large emitters were still included, then the increase between 2005 and 2010 was only a 24% increase, 15% more than what was originally predicted.  However, for 2010, it was decided to exclude large emitters.  This means that increases in all other sectors have a greater impact on total emissions, i.e. the increase in transportation emissions has a much greater impact on overall emissions levels.   The roughly 35% increase between 2005 and 2010 could be due to a number of things including changes in reporting protocols, e.g. permitting requirements changed or the non-recession years outweighed the recession years.  It could also be that Benicia was not as hard hit by the recession as other communities and therefore, emissions didn't decrease. Again, educated guesses have been made as to what caused the increase.    Please note that vehicle miles travelled (VMT) grew between 2000 and 2010 by 62%, while emissions increased 95%.  The % of total emissions from transportation is within the Bay Area average. The Metropolitan Transportation Commission (MTC) calculates VMT using a proprietary software model. MTC inputs traffic counts, vehicle speeds, vehicle make and model, and fuel data into its software. In 2010, per the change in the modeling software, Benicia is now responsible for 50% of the trips that start elsewhere but end in Benicia and trips that start in Benicia but end elsewhere. This is calculated based on the number of people that exit or enter the highway in Benicia. Pass through VMT is not attributed to Benicia. Then, emissions are calculated by inputting VMT into the CACP software, which generates a GHG equivalent (MTCO2e). The increase in off road emissions is due to construction permit projections for buildings, which may have never been built. However, estimating off road emissions using construction permit data is the recommended calculation method per ICLEI’s protocol and guidance.</td>
      <td>27450.0</td>
      <td>2014.0</td>
      <td>(38.049365, -122.1585777)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>149</th>
      <td>58621</td>
      <td>Town of Blacksburg</td>
      <td>USA</td>
      <td>Blacksburg</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>We used the 2010 version of the ICLEI Protocol</td>
      <td>...</td>
      <td>The last GHG inventory performed for the Town of Blacksburg was in 2012. Over those three years decreased emissions from electric utility provider's fuel mix has resulted in decreased emissions in the residential, commercial, industrial and public sectors. Considering the population increase it is likely that the culture of electricity use may have also lead to decreased consumption. Transportation emissions have increased by 1.39% which is likely due to the 3.29% increase in population. Wastewater emissions are significantly lower because of errors made in the previous emission calculations. Emissions from solid waste have also decreased roughly 4.4%.</td>
      <td>44215.0</td>
      <td>2015.0</td>
      <td>(37.2296, -80.4139)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>150</th>
      <td>35862</td>
      <td>City of Detroit</td>
      <td>USA</td>
      <td>Detroit</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>This is the only inventory we have done.  The data has not been updated</td>
      <td>688701.0</td>
      <td>2013.0</td>
      <td>(42.331427, -83.0457538)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2012.0</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>154</th>
      <td>3203</td>
      <td>City of Chicago</td>
      <td>USA</td>
      <td>Chicago</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Chicago conducts regional GHG emissions inventories in-keeping with rigorous protocol and standards. New GHG methodologies and standards that were not available for previous analyses will be evaluated and adopted for future GHG emissions inventories, as-appropriate. The following GHG protocols were used in the 2010 Regional GHG Inventory: The LGOP for Greenhouse Gas Assessments developed by ICLEI, CAR, TCR and CARB (California Air Resources Board 2010a): This protocol includes methods for estimating emissions resulting from government buildings and facilities, government fleet vehicles, wastewater treatment and potable water treatment facilities, landfill and composting facilities, and other operations. This protocol was developed primarily for use by California local governments; although it contains methodologies for estimating emissions pertinent to community emissions sources. Further, this protocol can be modified for use outside of California, although in some cases, data sources or other references may need to be modified accordingly to local conditions or constraints. The USEPA Inventory of U.S. Greenhouse Gas Emissions and Sinks: 1990–2007 (U.S. Environmental Protection Agency 2009a): The national inventory documentation includes standard methodology and emission factors for nationwide GHG emissions inventorying. The IPCC Guidelines for National Greenhouse Gas Inventories (Intergovernmental Panel on Climate Change 2006a): This document is the international standard for inventories and provides much of the baseline methodology used in the national and statewide emission inventories. The GHG Protocol Corporate Standard developed by WRI and the WBCSD (World Resources Institute 2004): Although this is a protocol designed for use primarily by private corporations, it was one of the first documents to establish the principles and steps to developing a GHG inventory. This document has influenced the development of other types of GHG protocols, including those for municipal, government, and community-wide emissions.</td>
      <td>...</td>
      <td>Chicago conducted a preliminary comparison using the existing 2010 and 2015 data to evaluate how community emissions have changed over the last five years. Results of this preliminary analysis of 2010 and 2015 GHG emissions reveals Chicago continued to reduce total GHG emissions through 2015 in the stationary and waste sectors resulting in a greater than 7 percent reduction in GHG emissions over the last five years. During that time, Chicago’s population grew by approximately 1 percent while the region’s GRP grew by more than 12 percent. Growth coupled with reduction in total emissions resulted in a greater than 8 percent decrease in per capita emissions in the City. Between 2010 and 2015, the majority of MT CO2e reductions occurred in the stationary energy sector, followed by waste. When considering percent reductions, the waste sector experienced the greatest reduction (30 percent) which included a 35 percent emissions reduction in the solid waste disposal sub-sector. This reduction in the solid waste sector is likely driven by a decrease in the total amount of solid waste sent to landfills and an improvement in the solid waste treatment technologies at those landfills. The City expanded its residential curbside recycling pilot program to now serve over 400,000, or approximately 33 percent, of additional City houeholds.Because of the program’s expansion the City experienced a significant increase in the number of tons collected for recycling, from 58,000 in 2010 to 97,000 in 2015. The stationary energy sector overall saw a 10 percent drop in emissions, including 11, 12 and 8 percent emissions reductions in the residential, commercial and institutional buildings and facilities, and manufacturing industries and construction sub-sectors, respectively. Stationary energy sector GHG emissions reductions are likely driven by a general trend in the building industry to improve energy efficiency of buildings as well as a regional shift in energy generation towards renewable energy sources. The City has also implemented the Energy Benchmarking Ordinance, Retrofit Chicago, and the Chicago Solar Express to encourage increasing energy efficiency and renewable energy generation and consumption within the city.</td>
      <td>2720546.0</td>
      <td>2015.0</td>
      <td>(41.8781136, -87.6297982)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>161</th>
      <td>10894</td>
      <td>City of Los Angeles</td>
      <td>USA</td>
      <td>Los Angeles</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>Two primary reasons for the slight reduction are reduction in GHG intensity of electricity system and increased fuel economy of light duty vehicles. From 1990, the decline of manufacturing withing LA city limits also contributed to the decline.</td>
      <td>4030904.0</td>
      <td>2016.0</td>
      <td>(34.0522342, -118.2436849)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2013.0</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>164</th>
      <td>49335</td>
      <td>Metropolitan Government of Nashville and Davidson County</td>
      <td>USA</td>
      <td>Nashville and Davidson</td>
      <td>NaN</td>
      <td>2017.0</td>
      <td>2014-01-03 03:14:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>There was a small increase since the 2011 inventory, which was an incomplete inventory due to limited availability of data. Because of limited documentation of the 2011 inventory, it is difficult to compare the two inventories. There has been a decrease in emissions since the 2005 inventory, even with a growing population. Contributing to decreases in reported community emissions are lower emissions from Nashville’s electric power source, TVA (their emissions per unit energy output declined by about 15% from 2005 to 2014), and more efficient vehicles (vehicle CO2e emissions per mile have decreased from about 450 to 350 grams/mile between 2005 and 2014). Meanwhile (although specific data is unavailable to demonstrate the quantity), building energy efficiency has been improving through both new and retrofit projects during this time frame. LEED certification and Energy Star are examples of growing programs that help improve building energy efficiency.</td>
      <td>678889.0</td>
      <td>2015.0</td>
      <td>(36.1627, -86.7816)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason:  TOT = s1, s2 does not exist (Case 1b) in CDP2016. Soln: Replace with CDP2017 values (TOT, s1 and s2)</td>
      <td>A</td>
    </tr>
    <tr>
      <th>165</th>
      <td>13067</td>
      <td>City of New Orleans</td>
      <td>USA</td>
      <td>New Orleans</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>We submitted our 2014 baseline inventory last year as we had just completed. However, we subsequently learned more about our electricity mix and realized that our mix was not reflective of the eGrid mix and had much more nuclear and must less natural gas. We adjusted the inventory to reflect the right electricity emissions factor and that is the source of our decreased total inventory.</td>
      <td>391495.0</td>
      <td>2017.0</td>
      <td>(29.9511, -90.0715)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>168</th>
      <td>54119</td>
      <td>City of Palo Alto</td>
      <td>USA</td>
      <td>Palo Alto</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2015-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>TCR/LGOP</td>
      <td>...</td>
      <td>Combined City Municipal Operations and Palo Alto community emissions continue to decline. In 2016, overall City and Palo Alto GHG emissions were reduced an estimated 37% from 1990 levels, just under an additional 2% beyond 2015 reductions. Estimated City and community transportation related emissions declined an additional 5% from 2015 reductions, due to both a decrease in Vehicle Miles Travelled and changes in fleet composition. Natural gas emissions increased slightly from 2015, by approximately 1%, due in part to a colder fall and winter in 2016 than in 2015, which was warmer than average. Palo Alto Landfill Fugitive Emissions and Wastewater Process Emissions decreased due to efficiency measures.</td>
      <td>66478.0</td>
      <td>2017.0</td>
      <td>(37.4419, -122.143)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2016.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>171</th>
      <td>58357</td>
      <td>City of West Hollywood</td>
      <td>USA</td>
      <td>West Hollywood</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2008-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>We have not conducted a GHG inventory since 2008 but the City received a Strategic Growth Council grant to create a GHG inventory tool this year 2017. We plan to conduct another inventory as soon as possible.</td>
      <td>34399.0</td>
      <td>2010.0</td>
      <td>(34.09, -118.3617)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2008.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>174</th>
      <td>54128</td>
      <td>City of Reno</td>
      <td>USA</td>
      <td>Reno</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>Also utilized the U.S. Community Protocol for Accounting and Reporting of  Greenhouse Gas Emissions (ICLEI)</td>
      <td>...</td>
      <td>NaN</td>
      <td>236995.0</td>
      <td>2014.0</td>
      <td>(39.5296, -119.8138)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>179</th>
      <td>16581</td>
      <td>City of Seattle</td>
      <td>USA</td>
      <td>Seattle</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>Please see detailed source notes throughout the inventory document.</td>
      <td>...</td>
      <td>The total amount of GHGs emitted from the core emissions sources has declined 6% between 2008 and 2014, from 3.7 to 3.5 million metric tons of CO2-equivalent (CO2e).  However, Seattle’s population grew by 13% in the same period resulting in a per person decline in emissions of 17%. Road transportation has been the largest category of emissions since 1990. Total emissions in this sector increased between 1990 and 2008, however, they have been decreasing since 2008. Advances in vehicle technology, plus a trend towards fewer vehicle miles travelled per person, have led both to decreased absolute emissions from road transportation (down 2% since 2008) and decreased emissions per person (down 13% during this period). Between 2008 and 2014, building-related emissions declined as a result of lower overall building energy use, particularly for residential buildings, due to energy efficiency, more multi-family living, and especially by warmer weather that reduced winter heating needs. This decline, though modest, is more impressive considering Seattle’s population and economy have grown considerably since 1990.  On a per resident basis, Seattle’s emissions declined  22% per since 1990 and 6% since 2008. A number of factors led to emissions decreases that counteracted the effect of population and economic growth, especially (as already noted) the decrease in carbon intensity of Seattle City Light’s electricity, more efficient cars and trucks, and building efficiency (including smaller dwellings) and fuel switching.  Increased efficiency of air travel also contributed to a decrease in GHG emissions.</td>
      <td>662400.0</td>
      <td>2015.0</td>
      <td>(47.6062, -122.3321)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>183</th>
      <td>35995</td>
      <td>City of Brasília</td>
      <td>Brazil</td>
      <td>Brasília</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>Inventário de Emissões e Remoções Antrópicas de GEE do DF (WayCarbon, 2014). PERÍODO DE REFERÊNCIA • Geral: 2005 a 2012, ano a ano. • Mudança do uso da terra (AFOLU): Transição 1990 / 2005 / 2012 ANO DE REFERÊNCIA 2012</td>
      <td>...</td>
      <td>Considerando-se as Emissões de GEE por setor para o DF (emissões totais) no período de 2005-2012, as emissões têm aumentado em todos os setores avaliados. De acordo com a análise, os setores Energia e Resíduos apresentaram variação crescente ao longo de todos os períodos de análise. Para o setor IPPU, apenas a comparação 2005-2008 apresentou resultados menores do que o período anterior (2005-2007), com nova tendência de aumento nos demais intervalos subsequentes (devido à redução da produção de cimento em 2008 e retomada da produção nos anos seguintes). Já AFOLU apresentou intervalos irregulares de variação positiva e negativa ao longo do período, com valores negativos para os intervalos 2005-2006, 2005-2008, 2005-2009 e 2005-2010. No ano de variação positiva (2005-2007) as categorias mais representativas em emissões no setor AFOLU (Calagem e Emissões da queima de biomassa) também tiveram variação positiva nesse mesmo período.</td>
      <td>1409671.0</td>
      <td>2015.0</td>
      <td>(-15.794229, -47.882166)</td>
      <td>(-14.235004, -51.92528)</td>
      <td>2012.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 55 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Add Emissions Quality Flag</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'A'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="case-3.-cdp2016-tot-scope1-scope2-outside-forgiveness-range-intolerable" class="level2">
<h2 class="anchored" data-anchor-id="case-3.-cdp2016-tot-scope1-scope2-outside-forgiveness-range-intolerable">Case 3. CDP2016 TOT != (scope1 + scope2) outside forgiveness range [INTOLERABLE]</h2>
<p>Exclude cities that have already been investigated (column ‘CDP2016 data edited’ not null).</p>
<section id="case-3a.-tot-or-s1-s2" class="level3">
<h3 class="anchored" data-anchor-id="case-3a.-tot-or-s1-s2">Case 3a. TOT &gt;&gt; or &lt;&lt; s1 + s2</h3>
<p>(1-var_forgiveness) &lt; scope fraction &lt; (1+var_forgiveness)<br>
where scope fraction defined as (s1+s2)/TOT</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>currentCondition <span class="op">=</span> fn_case3a_intolerable(df_venn, var_s1_2016, var_s2_2016, var_tot2016, var_sf2016)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition, var_city2016].count()</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017, var_sf2016, var_sf2017, var_incScopes, <span class="st">'CDP2016 data edited'</span>] ].head(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="65">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>124</th>
      <td>Pingtung</td>
      <td>4604805.0</td>
      <td>3.704683e+10</td>
      <td>1.435430e+10</td>
      <td>4969246.69</td>
      <td>2768427.4</td>
      <td>2200856.14</td>
      <td>11162.499957</td>
      <td>1.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Lahti</td>
      <td>685460.0</td>
      <td>9.221200e+05</td>
      <td>1.236800e+05</td>
      <td>717200.00</td>
      <td>717200.0</td>
      <td>157607.00</td>
      <td>1.525691</td>
      <td>1.22</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Ljubljana</td>
      <td>2079758.0</td>
      <td>1.829808e+06</td>
      <td>9.040420e+05</td>
      <td>2733850.00</td>
      <td>1829808.0</td>
      <td>904042.00</td>
      <td>1.314504</td>
      <td>1.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Santa Monica</td>
      <td>705443.0</td>
      <td>3.025100e+05</td>
      <td>2.412530e+05</td>
      <td>334591.00</td>
      <td>119026.0</td>
      <td>215565.00</td>
      <td>0.770811</td>
      <td>1.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="action-for-case-3a" class="level3">
<h3 class="anchored" data-anchor-id="action-for-case-3a">Action for Case 3a</h3>
<ul>
<li>See if CDP2017 has useable values*.</li>
</ul>
<p><sup>*</sup>When evaluating CDP2017 values, they must pass all the above checks, plus additional checks if Waste Scope 3: s3 cannot be &gt; 15% than the total emissions; s3 != s1 OR s2; s3 &lt;&lt; s1 + s2…</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of cities in CDP2017</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_tot2017].isnull()), var_city2016].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13</code></pre>
</div>
</div>
<section id="since-2-cities-university-city-hermosa-beach-do-not-exist-in-cdp2017-look-at-remaining-13-cities." class="level4">
<h4 class="anchored" data-anchor-id="since-2-cities-university-city-hermosa-beach-do-not-exist-in-cdp2017-look-at-remaining-13-cities.">Since 2 cities (University City, Hermosa Beach) do not exist in CDP2017, look at remaining 13 cities.</h4>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check Case 1a first (TOT = s1 OR s2, both scopes exist). If it passes, </span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">#TOT can be fixed and the rest of the checks can be made.</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>df_venn.loc[( </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    currentCondition <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_tot2017].isnull())</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (fn_case1a(df_venn, var_s1_2017, var_s2_2017, var_tot2017) ) </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>), [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017,var_incScopes,<span class="st">'CDP2016 data edited'</span>]]    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>61</th>
      <td>Lahti</td>
      <td>685460.0</td>
      <td>922120.0</td>
      <td>123680.0</td>
      <td>717200.0</td>
      <td>717200.0</td>
      <td>157607.0</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Only Lahti satisfies Case 1a check, therefore Lahti TOT can be recalculated by summing scopes.</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> ( (<span class="op">~</span>df_venn.loc[(df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Lahti'</span>)) </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                   <span class="op">&amp;</span> (df_venn[var_incScopes]<span class="op">==</span>str_scopesTwo)].isnull(), var_city2016) ):</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    df_venn.loc[df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Lahti'</span>), [var_tot2017]] <span class="op">=</span> df_venn[[var_s1_2017, var_s2_2017]].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    df_venn.loc[df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Lahti'</span>), var_sf2017] <span class="op">=</span> (df_venn[var_s1_2017] <span class="op">+</span> df_venn[var_s2_2017])<span class="op">/</span>df_venn[var_tot2017]</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Lahti'</span>),[var_city2016, var_sf2016, var_sf2017,var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017,var_incScopes,<span class="st">'CDP2016 data edited'</span>]]    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>61</th>
      <td>Lahti</td>
      <td>1.525691</td>
      <td>1.0</td>
      <td>685460.0</td>
      <td>922120.0</td>
      <td>123680.0</td>
      <td>874807.0</td>
      <td>717200.0</td>
      <td>157607.0</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Next, find other CDP2017 cities that do not satisfy the intolerable cases--these are more replacement candidates.</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Case 1</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#b) TOT = s1 OR s2, only one of the scopes exists  .................fn_case1b</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 3. TOT != s1 + s2</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co">#a) TOT &lt;&lt; or &gt;&gt; s1 + s2 (OUTSIDE FORGIVENESS RANGE)   .............fn_case3a_intolerable</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co">#b) TOT &lt; s1 (NO FORGIVENESS).......................................fn_case3b_intolerable</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co">#b) TOT &lt; s2 (NO FORGIVENESS).......................................fn_case3b_intolerable</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Case 4</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co">#b) both s1 and s2 are missing  ....................................fn_case4b</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>df_venn.loc[( </span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>    currentCondition <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_tot2017].isnull()) <span class="op">&amp;</span> (df_venn[<span class="st">'CDP2016 data edited'</span>].isnull())</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case1b(df_venn, var_s1_2017, var_s2_2017, var_tot2017) )</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3a_intolerable(df_venn, var_s1_2017, var_s2_2017, var_tot2017, var_sf2017))</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3b_intolerable(df_venn, var_s1_2017, var_tot2017))</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3b_intolerable(df_venn, var_s2_2017, var_tot2017))</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case4b(df_venn, var_s1_2017, var_s2_2017))</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>), [var_city2016, var_sf2016, var_sf2017,var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017,var_incScopes,<span class="st">'CDP2016 data edited'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>124</th>
      <td>Pingtung</td>
      <td>11162.499957</td>
      <td>1.0</td>
      <td>4604805.00</td>
      <td>3.704683e+10</td>
      <td>1.435430e+10</td>
      <td>4.969247e+06</td>
      <td>2768427.40</td>
      <td>2200856.14</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Lahti</td>
      <td>1.525691</td>
      <td>1.0</td>
      <td>685460.00</td>
      <td>9.221200e+05</td>
      <td>1.236800e+05</td>
      <td>8.748070e+05</td>
      <td>717200.00</td>
      <td>157607.00</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Ljubljana</td>
      <td>1.314504</td>
      <td>1.0</td>
      <td>2079758.00</td>
      <td>1.829808e+06</td>
      <td>9.040420e+05</td>
      <td>2.733850e+06</td>
      <td>1829808.00</td>
      <td>904042.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Santa Monica</td>
      <td>0.770811</td>
      <td>1.0</td>
      <td>705443.00</td>
      <td>3.025100e+05</td>
      <td>2.412530e+05</td>
      <td>3.345910e+05</td>
      <td>119026.00</td>
      <td>215565.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>166</th>
      <td>New York City</td>
      <td>0.767116</td>
      <td>1.0</td>
      <td>49385508.00</td>
      <td>2.099562e+07</td>
      <td>1.688877e+07</td>
      <td>5.330601e+07</td>
      <td>38962264.00</td>
      <td>14343743.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>141</th>
      <td>Albany</td>
      <td>0.758159</td>
      <td>1.0</td>
      <td>1217091.00</td>
      <td>3.696540e+05</td>
      <td>5.530940e+05</td>
      <td>1.217091e+06</td>
      <td>663997.00</td>
      <td>553094.00</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Wellington</td>
      <td>0.730852</td>
      <td>1.0</td>
      <td>1084979.00</td>
      <td>6.211790e+05</td>
      <td>1.717800e+05</td>
      <td>7.929590e+05</td>
      <td>621179.00</td>
      <td>171780.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>117</th>
      <td>Indianapolis</td>
      <td>0.699410</td>
      <td>1.0</td>
      <td>2160364.98</td>
      <td>7.677036e+04</td>
      <td>1.434210e+06</td>
      <td>2.160365e+06</td>
      <td>726155.11</td>
      <td>1434209.86</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>158</th>
      <td>Lancaster, PA</td>
      <td>0.689955</td>
      <td>1.0</td>
      <td>365763.00</td>
      <td>3.791800e+04</td>
      <td>2.144420e+05</td>
      <td>5.786250e+05</td>
      <td>364183.00</td>
      <td>214442.00</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Savannah</td>
      <td>0.673582</td>
      <td>1.0</td>
      <td>3609546.00</td>
      <td>1.203108e+06</td>
      <td>1.228219e+06</td>
      <td>3.609546e+06</td>
      <td>2381327.00</td>
      <td>1228219.00</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Gladsaxe Kommune</td>
      <td>0.619811</td>
      <td>1.0</td>
      <td>362078.00</td>
      <td>9.924000e+03</td>
      <td>2.144960e+05</td>
      <td>3.312830e+05</td>
      <td>247599.00</td>
      <td>83684.00</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>107</th>
      <td>Taoyuan</td>
      <td>0.571668</td>
      <td>1.0</td>
      <td>30073752.26</td>
      <td>2.686287e+06</td>
      <td>1.450592e+07</td>
      <td>3.576453e+07</td>
      <td>21143194.60</td>
      <td>14621331.42</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>167</th>
      <td>Oakland</td>
      <td>0.346268</td>
      <td>1.0</td>
      <td>2733664.00</td>
      <td>5.785600e+05</td>
      <td>3.680190e+05</td>
      <td>1.745827e+06</td>
      <td>956414.00</td>
      <td>789413.00</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; These 13 cities in CDP2017 can be used as is to replace CDP2016</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Save city names as string array</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>replaceCities <span class="op">=</span> df_venn.loc[( </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    currentCondition <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_tot2017].isnull()) <span class="op">&amp;</span> (df_venn[<span class="st">'CDP2016 data edited'</span>].isnull())</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case1b(df_venn, var_s1_2017, var_s2_2017, var_tot2017) )</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3a_intolerable(df_venn, var_s1_2017, var_s2_2017, var_tot2017, var_sf2017))</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3b_intolerable(df_venn, var_s1_2017, var_tot2017))</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3b_intolerable(df_venn, var_s2_2017, var_tot2017))</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case4b(df_venn, var_s1_2017, var_s2_2017))</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>), var_city2016].values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="bu">len</span>(replaceCities)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>replaceCities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>array(['Pingtung ', 'Lahti', 'Ljubljana', 'Santa Monica', 'New York City',
       'Albany', 'Wellington', 'Indianapolis', 'Lancaster, PA',
       'Savannah', 'Gladsaxe Kommune', 'Taoyuan ', 'Oakland'],
      dtype=object)</code></pre>
</div>
</div>
</section>
</section>
<section id="action-for-case-3a-1" class="level3">
<h3 class="anchored" data-anchor-id="action-for-case-3a-1">Action for Case 3a</h3>
<ul>
<li>Replace 1 city (Lahti) by CDP2017 values</li>
</ul>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace CDP2016 values for Lahti with CDP2017.</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>replaceReason <span class="op">=</span> (</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">' TOT &lt;&lt; s1+s2 (Case 3a) in CDP2016. Soln: Derive TOT (CDP2017) from s1 (CDP2017) and s2 (CDP2017) then'</span> \</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">' replace CDP2016 values by CDP2017'</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>fn_replace2016(</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    df_venn, df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Lahti'</span>), replaceReason, list2016, list2017</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Lahti'</span>), </span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>            [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_sf2017,var_tot2017, </span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>             var_s1_2017, var_s2_2017,<span class="st">'CDP2016 data edited'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>61</th>
      <td>Lahti</td>
      <td>874807.0</td>
      <td>717200.0</td>
      <td>157607.0</td>
      <td>1.0</td>
      <td>874807.0</td>
      <td>717200.0</td>
      <td>157607.0</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &lt;&lt; s1+s2 (Case 3a) in CDP2016. Soln: Derive TOT (CDP2017) from s1 (CDP2017) and s2 (CDP2017) then replace CDP2016 values by CDP2017</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ul>
<li>Replace remaining cities by CDP2017 values</li>
</ul>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>replaceReason <span class="op">=</span> (</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">' TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data'</span> \</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">' (no edits required).'</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cname <span class="kw">in</span> replaceCities:</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cname <span class="op">!=</span> <span class="st">'Lahti'</span>:</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>        fn_replace2016(</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>            df_venn, df_venn[var_city2016].<span class="bu">str</span>.contains(cname), replaceReason, list2016, list2017</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Lahti'</span>), </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>            [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_sf2017,var_tot2017, </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>             var_s1_2017, var_s2_2017,<span class="st">'CDP2016 data edited'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>61</th>
      <td>Lahti</td>
      <td>874807.0</td>
      <td>717200.0</td>
      <td>157607.0</td>
      <td>1.0</td>
      <td>874807.0</td>
      <td>717200.0</td>
      <td>157607.0</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &lt;&lt; s1+s2 (Case 3a) in CDP2016. Soln: Derive TOT (CDP2017) from s1 (CDP2017) and s2 (CDP2017) then replace CDP2016 values by CDP2017</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[( </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    currentCondition <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_tot2017].isnull()) <span class="op">&amp;</span> (df_venn[<span class="st">'CDP2016 data edited'</span>].isnull())</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case1b(df_venn, var_s1_2017, var_s2_2017, var_tot2017) )</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3a_intolerable(df_venn, var_s1_2017, var_s2_2017, var_tot2017, var_sf2017))</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3b_intolerable(df_venn, var_s1_2017, var_tot2017))</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3b_intolerable(df_venn, var_s2_2017, var_tot2017))</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case4b(df_venn, var_s1_2017, var_s2_2017))</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>), [var_city2016, var_sf2016, var_sf2017,var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017,var_incScopes,<span class="st">'CDP2016 data edited'</span>]]</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; CDP2016 data successfully replaced</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="conclusion-for-case-3a" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-for-case-3a">Conclusion for Case 3a</h3>
<p>Of the 13 cities that pass Case 3a check:<br>
* all exist in CDP2017 and pass the tolerance checks</p>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[(</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    currentCondition </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> <span class="op">~</span>df_venn[var_city2016].isin(replaceCities)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>), var_city2016]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>Series([], Name: City Short Name (CDP2016), dtype: object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The 13 cities that were replaced by CDP2017 get an EQF depending on how many emissions values exist in CDP2017 </span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].isin(replaceCities), [var_city2016, var_tot2016, var_s1_2016, var_s2_2016]]</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Lahti = EQF A because TOT could be recalculated by summing the scopes</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co">#All the other cities required no editing, so they are EQF A also</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>124</th>
      <td>Pingtung</td>
      <td>4.969247e+06</td>
      <td>2768427.40</td>
      <td>2200856.14</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Lahti</td>
      <td>8.748070e+05</td>
      <td>717200.00</td>
      <td>157607.00</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Ljubljana</td>
      <td>2.733850e+06</td>
      <td>1829808.00</td>
      <td>904042.00</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Santa Monica</td>
      <td>3.345910e+05</td>
      <td>119026.00</td>
      <td>215565.00</td>
    </tr>
    <tr>
      <th>166</th>
      <td>New York City</td>
      <td>5.330601e+07</td>
      <td>38962264.00</td>
      <td>14343743.00</td>
    </tr>
    <tr>
      <th>141</th>
      <td>Albany</td>
      <td>1.217091e+06</td>
      <td>663997.00</td>
      <td>553094.00</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Wellington</td>
      <td>7.929590e+05</td>
      <td>621179.00</td>
      <td>171780.00</td>
    </tr>
    <tr>
      <th>117</th>
      <td>Indianapolis</td>
      <td>2.160365e+06</td>
      <td>726155.11</td>
      <td>1434209.86</td>
    </tr>
    <tr>
      <th>158</th>
      <td>Lancaster, PA</td>
      <td>5.786250e+05</td>
      <td>364183.00</td>
      <td>214442.00</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Savannah</td>
      <td>3.609546e+06</td>
      <td>2381327.00</td>
      <td>1228219.00</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Gladsaxe Kommune</td>
      <td>3.312830e+05</td>
      <td>247599.00</td>
      <td>83684.00</td>
    </tr>
    <tr>
      <th>107</th>
      <td>Taoyuan</td>
      <td>3.576453e+07</td>
      <td>21143194.60</td>
      <td>14621331.42</td>
    </tr>
    <tr>
      <th>167</th>
      <td>Oakland</td>
      <td>1.745827e+06</td>
      <td>956414.00</td>
      <td>789413.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>replaceCities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>array(['Pingtung ', 'Lahti', 'Ljubljana', 'Santa Monica', 'New York City',
       'Albany', 'Wellington', 'Indianapolis', 'Lancaster, PA',
       'Savannah', 'Gladsaxe Kommune', 'Taoyuan ', 'Oakland'],
      dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].isin(replaceCities),<span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].isin(replaceCities), [var_city2016, <span class="st">'Emissions Quality Flag'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>124</th>
      <td>Pingtung</td>
      <td>A</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Lahti</td>
      <td>A</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Ljubljana</td>
      <td>A</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Santa Monica</td>
      <td>A</td>
    </tr>
    <tr>
      <th>166</th>
      <td>New York City</td>
      <td>A</td>
    </tr>
    <tr>
      <th>141</th>
      <td>Albany</td>
      <td>A</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Wellington</td>
      <td>A</td>
    </tr>
    <tr>
      <th>117</th>
      <td>Indianapolis</td>
      <td>A</td>
    </tr>
    <tr>
      <th>158</th>
      <td>Lancaster, PA</td>
      <td>A</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Savannah</td>
      <td>A</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Gladsaxe Kommune</td>
      <td>A</td>
    </tr>
    <tr>
      <th>107</th>
      <td>Taoyuan</td>
      <td>A</td>
    </tr>
    <tr>
      <th>167</th>
      <td>Oakland</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016].isin(replaceCities), [var_city2016, <span class="st">'CDP2016 data edited'</span>, var_incScopes]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>CDP2016 data edited</th>
      <th>Scopes Included (CDP2017)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>124</th>
      <td>Pingtung</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Lahti</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &lt;&lt; s1+s2 (Case 3a) in CDP2016. Soln: Derive TOT (CDP2017) from s1 (CDP2017) and s2 (CDP2017) then replace CDP2016 values by CDP2017</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Ljubljana</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Santa Monica</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
    </tr>
    <tr>
      <th>166</th>
      <td>New York City</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
    </tr>
    <tr>
      <th>141</th>
      <td>Albany</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Wellington</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
    </tr>
    <tr>
      <th>117</th>
      <td>Indianapolis</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
    <tr>
      <th>158</th>
      <td>Lancaster, PA</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Savannah</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Gladsaxe Kommune</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
    <tr>
      <th>107</th>
      <td>Taoyuan</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
    <tr>
      <th>167</th>
      <td>Oakland</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>Total Scope 1 and Scope 2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="case-3b.-intolerable-tot-s1-or-s2-no-forgiveness" class="level3">
<h3 class="anchored" data-anchor-id="case-3b.-intolerable-tot-s1-or-s2-no-forgiveness">Case 3b. INTOLERABLE, TOT &lt; s1 OR s2 (NO FORGIVENESS)</h3>
<p>Exclude cities that have already been edited.</p>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TOT &lt; s1</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>currentCondition <span class="op">=</span> fn_case3b_intolerable(df_venn, var_s1_2016, var_tot2016)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition, var_city2016].count()</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017, var_sf2016, var_sf2017, var_incScopes, <span class="st">'CDP2016 data edited'</span>] ].head(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="81">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="case-4a.-s2-missing-s1-exists." class="level3">
<h3 class="anchored" data-anchor-id="case-4a.-s2-missing-s1-exists.">Case 4a. s2 missing, s1 exists.</h3>
<p>Exclude cities that have already been edited.</p>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>currentCondition <span class="op">=</span> fn_case4a_fixable(df_venn, var_s2_2016, var_s1_2016)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition <span class="op">&amp;</span> </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>                  (df_venn[<span class="st">'CDP2016 data edited'</span>].isnull() <span class="op">&amp;</span> </span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>                  (df_venn[<span class="st">'Emissions Quality Flag'</span>].isnull())</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>                  ), var_city2016].count()</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition <span class="op">&amp;</span> (df_venn[<span class="st">'CDP2016 data edited'</span>].isnull()), [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017, var_sf2016, var_sf2017, var_incScopes, <span class="st">'CDP2016 data edited'</span>] ].head(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="82">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>Ajax, ON</td>
      <td>538836.0</td>
      <td>6354.0</td>
      <td>NaN</td>
      <td>1234211.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="action-for-case-4a.-s2-missing-s1-exists." class="level3">
<h3 class="anchored" data-anchor-id="action-for-case-4a.-s2-missing-s1-exists.">Action for Case 4a. s2 missing, s1 exists.</h3>
<p>Leave as is. Assign Grade Emissions Quality Flag C.</p>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Assign Emissions Quality Flag</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co">#The 3 cities get EFQ C because one of the emissions had to be derived from the other 2</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'C'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, <span class="st">'Emissions Quality Flag'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>Ajax, ON</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="case-4b-s1-missing-s2-exists." class="level3">
<h3 class="anchored" data-anchor-id="case-4b-s1-missing-s2-exists.">Case 4b s1 missing, s2 exists.</h3>
<p>Exclude cities that have already been edited.</p>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>currentCondition <span class="op">=</span> fn_case4a_fixable(df_venn, var_s1_2016, var_s2_2016)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition, var_city2016].count()</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition, var_city2016].values</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017, var_sf2016, var_sf2017, var_incScopes, <span class="st">'CDP2016 data edited'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6
['Amsterdam' 'Manchester' 'Detroit' 'Los Angeles' 'New Orleans' 'Seattle']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="85">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>93</th>
      <td>Amsterdam</td>
      <td>4471000.0</td>
      <td>NaN</td>
      <td>2310000.0</td>
      <td>4138000.0</td>
      <td>NaN</td>
      <td>2460000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>138</th>
      <td>Manchester</td>
      <td>14889318.0</td>
      <td>NaN</td>
      <td>5302028.0</td>
      <td>17325654.0</td>
      <td>10630853.0</td>
      <td>6694801.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>150</th>
      <td>Detroit</td>
      <td>10329322.0</td>
      <td>NaN</td>
      <td>4809082.0</td>
      <td>10329322.0</td>
      <td>5520240.0</td>
      <td>4809082.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>161</th>
      <td>Los Angeles</td>
      <td>29024807.0</td>
      <td>NaN</td>
      <td>9429688.0</td>
      <td>29442557.0</td>
      <td>19936349.0</td>
      <td>9506208.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>165</th>
      <td>New Orleans</td>
      <td>4558575.0</td>
      <td>NaN</td>
      <td>2138684.0</td>
      <td>4660930.0</td>
      <td>3519969.0</td>
      <td>1140961.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>179</th>
      <td>Seattle</td>
      <td>5222000.0</td>
      <td>NaN</td>
      <td>72000.0</td>
      <td>3471000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="action-for-case-4a.-s1-missing-s2-exists." class="level3">
<h3 class="anchored" data-anchor-id="action-for-case-4a.-s1-missing-s2-exists.">Action for Case 4a. s1 missing, s2 exists.</h3>
<p>For the 6 cities that pass this check:<br>
* derive s1 from TOT - s2</p>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, var_s1_2016] <span class="op">=</span> df_venn[var_tot2016] <span class="op">-</span> df_venn[var_s2_2016]</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, var_sf2016] <span class="op">=</span> <span class="fl">1.00</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, <span class="st">'CDP2016 data edited'</span>] <span class="op">=</span> (</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'S1 derived from TOT - S2 in CDP2016 dataset'</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[<span class="st">'CDP2016 data edited'</span>]<span class="op">==</span><span class="st">'S1 derived from TOT - S2 in CDP2016 dataset'</span>, [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_sf2016, <span class="st">'CDP2016 data edited'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>93</th>
      <td>Amsterdam</td>
      <td>4471000.0</td>
      <td>2161000.0</td>
      <td>2310000.0</td>
      <td>1.0</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
    </tr>
    <tr>
      <th>138</th>
      <td>Manchester</td>
      <td>14889318.0</td>
      <td>9587290.0</td>
      <td>5302028.0</td>
      <td>1.0</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
    </tr>
    <tr>
      <th>150</th>
      <td>Detroit</td>
      <td>10329322.0</td>
      <td>5520240.0</td>
      <td>4809082.0</td>
      <td>1.0</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
    </tr>
    <tr>
      <th>161</th>
      <td>Los Angeles</td>
      <td>29024807.0</td>
      <td>19595119.0</td>
      <td>9429688.0</td>
      <td>1.0</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
    </tr>
    <tr>
      <th>165</th>
      <td>New Orleans</td>
      <td>4558575.0</td>
      <td>2419891.0</td>
      <td>2138684.0</td>
      <td>1.0</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
    </tr>
    <tr>
      <th>179</th>
      <td>Seattle</td>
      <td>5222000.0</td>
      <td>5150000.0</td>
      <td>72000.0</td>
      <td>1.0</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="conclusion-for-case-4a-s1-missing-s2-exists" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-for-case-4a-s1-missing-s2-exists">Conclusion for Case 4a (s1 missing, s2 exists)</h3>
<p>Of the 6 cities that pass Case 4a check:<br>
* missing s1 was derived from TOT - s2 in CDP2016 dataset for all</p>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Assign Emissions Quality Flag</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co">#The 3 cities get EFQ C because one of the emissions had to be derived from the other 2</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>df_venn.loc[(</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    df_venn[<span class="st">'CDP2016 data edited'</span>]<span class="op">==</span><span class="st">'S1 derived from TOT - S2 in CDP2016 dataset'</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>), <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'C'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[(</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>    df_venn[<span class="st">'CDP2016 data edited'</span>]<span class="op">==</span><span class="st">'S1 derived from TOT - S2 in CDP2016 dataset'</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>), [var_city2016, <span class="st">'Emissions Quality Flag'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>93</th>
      <td>Amsterdam</td>
      <td>C</td>
    </tr>
    <tr>
      <th>138</th>
      <td>Manchester</td>
      <td>C</td>
    </tr>
    <tr>
      <th>150</th>
      <td>Detroit</td>
      <td>C</td>
    </tr>
    <tr>
      <th>161</th>
      <td>Los Angeles</td>
      <td>C</td>
    </tr>
    <tr>
      <th>165</th>
      <td>New Orleans</td>
      <td>C</td>
    </tr>
    <tr>
      <th>179</th>
      <td>Seattle</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="case-4b.-both-s1-and-s2-missing-eqf-d" class="level3">
<h3 class="anchored" data-anchor-id="case-4b.-both-s1-and-s2-missing-eqf-d">Case 4b. both s1 and s2 missing (EQF D)</h3>
<p>Exclude cities that have already been edited.</p>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>currentCondition <span class="op">=</span> fn_case4b(df_venn, var_s1_2016, var_s2_2016)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition, var_city2016].count()</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition, var_city2016].values</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition, [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017, var_sf2016, var_sf2017, var_incScopes, <span class="st">'CDP2016 data edited'</span>] ].head(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>45
['Lake Forest, IL' 'Santiago de Cali' 'Hiroshima' 'Aarhus Kommune'
 'City of \xc3\x86r\xc3\xb8sk\xc3\xb8bing' "Nice C\xc3\xb4te d'Azur"
 'Brisbane, CA' 'Landeshauptstadt Magdeburg' 'Roanoke' 'Bornova '
 'Stadt Heidelberg' 'Goi\xc3\xa2nia' 'Bologna' 'Porto Alegre' 'Recife'
 'Hamburg' 'North Vancouver' 'Peterborough' 'Copenhagen'
 'Communaut\xc3\xa9 urbaine du Grand Nancy' 'Hong Kong' 'Jakarta '
 'Dublin' 'Ferrara' 'Genova' 'Torino' 'Piacenza' 'Roma ' '\xc3\x81gueda'
 'Porto' 'Torres Vedras ' 'Stockholm' 'Basel-Stadt' 'Stadt Z\xc3\xbcrich'
 'Birmingham' 'Cardiff' 'Leicester' 'Aspen and Pitkin County' 'Baltimore'
 'San Diego' 'Benicia' 'Blacksburg' 'Chicago' 'West Hollywood' 'Reno']</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="90">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Lake Forest, IL</td>
      <td>402364.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>402364.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Santiago de Cali</td>
      <td>4174608.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4174608.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Hiroshima</td>
      <td>8675437.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Aarhus Kommune</td>
      <td>1900.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1600000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="action-for-case-4b" class="level3">
<h3 class="anchored" data-anchor-id="action-for-case-4b">Action for Case 4b</h3>
<ul>
<li>See if CDP2017 has useable values*.</li>
</ul>
<p><sup>*</sup>When evaluating CDP2017 values, they must pass all the above checks, plus additional checks if Waste Scope 3: s3 cannot be &gt; 15% than the total emissions; s3 != s1 OR s2; s3 &lt;&lt; s1 + s2…</p>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cities that are in CDP2017</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[currentCondition <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_tot2017].isnull()), var_city2016].count()</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>df_venn.loc[currentCondition <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_tot2017].isnull()), var_city2016].values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>31</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>array(['Lake Forest, IL', 'Santiago de Cali', 'Aarhus Kommune',
       'City of \xc3\x86r\xc3\xb8sk\xc3\xb8bing', 'Brisbane, CA',
       'Landeshauptstadt Magdeburg', 'Roanoke', 'Stadt Heidelberg',
       'Goi\xc3\xa2nia', 'Recife', 'Hamburg', 'North Vancouver',
       'Copenhagen', 'Communaut\xc3\xa9 urbaine du Grand Nancy',
       'Hong Kong', 'Jakarta ', 'Genova', 'Torino', 'Porto',
       'Torres Vedras ', 'Stockholm', 'Basel-Stadt',
       'Stadt Z\xc3\xbcrich', 'Cardiff', 'Aspen and Pitkin County',
       'Baltimore', 'Benicia', 'Blacksburg', 'Chicago', 'West Hollywood',
       'Reno'], dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check Case 1a first (TOT = s1 OR s2, both scopes exist). If it passes, </span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="co">#TOT can be fixed and the rest of the checks can be made.</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>df_venn.loc[( </span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    currentCondition <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_tot2017].isnull())</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (fn_case1a(df_venn, var_s1_2017, var_s2_2017, var_tot2017) ) </span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>), [var_city2016, var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017,var_incScopes,<span class="st">'CDP2016 data edited'</span>]]    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find CDP2017 cities that do not satisfy the intolerable cases--these are replacement candidates.</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Case 1</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co">#b) TOT = s1 OR s2, only one of the scopes exists  .................fn_case1b</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 2. TOT != s1 + s2</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="co">#b) INTOLERABLE (OUTSIDE FORGIVENESS RANGE)   ......................fn_case3a_intolerable</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="co">#c) TOT &lt; s1 (NO FORGIVENESS).......................................fn_case3b_intolerable</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="co">#d) TOT &lt; s2 (NO FORGIVENESS).......................................fn_case3b_intolerable</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Case 3</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="co">#c) both s1 and s2 are missing  ....................................fn_case4b</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>df_venn.loc[( </span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    currentCondition <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_tot2017].isnull())</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case1b(df_venn, var_s1_2017, var_s2_2017, var_tot2017) )</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3a_intolerable(df_venn, var_s1_2017, var_s2_2017, var_tot2017, var_sf2017))</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3b_intolerable(df_venn, var_s1_2017, var_tot2017))</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3b_intolerable(df_venn, var_s2_2017, var_tot2017))</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case4b(df_venn, var_s1_2017, var_s2_2017))</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>), [var_city2016, var_sf2016, var_sf2017,var_tot2016, var_s1_2016, var_s2_2016, var_tot2017, var_s1_2017, var_s2_2017,var_incScopes,<span class="st">'CDP2016 data edited'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2017)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Recife</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1883.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1705245.00</td>
      <td>1333830.00</td>
      <td>371415.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>51</th>
      <td>North Vancouver</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>196840.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>187055.00</td>
      <td>182896.00</td>
      <td>4159.00</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Hong Kong</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>42700000.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>44900000.00</td>
      <td>44876460.00</td>
      <td>NaN</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>118</th>
      <td>Stockholm</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>2511000.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2693442.00</td>
      <td>1834343.00</td>
      <td>859099.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>119</th>
      <td>Basel-Stadt</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>885878.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1105753.00</td>
      <td>783932.00</td>
      <td>321821.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>146</th>
      <td>Baltimore</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>7579144.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7230497.00</td>
      <td>4019044.00</td>
      <td>3211447.00</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>149</th>
      <td>Blacksburg</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>383747.15</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>347483.42</td>
      <td>124461.79</td>
      <td>223021.63</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Chicago</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>33500000.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>29918694.00</td>
      <td>16951471.00</td>
      <td>12967223.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>174</th>
      <td>Reno</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>4437665.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2551639.00</td>
      <td>1371400.00</td>
      <td>1180239.00</td>
      <td>Total Scope 1, Scope 2 and Waste Scope 3 (Total BASIC emissions)</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="out-of-30-cdp2017-pass-the-tolerance-checks" class="level4">
<h4 class="anchored" data-anchor-id="out-of-30-cdp2017-pass-the-tolerance-checks">9 out of 30 CDP2017 pass the tolerance checks</h4>
<p>=&gt; 8 cities can be directly replaced<br>
=&gt; 1 city (Hong Kong) is missing s2; leave as is</p>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>replaceCities <span class="op">=</span> df_venn.loc[( </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    currentCondition <span class="op">&amp;</span> (<span class="op">~</span>df_venn[var_tot2017].isnull())</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case1b(df_venn, var_s1_2017, var_s2_2017, var_tot2017) )</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3a_intolerable(df_venn, var_s1_2017, var_s2_2017, var_tot2017, var_sf2017))</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3b_intolerable(df_venn, var_s1_2017, var_tot2017))</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case3b_intolerable(df_venn, var_s2_2017, var_tot2017))</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (<span class="op">~</span>fn_case4b(df_venn, var_s1_2017, var_s2_2017))</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>), <span class="st">'City Short Name (CDP2016)'</span>]</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'Number of cities to replace with CDP2017: '</span> <span class="op">+</span> <span class="bu">repr</span>(<span class="bu">len</span>(replaceCities))</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> replaceCities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of cities to replace with CDP2017: 9
36     Recife         
51     North Vancouver
65     Hong Kong      
118    Stockholm      
119    Basel-Stadt    
146    Baltimore      
149    Blacksburg     
154    Chicago        
174    Reno           
Name: City Short Name (CDP2016), dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace CDP2016 values with CDP2017.</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>replaceReason <span class="op">=</span> (</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain'</span> \</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">' at least one scope'</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cname <span class="kw">in</span> replaceCities:</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>    fn_replace2016(</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>        df_venn, df_venn[var_city2016].<span class="bu">str</span>.contains(cname), replaceReason, list2016, list2017</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="conclusion-for-case-4b" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-for-case-4b">Conclusion for Case 4b</h3>
<p>Of the 44 cities that pass this check:<br>
* 30 exist in CDP2017 =&gt; of these, 9 pass the tolerance checks</p>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[(</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">~</span>df_venn[<span class="st">'CDP2016 data edited'</span>].isnull()</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> df_venn[<span class="st">'CDP2016 data edited'</span>].<span class="bu">str</span>.contains(<span class="st">'Both scopes missing'</span>)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>), [var_city2016, <span class="st">'CDP2016 data edited'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>CDP2016 data edited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Recife</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
    </tr>
    <tr>
      <th>51</th>
      <td>North Vancouver</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Hong Kong</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
    </tr>
    <tr>
      <th>118</th>
      <td>Stockholm</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
    </tr>
    <tr>
      <th>119</th>
      <td>Basel-Stadt</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
    </tr>
    <tr>
      <th>146</th>
      <td>Baltimore</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
    </tr>
    <tr>
      <th>149</th>
      <td>Blacksburg</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Chicago</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
    </tr>
    <tr>
      <th>174</th>
      <td>Reno</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Assign Emissions Quality Flag</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[(</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    currentCondition</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span>  (df_venn[var_tot2017].isnull())</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>), var_city2016].count()</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>df_venn.loc[(</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    currentCondition</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span>  (df_venn[var_tot2017].isnull())</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>),  <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'D'</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>df_venn.loc[(</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>    currentCondition</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span>  (df_venn[var_tot2017].isnull())</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>),  [var_city2016, <span class="st">'Emissions Quality Flag'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>14</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="97">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>Hiroshima</td>
      <td>D</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Nice Côte d'Azur</td>
      <td>D</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Bornova</td>
      <td>D</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Bologna</td>
      <td>D</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Porto Alegre</td>
      <td>D</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Peterborough</td>
      <td>D</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Dublin</td>
      <td>D</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Ferrara</td>
      <td>D</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Piacenza</td>
      <td>D</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Roma</td>
      <td>D</td>
    </tr>
    <tr>
      <th>103</th>
      <td>Águeda</td>
      <td>D</td>
    </tr>
    <tr>
      <th>127</th>
      <td>Birmingham</td>
      <td>D</td>
    </tr>
    <tr>
      <th>131</th>
      <td>Leicester</td>
      <td>D</td>
    </tr>
    <tr>
      <th>147</th>
      <td>San Diego</td>
      <td>D</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[(</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    currentCondition</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> df_venn[<span class="st">'CDP2016 data edited'</span>].isnull()</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span>  (<span class="op">~</span>df_venn[var_tot2017].isnull())</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>), var_city2016].count()</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>df_venn.loc[(</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>    currentCondition</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> df_venn[<span class="st">'CDP2016 data edited'</span>].isnull()</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span>  (<span class="op">~</span>df_venn[var_tot2017].isnull())</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>), <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'D'</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>df_venn.loc[(</span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>    currentCondition</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> df_venn[<span class="st">'CDP2016 data edited'</span>].isnull()</span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span>  (<span class="op">~</span>df_venn[var_tot2017].isnull())  </span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a>), [var_city2016, <span class="st">'Emissions Quality Flag'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>22</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="98">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Lake Forest, IL</td>
      <td>D</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Santiago de Cali</td>
      <td>D</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Aarhus Kommune</td>
      <td>D</td>
    </tr>
    <tr>
      <th>13</th>
      <td>City of Ærøskøbing</td>
      <td>D</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Brisbane, CA</td>
      <td>D</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Landeshauptstadt Magdeburg</td>
      <td>D</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Roanoke</td>
      <td>D</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Stadt Heidelberg</td>
      <td>D</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Goiânia</td>
      <td>D</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Hamburg</td>
      <td>D</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Copenhagen</td>
      <td>D</td>
    </tr>
    <tr>
      <th>64</th>
      <td>Communauté urbaine du Grand Nancy</td>
      <td>D</td>
    </tr>
    <tr>
      <th>68</th>
      <td>Jakarta</td>
      <td>D</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Genova</td>
      <td>D</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Torino</td>
      <td>D</td>
    </tr>
    <tr>
      <th>109</th>
      <td>Porto</td>
      <td>D</td>
    </tr>
    <tr>
      <th>111</th>
      <td>Torres Vedras</td>
      <td>D</td>
    </tr>
    <tr>
      <th>121</th>
      <td>Stadt Zürich</td>
      <td>D</td>
    </tr>
    <tr>
      <th>130</th>
      <td>Cardiff</td>
      <td>D</td>
    </tr>
    <tr>
      <th>132</th>
      <td>Aspen and Pitkin County</td>
      <td>D</td>
    </tr>
    <tr>
      <th>148</th>
      <td>Benicia</td>
      <td>D</td>
    </tr>
    <tr>
      <th>171</th>
      <td>West Hollywood</td>
      <td>D</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="99">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lastly, look at the 9 CDP2017 cities that replaced CDP2016 to see what Quality Flag they should get</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 8 cities could be used directly =&gt; EQF A</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>df_venn.loc[(</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    (currentCondition <span class="op">&amp;</span> df_venn[var_sf2016] <span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>), <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'A'</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>df_venn.loc[(</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>   (currentCondition <span class="op">&amp;</span> df_venn[var_sf2016] <span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>), [var_city2016, <span class="st">'Emissions Quality Flag'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Recife</td>
      <td>A</td>
    </tr>
    <tr>
      <th>51</th>
      <td>North Vancouver</td>
      <td>A</td>
    </tr>
    <tr>
      <th>118</th>
      <td>Stockholm</td>
      <td>A</td>
    </tr>
    <tr>
      <th>119</th>
      <td>Basel-Stadt</td>
      <td>A</td>
    </tr>
    <tr>
      <th>146</th>
      <td>Baltimore</td>
      <td>A</td>
    </tr>
    <tr>
      <th>149</th>
      <td>Blacksburg</td>
      <td>A</td>
    </tr>
    <tr>
      <th>154</th>
      <td>Chicago</td>
      <td>A</td>
    </tr>
    <tr>
      <th>174</th>
      <td>Reno</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Hong Kong</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>df_venn.loc[( </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">~</span>df_venn[<span class="st">'CDP2016 data edited'</span>].isnull()</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> df_venn[<span class="st">'CDP2016 data edited'</span>].<span class="bu">str</span>.contains(<span class="st">'Both scopes missing'</span>)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>     <span class="op">&amp;</span> df_venn[var_sf2016].isnull()</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>), <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'C'</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>df_venn.loc[( </span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">~</span>df_venn[<span class="st">'CDP2016 data edited'</span>].isnull()</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> df_venn[<span class="st">'CDP2016 data edited'</span>].<span class="bu">str</span>.contains(<span class="st">'Both scopes missing'</span>)</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>     <span class="op">&amp;</span> df_venn[var_sf2016].isnull()</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>), [var_city2016, <span class="st">'Emissions Quality Flag'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>65</th>
      <td>Hong Kong</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>replaceReason <span class="op">=</span> (</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'CDP2016 Scope1 includes power plant emissions. Action: Use CDP2017 (TOT and S1 values available only).'</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>fn_replace2016(</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    df_venn, df_venn[var_city2016].<span class="bu">str</span>.contains(<span class="st">'Rotterdam'</span>), replaceReason, list2016, list2017</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Account Number</th>
      <th>City Name (CDP2016)</th>
      <th>Country (CDP2016)</th>
      <th>City Short Name (CDP2016)</th>
      <th>C40 (CDP2016)</th>
      <th>Reporting Year (CDP2016)</th>
      <th>Measurement Year (CDP2016)</th>
      <th>Boundary (CDP2016)</th>
      <th>Primary Methodology (CDP2016)</th>
      <th>Methodology Details (CDP2016)</th>
      <th>...</th>
      <th>Reason for increase/decrease in emissions (CDP2017)</th>
      <th>Population (CDP2017)</th>
      <th>Population year (CDP2017)</th>
      <th>City Location (CDP2017)</th>
      <th>Country Location (CDP2017)</th>
      <th>Measurement year only (CDP2017)</th>
      <th>scope fraction (CDP2016)</th>
      <th>scope fraction (CDP2017)</th>
      <th>CDP2016 data edited</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>124</th>
      <td>57347</td>
      <td>Pingtung County Government</td>
      <td>Taiwan</td>
      <td>Pingtung</td>
      <td>NaN</td>
      <td>2017.0</td>
      <td>2013-01-03 03:13:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>The main increased department are energy, industry, and waste</td>
      <td>835792.0</td>
      <td>2016.0</td>
      <td>(22.6558, 120.4703)</td>
      <td>(23.69781, 120.960515)</td>
      <td>2013.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>A</td>
    </tr>
    <tr>
      <th>79</th>
      <td>31170</td>
      <td>Metropolitan Municipality of Lima</td>
      <td>Peru</td>
      <td>Lima</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>La metodología Global Protocol for Community- scale Greenhouse Gas emissions (GPC) establece que los límites pueden definirse en cualquiera de tres niveles: Internacional, inter-ciudades/subnacional, o al interior de la ciudad.</td>
      <td>...</td>
      <td>Han aumentado puesto que no se ha trabajado en proyectos o programas que tengan gran potencial de reducción en gases con efecto invernadero.</td>
      <td>8755262.0</td>
      <td>2014.0</td>
      <td>(-12.046374, -77.042793)</td>
      <td>(-9.189967, -75.015152)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>5.79</td>
      <td>CDP2016 TOT recalculated by summing both CDP2016 scopes.</td>
      <td>A</td>
    </tr>
    <tr>
      <th>61</th>
      <td>54402</td>
      <td>City of Lahti</td>
      <td>Finland</td>
      <td>Lahti</td>
      <td>NaN</td>
      <td>2017.0</td>
      <td>2015-01-03 03:15:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>Energy production CHP, process power, wastes and waste water calculations quite high level of confidence. Traffic calculation is based on national LIISA model, not actual emissions. Separate heating, industrial machinery, agriculture and its energy use are not so high level of confidence, because information harder to find .and emission calculatios are based on statistics. Calculations are made with national tool called KASVENER (2007), but with updated GWP factors.</td>
      <td>...</td>
      <td>Decreased from baseline year 1990. New waste gasification plant 2012 and collecting separate energy waste from citizens. Effective waste water treatment with collecting biogas before composting the sludge. Effective and energy-efficient waste and biowaste collection and treatment (new biogas plant 2014). Better energy effiency in buildings.</td>
      <td>119452.0</td>
      <td>2016.0</td>
      <td>(60.9833, 25.65)</td>
      <td>(61.92411, 25.748151)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &lt;&lt; s1+s2 (Case 3a) in CDP2016. Soln: Derive TOT (CDP2017) from s1 (CDP2017) and s2 (CDP2017) then replace CDP2016 values by CDP2017</td>
      <td>A</td>
    </tr>
    <tr>
      <th>105</th>
      <td>50680</td>
      <td>Cascais</td>
      <td>Portugal</td>
      <td>Cascais</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>this was made with calculous platforms from international organizations such as UN (IPCC, and ICLEI) as well as EU comission</td>
      <td>...</td>
      <td>We have verified a decrease in fuel consumption between the mentioned time period.</td>
      <td>208122.0</td>
      <td>2014.0</td>
      <td>(38.6970565, -9.4222945)</td>
      <td>(39.399872, -8.224454)</td>
      <td>2010.0</td>
      <td>1.000000</td>
      <td>1.47</td>
      <td>CDP2016 TOT recalculated by summing both CDP2016 scopes.</td>
      <td>A</td>
    </tr>
    <tr>
      <th>33</th>
      <td>31180</td>
      <td>Región Metropolitana de Santiago</td>
      <td>Chile</td>
      <td>Región Metropolitana de Santiago</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>GPC was used for organizing information, while for the estimation of emissions (equations and emission factors) the IPCC guidelines was used.</td>
      <td>...</td>
      <td>The emissions has decreased 1% respect year 2012. There was a significant decrease in the energy industry emissions, however it was counteracted by an increase in the transport sector.</td>
      <td>6527903.0</td>
      <td>2012.0</td>
      <td>(-33.44889, -70.669265)</td>
      <td>(-35.675147, -71.542969)</td>
      <td>2013.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>CDP2016 TOT recalculated by summing both CDP2016 scopes.</td>
      <td>A</td>
    </tr>
    <tr>
      <th>89</th>
      <td>43920</td>
      <td>City of Ljubljana</td>
      <td>Slovenia</td>
      <td>Ljubljana</td>
      <td>NaN</td>
      <td>2017.0</td>
      <td>2014-01-03 03:14:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>due to the actions taken. city centre closed for traffic, ordering of electricity (100 % RES), refurbishment of building (public and private through subsidies from public companies and state Eco-fund), iintroduction of CNG and electric buses in public transport, installation on electric cars charging stations, ...</td>
      <td>288307.0</td>
      <td>2016.0</td>
      <td>(46.056947, 14.505751)</td>
      <td>(46.151241, 14.995463)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason:  TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data (no edits required).</td>
      <td>A</td>
    </tr>
    <tr>
      <th>84</th>
      <td>44185</td>
      <td>Suwon City</td>
      <td>South Korea</td>
      <td>Suwon</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.104797</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>120</th>
      <td>54520</td>
      <td>Ville de Lausanne</td>
      <td>Switzerland</td>
      <td>Lausanne</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Baseline Emission Inventory of the Covenant of Mayor</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.006005</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>35</th>
      <td>50578</td>
      <td>City of Windsor</td>
      <td>Canada</td>
      <td>Windsor</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>Community emissions have decreased between 2011 and 2014.  The largest sources of declines were in Industrial, Commercial, Institutional emissions and can likely be credited in no small part to efficiency improvements and the Province's closing of coal fired electricity generation.  The Province of Ontario made a commitment in 2002 to close all coal fired-electricity plants by 2015.  In 2014, the last coal fired electricity generation plant was closed in Ontario.</td>
      <td>217188.0</td>
      <td>2016.0</td>
      <td>(42.314937, -83.036363)</td>
      <td>(56.130366, -106.346771)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.76</td>
      <td>CDP2016 TOT recalculated by summing both CDP2016 scopes.</td>
      <td>A</td>
    </tr>
    <tr>
      <th>186</th>
      <td>46473</td>
      <td>City of Zaragoza</td>
      <td>Spain</td>
      <td>Zaragoza</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Metodología propia basada en los factores oficiales del Ministerio de Agricultura y Medioambiente para las emisiones directas y en los de la Comisión Nacional de la Energía para las debidas al uso de la electricidad</td>
      <td>...</td>
      <td>Fundamentalmente, las medidas adoptadas en las estrategias anteriormente citadas han conseguido una importante reducción de las emisiones en los sectores contemplados en el Pacto de Alcaldes: residencial y movilidad. Y ello tanto en el último año como desde 2015. Por su parte, el sector industrial ha reducido sus emisiones en el último año aunque, desde 2005 estas han aumentado, Aparte de la influencia de determinadas actuaciones del Ayuntamiento (Plan de Acuerdos voluntarios) la crisis económica ha frenado en parte el incremento de las emisiones en este sector.</td>
      <td>702564.0</td>
      <td>2016.0</td>
      <td>(41.608629, -0.887012)</td>
      <td>(40.463667, -3.74922)</td>
      <td>2014.0</td>
      <td>1.001624</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>106</th>
      <td>50673</td>
      <td>Faro</td>
      <td>Portugal</td>
      <td>Faro</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Irradiare Science of evolution</td>
      <td>...</td>
      <td>The data was collected in 2014 show that the emissions decreased in scope1 and increased in scope2. But in general the emissions decreased</td>
      <td>61019.0</td>
      <td>2015.0</td>
      <td>(37.019355, -7.93044)</td>
      <td>(39.399872, -8.224454)</td>
      <td>2014.0</td>
      <td>1.000564</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>112</th>
      <td>31115</td>
      <td>City of Johannesburg</td>
      <td>South Africa</td>
      <td>Johannesburg</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>The City of Johannesburg 2014 inventory is the first GPC compliant inventory compiled for the City. It builds on the pioneering work undertaken by Siemens who compiled the first inventory for the City for the 2007 calendar year. Siemens prepared the initial report under an arrangement with C40 in 2012, and analyses the high-level changes between the two inventory years.</td>
      <td>...</td>
      <td>This decrease could be attributed to a number of reasons, for example there seems to be a correlation between it and the drop in electricity consumption. This drop in electricity consumption is mirrored in all the major municipalities in South Africa. There may well be data deficiency artefacts. The real reasons for this decrease and/or other trend that becomes apparent,will become clear as we become more thorough in quality data collection methods. Furthermore, to enhance our understand we will do bottom up data collection at a project level.</td>
      <td>4900000.0</td>
      <td>2016.0</td>
      <td>(-26.2041028, 28.0473051)</td>
      <td>(-30.559482, 22.937506)</td>
      <td>2014.0</td>
      <td>1.000513</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>82</th>
      <td>36263</td>
      <td>Comune di Ravenna</td>
      <td>Italy</td>
      <td>Ravenna</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-21 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>The Emission Inventory (MEI)  is updated within the Sustainable Energy Action Plan. It is based on the methodology and toolkit developed by ARPA ER (Environmental Protection Agency of Emilia-Romagna Region) within the instrument IPSI (Inventory of greenhouse gas emissions for the Covenant of Mayors - Italian version). The methodology was improved and adapted by a specific working group “Climate Plan”  at regional level including the main cities and Provinces. The background knowledge is based on the Regional Greenhouse Gas Emissions Inventory realized by the Region with the support of ARPA ER, following standard estimation methodologies, internationally recognized (IPCC, CORINAIR). The MEI includes: direct emissions of the Municipality considered as an organization with its own consumptions; indirect emissions, generated by activities within the Municipal area estimated by ARPA ER as a breakdown of the regional inventory. According to the European and Regional methodology, activities within ETS (Emissions Trade System) are not taken into account.</td>
      <td>...</td>
      <td>According to the Convenant of Mayors a series of actions have been implemented and are still on going in order to reach the goal of a reduction of CO2 emissions by at least 20% by 2020.</td>
      <td>391414.0</td>
      <td>2016.0</td>
      <td>(41.913028, 12.518037)</td>
      <td>(41.87194, 12.56738)</td>
      <td>2016.0</td>
      <td>1.000303</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>113</th>
      <td>49360</td>
      <td>Pretoria - Tshwane</td>
      <td>South Africa</td>
      <td>Pretoria - Tshwane</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2015-06-30 00:00:00</td>
      <td>A metropolitan area</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>The methodology as defined in the International Local Government GHG Emissions Analysis Protocol V1.0 and the Local Government Operations Protocol for the Quantification and Reporting of GHG Inventories V1.1 where used where applicable and viable.</td>
      <td>...</td>
      <td>The exclusion of the Eskom and Pre-paid energy usage in the baseline figures. The two subsequent years the afore-mentioned usage was included.</td>
      <td>3300000.0</td>
      <td>2017.0</td>
      <td>(-25.746111, 28.188056)</td>
      <td>(-30.559482, 22.937506)</td>
      <td>2014.0</td>
      <td>1.000148</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>86</th>
      <td>31111</td>
      <td>Tokyo Metropolitan Government</td>
      <td>Japan</td>
      <td>Tokyo</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2014-03-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>The guideline set by the Ministry of environmnet , Japan</td>
      <td>...</td>
      <td>NaN</td>
      <td>13646764.0</td>
      <td>2017.0</td>
      <td>(35.6896342, 139.6921007)</td>
      <td>(36.204824, 138.252924)</td>
      <td>2013.0</td>
      <td>1.000014</td>
      <td>6.32</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>110</th>
      <td>50672</td>
      <td>Santarém</td>
      <td>Portugal</td>
      <td>Santarém</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2006-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>61752.0</td>
      <td>2011.0</td>
      <td>(39.236669, -8.685994)</td>
      <td>(39.399872, -8.224454)</td>
      <td>2014.0</td>
      <td>1.000003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>53</th>
      <td>20113</td>
      <td>City of Vancouver</td>
      <td>Canada</td>
      <td>Vancouver</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>The City has compiled a GPC-compliant inventory for 2014 as a Compact of Mayors signatory.</td>
      <td>...</td>
      <td>Community LDV emissions have decreased with continued increase in landfill gas capture efficiency. Also a decrease in overall stationary energy use: green building policies and improved energy efficiency contribute to this, but also a warmer winter season in 2015. Transportation Scope 1 emissions increased: fuel sales within region increased. Economic growth is one factor, but also USD-CAD exchange rate. Due to our proximity to US border (where fuel can be considerably less expensive), cross-border fuel-ups are significant. Unfavourable exchange rates correlate to decline in cross-border fuel purchasing behaviour.</td>
      <td>631486.0</td>
      <td>2016.0</td>
      <td>(49.261226, -123.1139268)</td>
      <td>(56.130366, -106.346771)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>1.90</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>81</th>
      <td>54610</td>
      <td>Estância Turística de Guaratinguetá</td>
      <td>Brazil</td>
      <td>Guaratinguetá</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2015-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>115</th>
      <td>61753</td>
      <td>Yilan County</td>
      <td>Taiwan</td>
      <td>Yilan</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>458117.0</td>
      <td>2015.0</td>
      <td>(24.730918, 121.763222)</td>
      <td>(23.6978, 120.9605)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>169</th>
      <td>31181</td>
      <td>City of Philadelphia</td>
      <td>USA</td>
      <td>Philadelphia</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>In general the ICLEI protocol was followed, however in some cases data was not available in the same fashion or format as described in the protocol. Electricity, natural gas and steam usage was provided by the local utilities. Data related to onsite combustion of fuels was derived using the American Communities Surveys and allocated to Philadelphia based on population. Emissions from transportation was derived using the local regional planning commission's transportation model and EPA MOVES. EPA's non road emissions model was used for off road vehicles Industrial emissions were estimated by looking at EPAs GHG reporting project data and comparing it to previously known information from utilities. Waste data was modeled using MSW and private collection data along with local landfill and incinerator emissions based on total waste. This was counted as a scope 3 emissions because none of these facilities are within the City of Philadelphia</td>
      <td>...</td>
      <td>See www.phila.gov/green for Greenworks: A Vision for a Sustainable Philadelphia, which describes progress on carbon reductions to date. Philadelphia will be releasing a citywide energy vision document later in 2017 with more details on the expected trajectory of emissions in the city and strategies for meeting our 80 by 50 commitment.</td>
      <td>1555072.0</td>
      <td>2015.0</td>
      <td>(39.952335, -75.163789)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>2.29</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>54650</td>
      <td>Prefeitura de Palmas</td>
      <td>Brazil</td>
      <td>Palmas</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>O diagnóstico qualitativo das informações complementa a avaliação quantitativa.</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>34</th>
      <td>36518</td>
      <td>Comune di Udine</td>
      <td>Italy</td>
      <td>Udine</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>respect to the baseline of 2006 the GHG emissions decreased of 4% in 2013</td>
      <td>99528.0</td>
      <td>2013.0</td>
      <td>(46.0667, 13.2333)</td>
      <td>(41.87194, 12.56738)</td>
      <td>2013.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>142</th>
      <td>55799</td>
      <td>City of Arlington, VA</td>
      <td>USA</td>
      <td>Arlington, VA</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2015-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>Transportation, fuel oil use, and solid waste emissions data are the most recent available, from a 2012 inventory. Electricity and natural gas consumption in the community reflect actual 2015 data based on utility reporting.</td>
      <td>...</td>
      <td>This is our first year of calculation using the GPC method. A comparison will be available later in 2017 when a 2016 inventory is completed.</td>
      <td>220400.0</td>
      <td>2016.0</td>
      <td>(37.226486, -76.002594)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2012.0</td>
      <td>1.000000</td>
      <td>8.98</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>137</th>
      <td>35860</td>
      <td>City of Dallas</td>
      <td>USA</td>
      <td>Dallas</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Methodology included a combination of Environmental Protection Agency (EPA) reported emission factors and EPA recommended emission modeling tools.</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>136</th>
      <td>54113</td>
      <td>City of Flagstaff</td>
      <td>USA</td>
      <td>Flagstaff</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Formulas taken from The Climate Registry: Pacificorp Data ('07 Generation)</td>
      <td>...</td>
      <td>Emissions resulting from transportation (specifically, the amount of gasoline and diesel) have increased since our last reported emissions inventory (2015 data). Additionally, we have improved some emissions data collection methods, which may have resulted in more accurate, but higher, emissions being recorded. We have also included natural gas used for transportation, which was not included in the previous inventory.</td>
      <td>68667.0</td>
      <td>2013.0</td>
      <td>(35.1992, -111.6311)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2016.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>134</th>
      <td>3422</td>
      <td>Greater London Authority</td>
      <td>United Kingdom</td>
      <td>London</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>London's inventory is in line with the GPC, but in 2013 does not fully break down emissions according to GPC requirements. Stationary - Published central government datasets used for energy consumption and CO2 emissions from homes (residential buildings) and workplaces (commercial, industrial and government buildings and facilities). Mobile - The London Atmospheric Emissions Inventory (in-house model) is used to calculate distances travelled from transport of people and goods by  road, railways, water-borne navigation, aviation, and off-road surface transport. National emissions factors are applied.</td>
      <td>...</td>
      <td>London's CO2 emissions decreased between 2013 and 2014. As of 2014 they are 16% lower than 1990 levels and expected to reach a 20% reduction in the 2015 GHG assessment (currently being finalised for publication later in 2017). This decline is due to decarbonisation of the national electricity grid, with a reduction in coal use and an increase in renewables share of the national energy mix. Gas usage has also decreased, due to energy efficiency improvements in homes and workplaces (including the roll-out of more efficient gas fired boilers) and a reduction in industrial activity within London. London's population continues to increase year on year and as of 2014 London's per capita emissions remain the UK's lowest at 4.4 tonnes.</td>
      <td>8600000.0</td>
      <td>2015.0</td>
      <td>(51.504858, -0.078689)</td>
      <td>(55.378051, -3.435973)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>3.06</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>128</th>
      <td>43910</td>
      <td>City of Columbus</td>
      <td>USA</td>
      <td>Columbus</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2015-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>Basic Reporting.</td>
      <td>...</td>
      <td>Greenhouse gas emissions have again increased since our baseline emission inventory of 2013, but decreased since the 2014 inventory.</td>
      <td>850106.0</td>
      <td>2016.0</td>
      <td>(39.9611755, -82.9987942)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2016.0</td>
      <td>1.000000</td>
      <td>6.10</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>125</th>
      <td>31446</td>
      <td>Taipei City Government</td>
      <td>Taiwan</td>
      <td>Taipei City</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>Taipei city using GPC methodology to make City GHG inventory since 2014.</td>
      <td>...</td>
      <td>The GHG emissions of Taipei City have been verified by third party, BSI Taiwan (British Standards Institution Taiwan), from 2005 to 2015 in 2016. The greenhouse gas emissions of Taipei City in 2015 were 12,117,400 metric tons. The greenhouse gas emissions of the City present a rising tendency in 2005-2008. The increasing tendency slowed down and began to decline since the 2008. There is no power plant in Taipei City jurisdiction; electricity usage is all dependent on the electricity grid from outside county. Although Taipei city’s electricity consumption in 2015 was lower 70 million KWh than that in 2014, the GHG emissions increased slightly in 2015 cause of the country’s electricity emission factor increased about 1.34%.</td>
      <td>2695704.0</td>
      <td>2016.0</td>
      <td>(25.037525, 121.563782)</td>
      <td>(23.69781, 120.960515)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>58627</td>
      <td>City of Alton, IL</td>
      <td>USA</td>
      <td>Alton, IL</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>123</th>
      <td>56276</td>
      <td>New Taipei City Government</td>
      <td>Taiwan</td>
      <td>New Taipei</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>GHG Protocol is working to give cities the standards and tools they need to measure their emissions, build more effective emissions reduction strategies, set measurable and more ambitious emission reduction goals, and to track their progress more accurately and comprehensively.</td>
      <td>...</td>
      <td>Saving energy and reducing GHGs emission efficiently.</td>
      <td>3970644.0</td>
      <td>2016.0</td>
      <td>(25.0111, 121.4458)</td>
      <td>(23.69781, 120.960515)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>4.88</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>83</th>
      <td>31110</td>
      <td>Roma Capitale</td>
      <td>Italy</td>
      <td>Roma</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>The metodology is top - down, using data of primary energy source amount.</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>88</th>
      <td>36154</td>
      <td>Vilnius City Municipality</td>
      <td>Lithuania</td>
      <td>Vilnius</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>Inventory report is prepared in accordance with the methodology recommended by the Intergovernmental Panel on Climate Change (IPCC) publications: 1. Revised 1996 Guidelines for National Greenhouse Gas Inventories, IPCC, 1997; 2. Good Practice Guidance and Uncertainty Management in National Greenhouse Gas Inventories, IPCC, 2000; 3. 2006 IPCC Guidelines for National Greenhouse Gas Inventories, IPCC, 2006 GHG emissions were calculated from activity levels in the different sectors that are in accordance with the IPCC publications.</td>
      <td>...</td>
      <td>Increased wooden biomass utilization in Energy sector for the central heating.</td>
      <td>542626.0</td>
      <td>2015.0</td>
      <td>(54.687156, 25.279651)</td>
      <td>(55.169438, 23.881275)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>90</th>
      <td>31167</td>
      <td>City of Lagos</td>
      <td>Nigeria</td>
      <td>Lagos</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>93</th>
      <td>31148</td>
      <td>City of Amsterdam</td>
      <td>Netherlands</td>
      <td>Amsterdam</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2016-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Local standard based on electricity, gas, district heat en local transportation.</td>
      <td>...</td>
      <td>The decrease is very strong (10%) The reason for this is the exclution of emissions related to transport on national roads. Due to a new calculation model of the traffic department of the city these roads are no longer included in the vehicle movement calculation of the city.</td>
      <td>834713.0</td>
      <td>2016.0</td>
      <td>(52.370216, 4.895168)</td>
      <td>(52.132633, 5.291266)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
      <td>C</td>
    </tr>
    <tr>
      <th>103</th>
      <td>55325</td>
      <td>Município de Águeda</td>
      <td>Portugal</td>
      <td>Águeda</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>0</td>
      <td>Other</td>
      <td>Sustainable Energy Action Plan (SEAP) + SEAP Monitoring Report: Águeda’s SEAP holds a total carbon reduction potential of 33% by 2020, using 2002 as the reference year. The considered actions will also result in substantial economical benefits for the region’s citizens, companies and municipality, estimated at an average of 8 million Euros per year.An average investment of 3,3 million Euros per year is required to implement the actions included in the SEAP, but the bulk of this cost can be supported by external investment (public incentives, bank loans, ESCO models and the transaction of white certificates and carbon credits), which reduces to 1,2 million Euros per year the investment to be supported by the region’s citizens, companies and municipality.</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>109</th>
      <td>46514</td>
      <td>City of Porto</td>
      <td>Portugal</td>
      <td>Porto</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2009-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>The GHG emissions inventory was developed through the energy supply and demand data by the Portuguese Directorate-General for Energy and Geology (www.dgeg.pt) and the National Statistics Institute (www.ine.pt). The Transports sector was estimated through a separate and specific mobility needs model.</td>
      <td>...</td>
      <td>Porto Energy Agency has already calculated GHG emissions for 2004 , 2009 and 2012 and 2015 (this last one with non definite or mature data). The 2004 GHG emissions were the basis for the Sustainable Action Plan development. The 2009 and 2015 GHG emissions balance, point to a decrease in the emissions (by 22% and 26% respectively) - which indicates that Porto is half way of his ambitious target to 2020 – and these results are mainly  because of the decrease in the demand of fossil fuels (in mobility due to the Metro expansion) and “greener” national grid electricity.</td>
      <td>238954.0</td>
      <td>2011.0</td>
      <td>(41.1579438, -8.6291053)</td>
      <td>(39.399872, -8.224454)</td>
      <td>2015.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>111</th>
      <td>19233</td>
      <td>Torres Vedras Municipality</td>
      <td>Portugal</td>
      <td>Torres Vedras</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2009-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>The city has done a emission inventory in 2009 and another in 2014, the results indicate that the emissions has decreased (the changes are due to emissions redution actions  foreseen in sustainable energy action plan and to the national economic crises).</td>
      <td>79465.0</td>
      <td>2011.0</td>
      <td>(38.763669, -9.30148)</td>
      <td>(39.399872, -8.224454)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>118</th>
      <td>3429</td>
      <td>City of Stockholm</td>
      <td>Sweden</td>
      <td>Stockholm</td>
      <td>C40</td>
      <td>2017.0</td>
      <td>2015-01-03 03:15:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>Total emissions from the categories in Stockholm estimates at system boundaries have been reduced significantly over the past 10 years. Meanwhile, the population has grown by about 200 000 inhabitants. In Stockholm, it can be said that the reduction in per capita emissions by half will depend on the actual response, half of the population growth. The greenhouse gas emissions in Stockholm is calculated to 2.5 tonnes per capita in 2015, which can be compared to 2.6 tonnes per capita in 2014. Energy use for heating has decreased, which is due to energy efficiency measures and conversions (from oil to heat pumps). Stockholm has a clear reduction of the energy supply per capita for heating sector. Electricity use is however quite constant. The car traffic is constant in the last years even though the population has increased. However, there has been an increase in truck traffic. The overall greenhouse gas emissions from transportation is constant over the last years.</td>
      <td>923516.0</td>
      <td>2015.0</td>
      <td>(59.3293235, 18.0685808)</td>
      <td>(60.128161, 18.643501)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
      <td>A</td>
    </tr>
    <tr>
      <th>119</th>
      <td>31151</td>
      <td>Basel-Stadt</td>
      <td>Switzerland</td>
      <td>Basel-Stadt</td>
      <td>C40</td>
      <td>2017.0</td>
      <td>2016-01-03 03:16:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>198206.0</td>
      <td>2016.0</td>
      <td>(47.5619, 7.5928)</td>
      <td>(46.818188, 8.227512)</td>
      <td>2016.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
      <td>A</td>
    </tr>
    <tr>
      <th>121</th>
      <td>35449</td>
      <td>Stadt Zürich</td>
      <td>Switzerland</td>
      <td>Stadt Zürich</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>The 2000-Watt society methodology is a concept of sustainable development that uses two indicators: Primary energy demand and greenhouse gas emissions. The methodology is based on the final energy demand. Primary energy factors and GHG emission coefficients are according to the ecoinvent database (database with consistent and transparent, up-to-date Life Cycle Inventory (LCI) data – www.ecoinvent.org/database/). The grey energy of net imported other goods and services is not included in the methodology used by the city of Zurich as there is no specific data available. The methodology does not include emissions from non-energetic sources (e.g. landfills, waste water treatment). Primary energy, final energy and effective energy: The 2000-watt methodology defines primary energy as the total energy present in the original energy source, plus its grey energy. The energy that reaches the customer, after all conversion and transmission losses, is called final energy. In turn, only a part of this is actually used: the effective energy. The rest is lost as waste heat. Basis for all calculations is the final energy demand. Territorial principle: Basis of the methodology is the territorial principle. It refers to the energy consumed in the city area and the emissions which occur there. The energy sources grey energy and grey emissions are also taken into account. The grey energy of net imported other goods and service is not included in the 2000 watt society methodology (lack of specific data). However, the aim is to separately calculate and indicate the gray energy of net imported other goods and services. All calculations in regards to primary energy demand and greenhouse gas emissions are made with the balancing program ECORegion (http://www.ecospeed.ch/).</td>
      <td>...</td>
      <td>The course of greenhouse gas emissions since 2008 is more or less constant. We assume that the positive effects of modernizing insulation of buildings are mostly compensated  by increased demands for comfort (e.g. higher room temperatures, larger living spaces, longer heating periods).</td>
      <td>415682.0</td>
      <td>2016.0</td>
      <td>(47.3686498, 8.5391825)</td>
      <td>(46.818188, 8.227512)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>127</th>
      <td>1850</td>
      <td>Birmingham City Council</td>
      <td>United Kingdom</td>
      <td>Birmingham</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Other</td>
      <td>Data supplied by Department of Energy &amp; Climate Change annually with a two year lag.  Dataset is Local Authority Emissions within scope.</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>130</th>
      <td>31052</td>
      <td>City of Cardiff</td>
      <td>United Kingdom</td>
      <td>Cardiff</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Other</td>
      <td>Department of Energy and Climate Change (DECC) local authority CO2 emissions data</td>
      <td>...</td>
      <td>Main reduction in industry / commercial emissions but also some decrease in domestic emissions</td>
      <td>354300.0</td>
      <td>2014.0</td>
      <td>(51.481581, -3.17909)</td>
      <td>(55.378051, -3.435973)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>131</th>
      <td>54529</td>
      <td>City of Leicester</td>
      <td>United Kingdom</td>
      <td>Leicester</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>132</th>
      <td>52897</td>
      <td>City of Aspen and Pitkin County</td>
      <td>USA</td>
      <td>Aspen and Pitkin County</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>Aggregate emissions: -7.4% between 2004 and 2014. Res. Energy: +5%; Comm. Energy: -26%; Vehicles: - 13%; Airport: +15%; Waste:=2%</td>
      <td>8427.0</td>
      <td>2010.0</td>
      <td>(39.195, -106.837)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>NaN</td>
      <td>1.21</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>133</th>
      <td>59552</td>
      <td>City of Davis, CA</td>
      <td>USA</td>
      <td>Davis, CA</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-01-01 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>The City updated the inventory in 2012 using the latest available data from 2010.</td>
      <td>...</td>
      <td>Lower carbon emission electricity energy mix (grid).</td>
      <td>65600.0</td>
      <td>2010.0</td>
      <td>(38.544907, -121.740517)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2009.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>138</th>
      <td>35898</td>
      <td>Greater Manchester</td>
      <td>United Kingdom</td>
      <td>Manchester</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>A GPC Compliant dataset has been established for Greater Manchester, including primary data from 2013. This work has been undertaken by Anthesis, who also support the World Resources Institute in the development of Carbon Reduction and emissions reporting and trajectory methodologies and reporting tools.</td>
      <td>...</td>
      <td>Emissions decreased from is 18.1 to 17.9 million tonnes between 2013 and 2014. This represents a change from our GHG emissions tonnage figure reported to CDP in 2015 and a slight decrease in the first 2013 Global GHC protocol compliant Baseline Emissions inventory.  Repeating the reasons for the change - between emissions reported in 2015 submission and now (due to move to a compliant BEI process), this is due to inclusion of scope 3 emissions included in the Basic/Basic+ element of the inventory which GM commissioned which is now compliant with the Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI).  Previous submissions to CDP only included scope 1 and 2 emissions which drew directly from the national government DECC Local and Regional CO2 Emissions Estimates for 2005-2012 which used similar but not identical methodologies. This is part of a longer trend of decreasing emissions, punctuated with occasional increase years. Primary factors which determine the performance are the use of coal in any one year for grid electricity generation, and weather conditions during spring and autumn, where an extended heating season can occur if these are cold. A decline in total energy consumption is the most significant long term trend factor, due to the uptake of more energy efficient appliances, home adaptations, goods, services and transport</td>
      <td>2762000.0</td>
      <td>2014.0</td>
      <td>(53.4575955, -2.1578377)</td>
      <td>(55.378051, -3.435973)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
      <td>C</td>
    </tr>
    <tr>
      <th>146</th>
      <td>35853</td>
      <td>City of Baltimore</td>
      <td>USA</td>
      <td>Baltimore</td>
      <td>NaN</td>
      <td>2017.0</td>
      <td>2014-01-03 03:14:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>medium/high. High confidence in stationary energy combustion and transportation emissions. Medium confidence in solid waste emissions (landfill waste emissions) due to proxy for landfill waste characterization, assumptions made for landfill gas capture system efficiency. High confidence about incineration activities in the City due to directly monitored emissions data received from EPA</td>
      <td>...</td>
      <td>Natural gas consumption decreased in residential sector but increased in commercial and industrial sectors. Electricity consumption increased across the board. Even though electricity emissions factors decreased in 2014, the increase in electricity consumption offset improvements in emissions factors. On-road and rail activity increased. Solid waste generation decreased slightly due to increased diversion of waste from the landfill but waste water generation increased.</td>
      <td>614664.0</td>
      <td>2016.0</td>
      <td>(39.2903848, -76.6121893)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
      <td>A</td>
    </tr>
    <tr>
      <th>147</th>
      <td>35884</td>
      <td>City of San Diego</td>
      <td>USA</td>
      <td>San Diego</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2009-12-31 00:00:00</td>
      <td>0</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>IPCC</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>148</th>
      <td>49787</td>
      <td>City of Benicia</td>
      <td>USA</td>
      <td>Benicia</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2010-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>International Emissions Analysis Protocol (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>In 2010, community-wide emissions with large industrial emitters had increased from 2005 by 24% while community-wide emissions without large industrial emitters increased by 41%.  There was a 5.6% increase in emissions (2000-2005, with large emitters).   When the baseline inventory was completed, the team predicted that by 2010, emissions (w/ large industrial emitters) would increase 9% from 2005 to 4.6 million metric tons.  If large emitters were still included, then the increase between 2005 and 2010 was only a 24% increase, 15% more than what was originally predicted.  However, for 2010, it was decided to exclude large emitters.  This means that increases in all other sectors have a greater impact on total emissions, i.e. the increase in transportation emissions has a much greater impact on overall emissions levels.   The roughly 35% increase between 2005 and 2010 could be due to a number of things including changes in reporting protocols, e.g. permitting requirements changed or the non-recession years outweighed the recession years.  It could also be that Benicia was not as hard hit by the recession as other communities and therefore, emissions didn't decrease. Again, educated guesses have been made as to what caused the increase.    Please note that vehicle miles travelled (VMT) grew between 2000 and 2010 by 62%, while emissions increased 95%.  The % of total emissions from transportation is within the Bay Area average. The Metropolitan Transportation Commission (MTC) calculates VMT using a proprietary software model. MTC inputs traffic counts, vehicle speeds, vehicle make and model, and fuel data into its software. In 2010, per the change in the modeling software, Benicia is now responsible for 50% of the trips that start elsewhere but end in Benicia and trips that start in Benicia but end elsewhere. This is calculated based on the number of people that exit or enter the highway in Benicia. Pass through VMT is not attributed to Benicia. Then, emissions are calculated by inputting VMT into the CACP software, which generates a GHG equivalent (MTCO2e). The increase in off road emissions is due to construction permit projections for buildings, which may have never been built. However, estimating off road emissions using construction permit data is the recommended calculation method per ICLEI’s protocol and guidance.</td>
      <td>27450.0</td>
      <td>2014.0</td>
      <td>(38.049365, -122.1585777)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2010.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>149</th>
      <td>58621</td>
      <td>Town of Blacksburg</td>
      <td>USA</td>
      <td>Blacksburg</td>
      <td>NaN</td>
      <td>2017.0</td>
      <td>2015-01-03 03:15:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>Electricity and Natural Gas consumption are measured values however transportation figures are based on Virginia DOT's Vehicle Miles Traveled studies and estimates which may not be entirely accurate.</td>
      <td>...</td>
      <td>The last GHG inventory performed for the Town of Blacksburg was in 2012. Over those three years decreased emissions from electric utility provider's fuel mix has resulted in decreased emissions in the residential, commercial, industrial and public sectors. Considering the population increase it is likely that the culture of electricity use may have also lead to decreased consumption. Transportation emissions have increased by 1.39% which is likely due to the 3.29% increase in population. Wastewater emissions are significantly lower because of errors made in the previous emission calculations. Emissions from solid waste have also decreased roughly 4.4%.</td>
      <td>44215.0</td>
      <td>2015.0</td>
      <td>(37.2296, -80.4139)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
      <td>A</td>
    </tr>
    <tr>
      <th>150</th>
      <td>35862</td>
      <td>City of Detroit</td>
      <td>USA</td>
      <td>Detroit</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>This is the only inventory we have done.  The data has not been updated</td>
      <td>688701.0</td>
      <td>2013.0</td>
      <td>(42.331427, -83.0457538)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2012.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
      <td>C</td>
    </tr>
    <tr>
      <th>154</th>
      <td>3203</td>
      <td>City of Chicago</td>
      <td>USA</td>
      <td>Chicago</td>
      <td>C40</td>
      <td>2017.0</td>
      <td>2015-01-03 03:15:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>Chicago conducted a preliminary comparison using the existing 2010 and 2015 data to evaluate how community emissions have changed over the last five years. Results of this preliminary analysis of 2010 and 2015 GHG emissions reveals Chicago continued to reduce total GHG emissions through 2015 in the stationary and waste sectors resulting in a greater than 7 percent reduction in GHG emissions over the last five years. During that time, Chicago’s population grew by approximately 1 percent while the region’s GRP grew by more than 12 percent. Growth coupled with reduction in total emissions resulted in a greater than 8 percent decrease in per capita emissions in the City. Between 2010 and 2015, the majority of MT CO2e reductions occurred in the stationary energy sector, followed by waste. When considering percent reductions, the waste sector experienced the greatest reduction (30 percent) which included a 35 percent emissions reduction in the solid waste disposal sub-sector. This reduction in the solid waste sector is likely driven by a decrease in the total amount of solid waste sent to landfills and an improvement in the solid waste treatment technologies at those landfills. The City expanded its residential curbside recycling pilot program to now serve over 400,000, or approximately 33 percent, of additional City houeholds.Because of the program’s expansion the City experienced a significant increase in the number of tons collected for recycling, from 58,000 in 2010 to 97,000 in 2015. The stationary energy sector overall saw a 10 percent drop in emissions, including 11, 12 and 8 percent emissions reductions in the residential, commercial and institutional buildings and facilities, and manufacturing industries and construction sub-sectors, respectively. Stationary energy sector GHG emissions reductions are likely driven by a general trend in the building industry to improve energy efficiency of buildings as well as a regional shift in energy generation towards renewable energy sources. The City has also implemented the Energy Benchmarking Ordinance, Retrofit Chicago, and the Chicago Solar Express to encourage increasing energy efficiency and renewable energy generation and consumption within the city.</td>
      <td>2720546.0</td>
      <td>2015.0</td>
      <td>(41.8781136, -87.6297982)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2015.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
      <td>A</td>
    </tr>
    <tr>
      <th>161</th>
      <td>10894</td>
      <td>City of Los Angeles</td>
      <td>USA</td>
      <td>Los Angeles</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2013-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>Two primary reasons for the slight reduction are reduction in GHG intensity of electricity system and increased fuel economy of light duty vehicles. From 1990, the decline of manufacturing withing LA city limits also contributed to the decline.</td>
      <td>4030904.0</td>
      <td>2016.0</td>
      <td>(34.0522342, -118.2436849)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2013.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
      <td>C</td>
    </tr>
    <tr>
      <th>164</th>
      <td>49335</td>
      <td>Metropolitan Government of Nashville and Davidson County</td>
      <td>USA</td>
      <td>Nashville and Davidson</td>
      <td>NaN</td>
      <td>2017.0</td>
      <td>2014-01-03 03:14:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>There was a small increase since the 2011 inventory, which was an incomplete inventory due to limited availability of data. Because of limited documentation of the 2011 inventory, it is difficult to compare the two inventories. There has been a decrease in emissions since the 2005 inventory, even with a growing population. Contributing to decreases in reported community emissions are lower emissions from Nashville’s electric power source, TVA (their emissions per unit energy output declined by about 15% from 2005 to 2014), and more efficient vehicles (vehicle CO2e emissions per mile have decreased from about 450 to 350 grams/mile between 2005 and 2014). Meanwhile (although specific data is unavailable to demonstrate the quantity), building energy efficiency has been improving through both new and retrofit projects during this time frame. LEED certification and Energy Star are examples of growing programs that help improve building energy efficiency.</td>
      <td>678889.0</td>
      <td>2015.0</td>
      <td>(36.1627, -86.7816)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason:  TOT = s1, s2 does not exist (Case 1b) in CDP2016. Soln: Replace with CDP2017 values (TOT, s1 and s2)</td>
      <td>A</td>
    </tr>
    <tr>
      <th>165</th>
      <td>13067</td>
      <td>City of New Orleans</td>
      <td>USA</td>
      <td>New Orleans</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2014-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>We submitted our 2014 baseline inventory last year as we had just completed. However, we subsequently learned more about our electricity mix and realized that our mix was not reflective of the eGrid mix and had much more nuclear and must less natural gas. We adjusted the inventory to reflect the right electricity emissions factor and that is the source of our decreased total inventory.</td>
      <td>391495.0</td>
      <td>2017.0</td>
      <td>(29.9511, -90.0715)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
      <td>C</td>
    </tr>
    <tr>
      <th>168</th>
      <td>54119</td>
      <td>City of Palo Alto</td>
      <td>USA</td>
      <td>Palo Alto</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2015-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>TCR/LGOP</td>
      <td>...</td>
      <td>Combined City Municipal Operations and Palo Alto community emissions continue to decline. In 2016, overall City and Palo Alto GHG emissions were reduced an estimated 37% from 1990 levels, just under an additional 2% beyond 2015 reductions. Estimated City and community transportation related emissions declined an additional 5% from 2015 reductions, due to both a decrease in Vehicle Miles Travelled and changes in fleet composition. Natural gas emissions increased slightly from 2015, by approximately 1%, due in part to a colder fall and winter in 2016 than in 2015, which was warmer than average. Palo Alto Landfill Fugitive Emissions and Wastewater Process Emissions decreased due to efficiency measures.</td>
      <td>66478.0</td>
      <td>2017.0</td>
      <td>(37.4419, -122.143)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2016.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
    <tr>
      <th>171</th>
      <td>58357</td>
      <td>City of West Hollywood</td>
      <td>USA</td>
      <td>West Hollywood</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2008-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>We have not conducted a GHG inventory since 2008 but the City received a Strategic Growth Council grant to create a GHG inventory tool this year 2017. We plan to conduct another inventory as soon as possible.</td>
      <td>34399.0</td>
      <td>2010.0</td>
      <td>(34.09, -118.3617)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2008.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>D</td>
    </tr>
    <tr>
      <th>174</th>
      <td>54128</td>
      <td>City of Reno</td>
      <td>USA</td>
      <td>Reno</td>
      <td>NaN</td>
      <td>2017.0</td>
      <td>2014-01-03 03:14:00</td>
      <td>Administrative boundary of a local government</td>
      <td>Global Protocol for Community-Scale Greenhouse Gas Emissions Inventories (GPC), (WRI, C40 and ICLEI)</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>236995.0</td>
      <td>2014.0</td>
      <td>(39.5296, -119.8138)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>1.00</td>
      <td>Replaced by CDP2017 data. Reason: Both scopes missing (Case 4b) in CDP2016. Soln: Updated with CDP2017 values that contain at least one scope</td>
      <td>A</td>
    </tr>
    <tr>
      <th>179</th>
      <td>16581</td>
      <td>City of Seattle</td>
      <td>USA</td>
      <td>Seattle</td>
      <td>C40</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>Administrative boundary of a local government</td>
      <td>U.S. Community Protocol for Accounting and Reporting of Greenhouse Gas Emissions (ICLEI)</td>
      <td>Please see detailed source notes throughout the inventory document.</td>
      <td>...</td>
      <td>The total amount of GHGs emitted from the core emissions sources has declined 6% between 2008 and 2014, from 3.7 to 3.5 million metric tons of CO2-equivalent (CO2e).  However, Seattle’s population grew by 13% in the same period resulting in a per person decline in emissions of 17%. Road transportation has been the largest category of emissions since 1990. Total emissions in this sector increased between 1990 and 2008, however, they have been decreasing since 2008. Advances in vehicle technology, plus a trend towards fewer vehicle miles travelled per person, have led both to decreased absolute emissions from road transportation (down 2% since 2008) and decreased emissions per person (down 13% during this period). Between 2008 and 2014, building-related emissions declined as a result of lower overall building energy use, particularly for residential buildings, due to energy efficiency, more multi-family living, and especially by warmer weather that reduced winter heating needs. This decline, though modest, is more impressive considering Seattle’s population and economy have grown considerably since 1990.  On a per resident basis, Seattle’s emissions declined  22% per since 1990 and 6% since 2008. A number of factors led to emissions decreases that counteracted the effect of population and economic growth, especially (as already noted) the decrease in carbon intensity of Seattle City Light’s electricity, more efficient cars and trucks, and building efficiency (including smaller dwellings) and fuel switching.  Increased efficiency of air travel also contributed to a decrease in GHG emissions.</td>
      <td>662400.0</td>
      <td>2015.0</td>
      <td>(47.6062, -122.3321)</td>
      <td>(37.09024, -95.712891)</td>
      <td>2014.0</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>S1 derived from TOT - S2 in CDP2016 dataset</td>
      <td>C</td>
    </tr>
    <tr>
      <th>183</th>
      <td>35995</td>
      <td>City of Brasília</td>
      <td>Brazil</td>
      <td>Brasília</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2012-12-31 00:00:00</td>
      <td>A metropolitan area</td>
      <td>2006 IPCC Guidelines for National Greenhouse Gas Inventories</td>
      <td>Inventário de Emissões e Remoções Antrópicas de GEE do DF (WayCarbon, 2014). PERÍODO DE REFERÊNCIA • Geral: 2005 a 2012, ano a ano. • Mudança do uso da terra (AFOLU): Transição 1990 / 2005 / 2012 ANO DE REFERÊNCIA 2012</td>
      <td>...</td>
      <td>Considerando-se as Emissões de GEE por setor para o DF (emissões totais) no período de 2005-2012, as emissões têm aumentado em todos os setores avaliados. De acordo com a análise, os setores Energia e Resíduos apresentaram variação crescente ao longo de todos os períodos de análise. Para o setor IPPU, apenas a comparação 2005-2008 apresentou resultados menores do que o período anterior (2005-2007), com nova tendência de aumento nos demais intervalos subsequentes (devido à redução da produção de cimento em 2008 e retomada da produção nos anos seguintes). Já AFOLU apresentou intervalos irregulares de variação positiva e negativa ao longo do período, com valores negativos para os intervalos 2005-2006, 2005-2008, 2005-2009 e 2005-2010. No ano de variação positiva (2005-2007) as categorias mais representativas em emissões no setor AFOLU (Calagem e Emissões da queima de biomassa) também tiveram variação positiva nesse mesmo período.</td>
      <td>1409671.0</td>
      <td>2015.0</td>
      <td>(-15.794229, -47.882166)</td>
      <td>(-14.235004, -51.92528)</td>
      <td>2012.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CDP2016 TOT likely wrong because one scope is missing.</td>
      <td>E</td>
    </tr>
  </tbody>
</table>
<p>187 rows × 55 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[var_city2016]<span class="op">==</span><span class="st">'Rotterdam'</span>, <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'C'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[<span class="st">'City Short Name (CDP2016)'</span>].<span class="bu">str</span>.contains(<span class="st">'Rotterdam'</span>), [<span class="st">'City Short Name (CDP2016)'</span>, </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>                                            var_tot2016, var_s1_2016, var_s2_2016, <span class="st">'CDP2016 data edited'</span>, </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>                                            var_gases2016, var_incScopes, <span class="st">'Emissions Quality Flag'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>Total City-wide Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 1 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>Total Scope 2 Emissions (metric tonnes CO2e) (CDP2016)</th>
      <th>CDP2016 data edited</th>
      <th>Gases included (CDP2016)</th>
      <th>Scopes Included (CDP2017)</th>
      <th>Emissions Quality Flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>Rotterdam</td>
      <td>34190633.0</td>
      <td>17840039.0</td>
      <td>NaN</td>
      <td>Replaced by CDP2017 data. Reason: CDP2016 Scope1 includes power plant emissions. Action: Use CDP2017 (TOT and S1 values available only).</td>
      <td>CO2</td>
      <td>Total Scope 1 and Scope 2</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="assign-eqf-b-to-cities-with-the-scope-3-problem" class="level1">
<h1>Assign EQF B to cities with the Scope 3 problem</h1>
<p>i.e.&nbsp;where TOT=S1+S2 but Scopes Included specify S1+S2+s3 for cities that have been substituted by CDP2017.</p>
<ul>
<li>Basel</li>
<li>Chicago</li>
<li>Ljubljana</li>
<li>New York City</li>
<li>Pingtung</li>
<li>Recife</li>
<li>Reno</li>
<li>Santa Monica</li>
<li>Stockholm</li>
<li>Wellington</li>
</ul>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>s3city_array <span class="op">=</span> [</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Basel-Stadt'</span>, <span class="st">'Chicago'</span>, <span class="st">'Ljubljana'</span>, </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'New York City'</span>, <span class="st">'Pingtung'</span>, <span class="st">'Recife'</span>, <span class="st">'Reno'</span>, <span class="st">'Santa Monica'</span>, <span class="st">'Stockholm'</span>, <span class="st">'Wellington'</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="bu">len</span>(s3city_array)</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s3city_array</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10
['Basel-Stadt', 'Chicago', 'Ljubljana', 'New York City', 'Pingtung', 'Recife', 'Reno', 'Santa Monica', 'Stockholm', 'Wellington']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>replaceReason <span class="op">=</span> (</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">' TOT &gt;&gt; s1+s2 (Case 2b) in CDP2016. Soln: Replace with CDP2017 data'</span> \</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">' (no edits required).'</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cname <span class="kw">in</span> s3city_array:</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>    df_venn.loc[df_venn[<span class="st">'City Short Name (CDP2016)'</span>].<span class="bu">str</span>.contains(cname), <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'B'</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> df_venn.loc[df_venn[<span class="st">'City Short Name (CDP2016)'</span>].<span class="bu">str</span>.contains(cname), [<span class="st">'City Short Name (CDP2016)'</span>,<span class="st">'Emissions Quality Flag'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    City Short Name (CDP2016) Emissions Quality Flag
119  Basel-Stadt               B                    
    City Short Name (CDP2016) Emissions Quality Flag
154  Chicago                   B                    
   City Short Name (CDP2016) Emissions Quality Flag
89  Ljubljana                 B                    
    City Short Name (CDP2016) Emissions Quality Flag
166  New York City             B                    
    City Short Name (CDP2016) Emissions Quality Flag
124  Pingtung                  B                    
   City Short Name (CDP2016) Emissions Quality Flag
36  Recife                    B                    
    City Short Name (CDP2016) Emissions Quality Flag
174  Reno                      B                    
    City Short Name (CDP2016) Emissions Quality Flag
177  Santa Monica              B                    
    City Short Name (CDP2016) Emissions Quality Flag
118  Stockholm                 B                    
   City Short Name (CDP2016) Emissions Quality Flag
98  Wellington                B                    </code></pre>
</div>
</div>
</section>
<section id="assign-emissions-quality-flag-for-remaining-cities" class="level1">
<h1>Assign Emissions Quality Flag for remaining cities</h1>
<p>Cities that at this point have not had a Quality Flag assigned get EQF A.</p>
<div class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check:</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_venn.loc[df_venn[<span class="st">'Emissions Quality Flag'</span>].isnull(), var_city2016].count()</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>remainingCities <span class="op">=</span> df_venn.loc[df_venn[<span class="st">'Emissions Quality Flag'</span>].isnull(), var_city2016]</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[<span class="st">'Emissions Quality Flag'</span>].isnull(), [var_city2016, var_sf2016]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>33</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="106">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>City Short Name (CDP2016)</th>
      <th>scope fraction (CDP2016)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Suwon</td>
      <td>1.104797</td>
    </tr>
    <tr>
      <th>120</th>
      <td>Lausanne</td>
      <td>1.006005</td>
    </tr>
    <tr>
      <th>186</th>
      <td>Zaragoza</td>
      <td>1.001624</td>
    </tr>
    <tr>
      <th>106</th>
      <td>Faro</td>
      <td>1.000564</td>
    </tr>
    <tr>
      <th>112</th>
      <td>Johannesburg</td>
      <td>1.000513</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Ravenna</td>
      <td>1.000303</td>
    </tr>
    <tr>
      <th>113</th>
      <td>Pretoria - Tshwane</td>
      <td>1.000148</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Tokyo</td>
      <td>1.000014</td>
    </tr>
    <tr>
      <th>110</th>
      <td>Santarém</td>
      <td>1.000003</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Vancouver</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Guaratinguetá</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>115</th>
      <td>Yilan</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>169</th>
      <td>Philadelphia</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Palmas</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>184</th>
      <td>La Paz</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Kadiovacik</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>182</th>
      <td>Alcaldía Metropolitana de Caracas</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Milano</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Belo Horizonte</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>185</th>
      <td>Sorocaba</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Venezia</td>
      <td>0.999999</td>
    </tr>
    <tr>
      <th>135</th>
      <td>Burlington</td>
      <td>0.999992</td>
    </tr>
    <tr>
      <th>129</th>
      <td>Bournemouth</td>
      <td>0.999968</td>
    </tr>
    <tr>
      <th>126</th>
      <td>Hermosa Beach, CA</td>
      <td>0.999534</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Eugene</td>
      <td>0.995000</td>
    </tr>
    <tr>
      <th>116</th>
      <td>Iowa</td>
      <td>0.993070</td>
    </tr>
    <tr>
      <th>172</th>
      <td>St Louis</td>
      <td>0.992139</td>
    </tr>
    <tr>
      <th>176</th>
      <td>San Francisco</td>
      <td>0.988066</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Batangas</td>
      <td>0.987688</td>
    </tr>
    <tr>
      <th>102</th>
      <td>Madrid</td>
      <td>0.979461</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Salvador</td>
      <td>0.975560</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Bogotá</td>
      <td>0.952672</td>
    </tr>
    <tr>
      <th>139</th>
      <td>Houston</td>
      <td>0.914997</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>df_venn.loc[df_venn[<span class="st">'Emissions Quality Flag'</span>].isnull(), <span class="st">'Emissions Quality Flag'</span>] <span class="op">=</span> <span class="st">'A'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bar_strDim(df, dim):</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Bar plot of dimension string values in df column"""</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    fsize <span class="op">=</span> (<span class="dv">4</span>,<span class="dv">4</span>) </span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> df[dim]</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    counts <span class="op">=</span> s.value_counts()</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> counts</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> counts.iloc[:<span class="bu">len</span>(counts)].plot(kind<span class="op">=</span><span class="st">"bar"</span>, figsize<span class="op">=</span>fsize)</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>bar_strDim(df_venn, <span class="st">'Emissions Quality Flag'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A    125
D    36 
B    10 
C    9  
E    7  
Name: Emissions Quality Flag, dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Methods1_CDP2016_QAQC_files/figure-html/cell-136-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="clean-up-and-save" class="level1">
<h1>Clean up and save</h1>
<section id="remove-cdp2017-columns" class="level2">
<h2 class="anchored" data-anchor-id="remove-cdp2017-columns">Remove CDP2017 columns</h2>
<div class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>col_order <span class="op">=</span> <span class="bu">list</span>(df_venn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>df_venn2016 <span class="op">=</span> df_venn.drop([s <span class="cf">for</span> s <span class="kw">in</span> col_order <span class="cf">if</span> <span class="st">'2017'</span> <span class="kw">in</span> s], <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> <span class="bu">list</span>(df_venn2016)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>idx<span class="op">=</span><span class="dv">0</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cname <span class="kw">in</span> <span class="bu">list</span>(df_venn2016):</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'(CDP2016)'</span> <span class="kw">in</span> cname:</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>        df_venn2016.rename(columns <span class="op">=</span> {cname:cname.replace(<span class="st">'CDP2016'</span>, <span class="st">'CDP'</span>)}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>        df_venn2016.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' (CDP)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>df_venn2016.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">
<pre><code>(187, 31)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>df_venn2016.to_csv(<span class="st">'DATA/INTERMEDIATE_FILES/cdp_with_quality_flags.tsv'</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="continue-to-methods2_ch4corrections.ipynb" class="level1">
<h1>Continue to Methods2_CH4corrections.ipynb</h1>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>